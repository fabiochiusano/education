{"content": "Persisting Application History from Ephemeral Clusters on Google Cloud\u00a0DataprocJacob FerrieroBlockedUnblockFollowFollowingApr 2So you want to use ephemeral Dataproc Clusters, but don\u2019t want to lose your valuable YARN and Spark history once your cluster is torn down.Enter the single node Dataproc cluster. It will serve as your persistent history server for MapReduce and Spark job history as well as a window into aggregated YARN logs.", "url": "https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686", "html": "<!DOCTYPE html>\n<html xmlns:cc=\"http://creativecommons.org/ns#\"><head prefix=\"og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#\"><meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/><meta content=\"width=device-width, initial-scale=1.0, viewport-fit=contain\" name=\"viewport\"/><title>Persisting Application History from Ephemeral Clusters on Google Cloud Dataproc</title><link href=\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\" rel=\"canonical\"/><meta content=\"Persisting Application History from Ephemeral Clusters on Google Cloud Dataproc\" name=\"title\"/><meta content=\"origin\" name=\"referrer\"/><meta content=\"So you want to use ephemeral Dataproc Clusters, but don\u2019t want to lose your valuable YARN and Spark history once your cluster is torn down. Enter the single node Dataproc cluster. It will serve as\u2026\" name=\"description\"/><meta content=\"#000000\" name=\"theme-color\"/><meta content=\"Persisting Application History from Ephemeral Clusters on Google Cloud Dataproc\" property=\"og:title\"/><meta content=\"Persisting Application History from Ephemeral Clusters on Google Cloud Dataproc\" property=\"twitter:title\"/><meta content=\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\" property=\"og:url\"/><meta content=\"https://cdn-images-1.medium.com/max/1200/0*PatkVyBLe0rsHS69\" property=\"og:image\"/><meta content=\"542599432471018\" property=\"fb:app_id\"/><meta content=\"So you want to use ephemeral Dataproc Clusters, but don\u2019t want to lose your valuable YARN and Spark history once my cluster is torn down.\" property=\"og:description\"/><meta content=\"So you want to use ephemeral Dataproc Clusters, but don\u2019t want to lose your valuable YARN and Spark history once my cluster is torn down.\" name=\"twitter:description\"/><meta content=\"https://cdn-images-1.medium.com/max/1200/0*PatkVyBLe0rsHS69\" name=\"twitter:image:src\"/><link href=\"https://plus.google.com/103654360130207659246\" rel=\"publisher\"/><link href=\"https://medium.com/@jtferriero\" rel=\"author\"/><meta content=\"Jacob Ferriero\" property=\"author\"/><meta content=\"article\" property=\"og:type\"/><meta content=\"summary_large_image\" name=\"twitter:card\"/><meta content=\"https://www.facebook.com/medium\" property=\"article:publisher\"/><meta content=\"https://medium.com/@jtferriero\" property=\"article:author\"/><meta content=\"index, follow\" name=\"robots\"/><meta content=\"2019-04-02T18:17:23.832Z\" property=\"article:published_time\"/><meta content=\"@Medium\" name=\"twitter:site\"/><meta content=\"Medium\" property=\"og:site_name\"/><meta name=\"twitter:label1\" value=\"Reading time\"/><meta name=\"twitter:data1\" value=\"9 min read\"/><meta content=\"Medium\" name=\"twitter:app:name:iphone\"/><meta content=\"828256236\" name=\"twitter:app:id:iphone\"/><meta content=\"medium://p/7b1b03a49686\" name=\"twitter:app:url:iphone\"/><meta content=\"Medium\" property=\"al:ios:app_name\"/><meta content=\"828256236\" property=\"al:ios:app_store_id\"/><meta content=\"com.medium.reader\" property=\"al:android:package\"/><meta content=\"Medium\" property=\"al:android:app_name\"/><meta content=\"medium://p/7b1b03a49686\" property=\"al:ios:url\"/><meta content=\"medium://p/7b1b03a49686\" property=\"al:android:url\"/><meta content=\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\" property=\"al:web:url\"/><link href=\"/osd.xml\" rel=\"search\" title=\"Medium\" type=\"application/opensearchdescription+xml\"><link href=\"android-app://com.medium.reader/https/medium.com/p/7b1b03a49686\" rel=\"alternate\"><script type=\"application/ld+json\">{\"@context\":\"http://schema.org\",\"@type\":\"NewsArticle\",\"image\":{\"@type\":\"ImageObject\",\"width\":797,\"height\":507,\"url\":\"https://cdn-images-1.medium.com/max/1594/0*PatkVyBLe0rsHS69\"},\"url\":\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\",\"dateCreated\":\"2019-04-02T18:17:23.832Z\",\"datePublished\":\"2019-04-02T18:17:23.832Z\",\"dateModified\":\"2019-04-02T20:17:42.531Z\",\"headline\":\"Persisting Application History from Ephemeral Clusters on Google Cloud Dataproc\",\"name\":\"Persisting Application History from Ephemeral Clusters on Google Cloud Dataproc\",\"articleId\":\"7b1b03a49686\",\"thumbnailUrl\":\"https://cdn-images-1.medium.com/max/1594/0*PatkVyBLe0rsHS69\",\"keywords\":[\"Tag:Google Cloud Platform\",\"Topic:Software Engineering\",\"Topic:Programming\",\"Publication:google-cloud\",\"LockedPostSource:1\",\"Elevated:false\",\"LayerCake:3\"],\"author\":{\"@type\":\"Person\",\"name\":\"Jacob Ferriero\",\"url\":\"https://medium.com/@jtferriero\"},\"creator\":[\"Jacob Ferriero\"],\"publisher\":{\"@type\":\"Organization\",\"name\":\"Google Cloud Platform - Community\",\"url\":\"https://medium.com/google-cloud\",\"logo\":{\"@type\":\"ImageObject\",\"width\":60,\"height\":60,\"url\":\"https://cdn-images-1.medium.com/max/120/1*FUjLiCANvATKeaJEeg20Rw.png\"}},\"mainEntityOfPage\":\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\"}</script><meta content=\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\" name=\"parsely-link\"/><link class=\"js-glyph-\" href=\"https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css\" id=\"glyph-8\" rel=\"stylesheet\" type=\"text/css\"><link href=\"https://cdn-static-1.medium.com/_/fp/css/main-branding-base.95h6LstxJX8UWgJm7QqR7A.css\" rel=\"stylesheet\"/><script>!function(n,e){var t,o,i,c=[],f={passive:!0,capture:!0},r=new Date,a=\"pointerup\",u=\"pointercancel\";function p(n,c){t||(t=c,o=n,i=new Date,w(e),s())}function s(){o>=0&&o<i-r&&(c.forEach(function(n){n(o,t)}),c=[])}function l(t){if(t.cancelable){var o=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;\"pointerdown\"==t.type?function(t,o){function i(){p(t,o),r()}function c(){r()}function r(){e(a,i,f),e(u,c,f)}n(a,i,f),n(u,c,f)}(o,t):p(o,t)}}function w(n){[\"click\",\"mousedown\",\"keydown\",\"touchstart\",\"pointerdown\"].forEach(function(e){n(e,l,f)})}w(n),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){c.push(n),s()}}(addEventListener,removeEventListener);</script><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener(\"error\", _onerror, true); else if (document.attachEvent) document.attachEvent(\"onerror\", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName(\"script\")[0], s = d.createElement(\"script\"); s.type = \"text/javascript\"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName(\"script\")[0], s = d.createElement(\"link\"); s.rel = \"stylesheet\"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = \"/_/stat?event=pixel.load&origin=\" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga(\"create\", \"UA-24232453-2\", \"auto\", {\"allowLinker\": true, \"legacyCookieDomain\": window.location.hostname}); ga(\"send\", \"pageview\");</script><script async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><!--[if lt IE 9]><script charset=\"UTF-8\" src=\"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js\"></script><![endif]--><link class=\"js-favicon\" href=\"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico\" rel=\"icon\"/><link href=\"https://cdn-images-1.medium.com/fit/c/304/304/1*FUjLiCANvATKeaJEeg20Rw.png\" rel=\"apple-touch-icon\" sizes=\"152x152\"/><link href=\"https://cdn-images-1.medium.com/fit/c/240/240/1*FUjLiCANvATKeaJEeg20Rw.png\" rel=\"apple-touch-icon\" sizes=\"120x120\"/><link href=\"https://cdn-images-1.medium.com/fit/c/152/152/1*FUjLiCANvATKeaJEeg20Rw.png\" rel=\"apple-touch-icon\" sizes=\"76x76\"/><link href=\"https://cdn-images-1.medium.com/fit/c/120/120/1*FUjLiCANvATKeaJEeg20Rw.png\" rel=\"apple-touch-icon\" sizes=\"60x60\"/><link color=\"#171717\" href=\"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg\" rel=\"mask-icon\"/></link></link></link></head><body class=\"postShowScreen browser-chrome os-windows is-withMagicUnderlines v-glyph v-glyph--m2 is-noJs\" itemscope=\"\"><script>document.body.className = document.body.className.replace(/(^|\\s)is-noJs(\\s|$)/, \"$1is-js$2\")</script><div class=\"site-main\" id=\"container\"><div class=\"butterBar butterBar--error\"></div><div class=\"surface\"><div class=\"screenContent\" id=\"prerendered\"><canvas class=\"canvas-renderer\"></canvas><div class=\"container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer\"></div><div class=\"metabar u-clearfix u-boxShadow4px12pxBlackLightest u-fixed u-backgroundTransparentWhiteDarkest u-xs-sizeFullViewportWidth js-metabar\"><div class=\"branch-journeys-top\"></div><div class=\"js-metabarMiddle metabar-inner u-marginAuto u-maxWidth1032 u-flexCenter u-justifyContentSpaceBetween u-height65 u-xs-height56 u-paddingHorizontal20\"><div class=\"metabar-block u-flex1 u-flexCenter\"><div class=\"u-xs-hide js-metabarLogoLeft\"><a class=\"siteNav-logo u-fillTransparentBlackDarker u-flex0 u-flexCenter u-paddingTop0\" data-log-event=\"home\" href=\"https://medium.com/\"><span class=\"svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-flex0 u-flexCenter u-paddingTop0\"><svg class=\"svgIcon-use\" height=\"45\" width=\"45\"><path d=\"M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z\"></path></svg></span><span class=\"u-textScreenReader\">Homepage</span></a></div><div class=\"u-xs-show js-metabarLogoLeft\"><a class=\"siteNav-logo u-fillTransparentBlackDarker u-flex0 u-flexCenter u-paddingTop0\" data-log-event=\"home\" href=\"https://medium.com/\"><span class=\"svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-flex0 u-flexCenter u-paddingTop0\"><svg class=\"svgIcon-use\" height=\"45\" width=\"45\"><path d=\"M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z\"></path></svg></span><span class=\"u-textScreenReader\">Homepage</span></a></div></div><div class=\"metabar-block u-flex0 u-flexCenter\"><div class=\"u-flexCenter u-height65 u-xs-height56\"><div class=\"buttonSet buttonSet--wide u-lineHeightInherit\"><a class=\"button button--primary button--chromeless u-accentColor--buttonNormal is-inSiteNavBar u-xs-hide js-signInButton\" data-action=\"sign-in-prompt\" data-action-source=\"--------------------------nav_reg\" data-redirect=\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\" href=\"https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fpersisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686&amp;source=--------------------------nav_reg&amp;operation=login\">Sign in</a><a class=\"button button--primary button--withChrome u-accentColor--buttonNormal is-inSiteNavBar js-signUpButton\" data-action=\"sign-up-prompt\" data-action-source=\"--------------------------nav_reg\" data-redirect=\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\" href=\"https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fpersisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686&amp;source=--------------------------nav_reg&amp;operation=register\">Get started</a></div></div></div></div><div class=\"u-borderTopLighter\"><div class=\"metabar-inner u-marginAuto u-maxWidth1032 u-paddingHorizontal20 js-metabarBottom\"><nav class=\"metabar-block metabar-block--below u-flexCenter u-overflowHidden u-height54\" role=\"navigation\"><div class=\"u-flexCenter u-overflowHidden\"><div class=\"u-marginRight40\"><a class=\"u-flexCenter js-collectionLogoOrName\" href=\"https://medium.com/google-cloud?source=logo-lo_IHx7XZw0T0sc---e52cf94d98af\"><img alt=\"Google Cloud Platform - Community\" height=\"36\" src=\"https://cdn-images-1.medium.com/letterbox/72/72/50/50/1*FUjLiCANvATKeaJEeg20Rw.png?source=logoAvatar-lo_IHx7XZw0T0sc---e52cf94d98af\" width=\"36\"/></a></div><div class=\"u-overflowHidden u-xs-hide\"><ul class=\"u-textAlignLeft u-noWrap u-overflowX u-height80 u-marginTop40 js-collectionNavItems\"><li class=\"metabar-navItem js-collectionNavItem u-inlineBlock u-fontSize13 u-textUppercase u-letterSpacing1px u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-xs-paddingTop10\"><a class=\"link link--darken u-accentColor--textDarken link--noUnderline u-baseColor--link js-navItemLink\" href=\"https://medium.com/google-cloud/weekly/home\">This Week in GCP</a></li><li class=\"metabar-navItem js-collectionNavItem u-inlineBlock u-fontSize13 u-textUppercase u-letterSpacing1px u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-xs-paddingTop10\"><a class=\"link link--darken u-accentColor--textDarken link--noUnderline u-baseColor--link js-navItemLink\" href=\"https://medium.com/google-cloud/tagged/kubernetes\">Containers</a></li><li class=\"metabar-navItem js-collectionNavItem u-inlineBlock u-fontSize13 u-textUppercase u-letterSpacing1px u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-xs-paddingTop10\"><a class=\"link link--darken u-accentColor--textDarken link--noUnderline u-baseColor--link js-navItemLink\" href=\"https://medium.com/google-cloud/tagged/google-compute-engine\">Virtualization</a></li><li class=\"metabar-navItem js-collectionNavItem u-inlineBlock u-fontSize13 u-textUppercase u-letterSpacing1px u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-xs-paddingTop10\"><a class=\"link link--darken u-accentColor--textDarken link--noUnderline u-baseColor--link js-navItemLink\" href=\"https://medium.com/google-cloud/tagged/google-app-engine\">Platform as a Service</a></li><li class=\"metabar-navItem js-collectionNavItem u-inlineBlock u-fontSize13 u-textUppercase u-letterSpacing1px u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-xs-paddingTop10\"><a class=\"link link--darken u-accentColor--textDarken link--noUnderline u-baseColor--link js-navItemLink\" href=\"https://medium.com/google-cloud/tagged/bigquery\">Data</a></li><li class=\"metabar-navItem js-collectionNavItem u-inlineBlock u-fontSize13 u-textUppercase u-letterSpacing1px u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-xs-paddingTop10\"><a class=\"link link--darken u-accentColor--textDarken link--noUnderline u-baseColor--link js-navItemLink\" href=\"https://medium.com/google-cloud/tagged/machine-learning\">Machine Learning</a></li><li class=\"metabar-navItem js-collectionNavItem u-inlineBlock u-fontSize13 u-textUppercase u-letterSpacing1px u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-xs-paddingTop10\"><a class=\"link link--darken u-accentColor--textDarken link--noUnderline u-baseColor--link js-navItemLink\" href=\"https://medium.com/google-cloud/tagged/iot\">IoT</a></li><span class=\"u-borderLeft1 u-baseColor--borderLight\"></span><li class=\"metabar-navItem js-collectionNavItem is-external u-inlineBlock u-fontSize13 u-textUppercase u-letterSpacing1px u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-xs-paddingTop10\"><a class=\"link link--darkenOnHover u-accentColor--textDarken link--noUnderline u-baseColor--link js-navItemLink\" href=\"https://cloud.google.com/blog/\" rel=\"nofollow noopener\" target=\"_blank\">More</a></li></ul></div></div></nav></div></div></div><div class=\"metabar metabar--spacer js-metabarSpacer u-height119 u-xs-height110\"></div><main role=\"main\"><article class=\"u-minHeight100vhOffset65 u-overflowHidden postArticle postArticle--full is-withAccentColors u-marginBottom40\" lang=\"en\"><div class=\"postArticle-content js-postField js-notesSource js-trackPostScrolls\" data-collection-id=\"e52cf94d98af\" data-post-id=\"7b1b03a49686\" data-source=\"post_page\" data-tracking-context=\"postPage\"><section class=\"section section--body section--first\" name=\"8575\"><div class=\"section-divider\"><hr class=\"section-divider\"/></div><div class=\"section-content\"><div class=\"section-inner sectionLayout--insetColumn\"><h1 class=\"graf graf--h3 graf--leading graf--title\" id=\"adf4\" name=\"adf4\">Persisting Application History from Ephemeral Clusters on Google Cloud\u00a0Dataproc</h1><div class=\"uiScale uiScale-ui--regular uiScale-caption--regular u-flexCenter u-marginVertical24 u-fontSize15 js-postMetaLockup\"><div class=\"u-flex0\"><a class=\"link u-baseColor--link avatar\" data-action=\"show-user-card\" data-action-source=\"post_header_lockup\" data-action-type=\"hover\" data-action-value=\"3b0d197b82f8\" data-user-id=\"3b0d197b82f8\" dir=\"auto\" href=\"https://medium.com/@jtferriero?source=post_header_lockup\"><div class=\"u-relative u-inlineBlock u-flex0\"><img alt=\"Go to the profile of Jacob Ferriero\" class=\"avatar-image u-size50x50\" src=\"https://cdn-images-1.medium.com/fit/c/100/100/1*HV-Gei_diNhBWCBKaMSesw.jpeg\"/><div class=\"avatar-halo u-absolute u-textColorGreenNormal svgIcon\" style=\"width: calc(100% + 10px); height: calc(100% + 10px); top:-5px; left:-5px\"><svg viewbox=\"0 0 70 70\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M5.53538374,19.9430227 C11.180401,8.78497536 22.6271155,1.6 35.3571429,1.6 C48.0871702,1.6 59.5338847,8.78497536 65.178902,19.9430227 L66.2496695,19.401306 C60.4023065,7.84329843 48.5440457,0.4 35.3571429,0.4 C22.17024,0.4 10.3119792,7.84329843 4.46461626,19.401306 L5.53538374,19.9430227 Z\"></path><path d=\"M65.178902,49.9077131 C59.5338847,61.0657604 48.0871702,68.2507358 35.3571429,68.2507358 C22.6271155,68.2507358 11.180401,61.0657604 5.53538374,49.9077131 L4.46461626,50.4494298 C10.3119792,62.0074373 22.17024,69.4507358 35.3571429,69.4507358 C48.5440457,69.4507358 60.4023065,62.0074373 66.2496695,50.4494298 L65.178902,49.9077131 Z\"></path></svg></div></div></a></div><div class=\"u-flex1 u-paddingLeft15 u-overflowHidden\"><div class=\"u-paddingBottom3\"><a class=\"ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker\" data-action=\"show-user-card\" data-action-type=\"hover\" data-action-value=\"3b0d197b82f8\" data-user-id=\"3b0d197b82f8\" dir=\"auto\" href=\"https://medium.com/@jtferriero\">Jacob Ferriero</a><span class=\"followState js-followState\" data-user-id=\"3b0d197b82f8\"><button class=\"button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide\" data-action=\"sign-up-prompt\" data-action-source=\"post_header_lockup\" data-redirect=\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\" data-requires-token=\"true\" data-sign-in-action=\"toggle-block-user\"><span class=\"button-label button-defaultState\">Blocked</span><span class=\"button-label button-hoverState\">Unblock</span></button><button class=\"button button--primary button--smallest button--dark u-noUserSelect button--withChrome u-accentColor--buttonDark button--follow js-followButton u-marginLeft10 u-xs-hide\" data-action=\"sign-up-prompt\" data-action-source=\"post_header_lockup-3b0d197b82f8-------------------------follow_byline\" data-redirect=\"https://medium.com/_/subscribe/user/3b0d197b82f8\" data-requires-token=\"true\" data-sign-in-action=\"toggle-subscribe-user\"><span class=\"button-label button-defaultState js-buttonLabel\">Follow</span><span class=\"button-label button-activeState\">Following</span></button></span></div><div class=\"ui-caption u-noWrapWithEllipsis js-testPostMetaInlineSupplemental\"><time datetime=\"2019-04-02T18:17:23.832Z\">Apr 2</time><span class=\"middotDivider u-fontSize12\"></span><span class=\"readingTime\" title=\"9 min read\"></span><span class=\"u-paddingLeft4\"><span class=\"svgIcon svgIcon--star svgIcon--15px\"><svg class=\"svgIcon-use\" height=\"15\" width=\"15\"><path d=\"M7.438 2.324c.034-.099.09-.099.123 0l1.2 3.53a.29.29 0 0 0 .26.19h3.884c.11 0 .127.049.038.111L9.8 8.327a.271.271 0 0 0-.099.291l1.2 3.53c.034.1-.011.131-.098.069l-3.142-2.18a.303.303 0 0 0-.32 0l-3.145 2.182c-.087.06-.132.03-.099-.068l1.2-3.53a.271.271 0 0 0-.098-.292L2.056 6.146c-.087-.06-.071-.112.038-.112h3.884a.29.29 0 0 0 .26-.19l1.2-3.52z\"></path></svg></span></span></div></div></div><p class=\"graf graf--p graf-after--h3\" id=\"986f\" name=\"986f\">So you want to use ephemeral Dataproc Clusters, but don\u2019t want to lose your valuable YARN and Spark history once your cluster is torn down.</p><p class=\"graf graf--p graf-after--p graf--trailing\" id=\"d8dc\" name=\"d8dc\">Enter the <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/single-node-clusters\" href=\"https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/single-node-clusters\" rel=\"nofollow noopener\" target=\"_blank\">single node Dataproc cluster</a>. It will serve as your persistent history server for MapReduce and Spark job history as well as a window into aggregated YARN logs.</p></div></div></section><section class=\"section section--body section--last\" name=\"0088\"><div class=\"section-divider\"><hr class=\"section-divider\"/></div><div class=\"section-content\"><div class=\"section-inner sectionLayout--insetColumn\"><h3 class=\"graf graf--h3 graf--leading\" id=\"8bd7\" name=\"8bd7\">Background</h3><p class=\"graf graf--p graf-after--h3\" id=\"b487\" name=\"b487\">Hadoop engineers who have been around for a while are probably used to the YARN and Spark UIs for Application history. Some may even dig through the YARN container logs for a deeper layer of debugging. These UIs and container logs provide valuable information for diagnosing what went wrong during a certain job. In the cloud era (no pun intended) of cluster ephemerality, you\u2019d like to have a persistent way of accessing these familiar interfaces. Dataproc is the Google Cloud Platform service for managing Hadoop clusters, making it simple to spin-up and tear-down resources at will. This post outlines a pattern to have a single-node long-running Dataproc cluster that acts as an Application History Server for a shorter lived cluster (or several such clusters). This post follows best practices for creating long-running Dataproc environments as described in Google\u2019s blog plost: \u201c<a class=\"markup--anchor markup--p-anchor\" data-href=\"https://cloud.google.com/blog/products/data-analytics/10-tips-for-building-long-running-clusters-using-cloud-dataproc\" href=\"https://cloud.google.com/blog/products/data-analytics/10-tips-for-building-long-running-clusters-using-cloud-dataproc\" rel=\"nofollow noopener\" target=\"_blank\">10 tips for building long-running clusters using Cloud Dataproc</a>\u201d</p><h3 class=\"graf graf--h3 graf-after--p\" id=\"d722\" name=\"d722\">What We\u2019re\u00a0Building</h3><figure class=\"graf graf--figure graf-after--h3\" id=\"3e6a\" name=\"3e6a\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 445px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 63.6%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*PatkVyBLe0rsHS69\" data-height=\"507\" data-image-id=\"0*PatkVyBLe0rsHS69\" data-is-featured=\"true\" data-width=\"797\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*PatkVyBLe0rsHS69?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*PatkVyBLe0rsHS69\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*PatkVyBLe0rsHS69\"/></noscript></div></div></figure><ul class=\"postList\"><li class=\"graf graf--li graf-after--figure\" id=\"894d\" name=\"894d\">A GCS bucket to house cluster templates, initialization actions, aggregated YARN logs, Spark events and MapReduce <code class=\"markup--code markup--li-code\">done-dir</code> and <code class=\"markup--code markup--li-code\">intermediate-done-dir</code>.</li><li class=\"graf graf--li graf-after--li\" id=\"e576\" name=\"e576\">A VPC network for your clusters. (Note: ssh access to private IP addressed machines could be provided by a VPN paired with this VPC, but this is out of scope for this example.)</li><li class=\"graf graf--li graf-after--li\" id=\"7a8c\" name=\"7a8c\">A single-node Dataproc cluster for viewing the Spark and MapReduce job history UIs. This will have a public IP to allow simple SSH access via OS Login.</li><li class=\"graf graf--li graf-after--li\" id=\"394c\" name=\"394c\">A Dataproc cluster configured to persist its YARN logs in GCS. This will not have public IP addresses.</li></ul><h3 class=\"graf graf--h3 graf-after--li\" id=\"0ccc\" name=\"0ccc\">Let\u2019s Get\u00a0Building</h3><p class=\"graf graf--p graf-after--h3\" id=\"2c61\" name=\"2c61\">First things first we need to <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://console.cloud.google.com/flows/enableapi?apiid=dataproc,compute\" href=\"https://console.cloud.google.com/flows/enableapi?apiid=dataproc,compute\" rel=\"nofollow noopener\" target=\"_blank\">enable a few services</a> in the project you wish to spin up this example.</p><pre class=\"graf graf--pre graf-after--p\" id=\"f2bc\" name=\"f2bc\">gcloud config set project &lt;your-project-id&gt;</pre><pre class=\"graf graf--pre graf-after--pre\" id=\"aed8\" name=\"aed8\">gcloud services enable \\<br/>compute.googleapis.com \\<br/>dataproc.googleapis.com</pre><p class=\"graf graf--p graf-after--pre\" id=\"42c4\" name=\"42c4\">Next, pull down the Google Cloud <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://github.com/GoogleCloudPlatform/professional-services\" href=\"https://github.com/GoogleCloudPlatform/professional-services\" rel=\"noopener nofollow\" target=\"_blank\">professional services</a> repository and navigate to the source for this example.</p><pre class=\"graf graf--pre graf-after--p\" id=\"7566\" name=\"7566\">git clone <a class=\"markup--anchor markup--pre-anchor\" data-href=\"https://github.com/GoogleCloudPlatform/professional-services.git\" href=\"https://github.com/GoogleCloudPlatform/professional-services.git\" rel=\"nofollow noopener\" target=\"_blank\">https://github.com/GoogleCloudPlatform/professional-services.git</a></pre><pre class=\"graf graf--pre graf-after--pre\" id=\"1e6f\" name=\"1e6f\">cd professional-services/examples/dataproc-persistent-history-server</pre><h3 class=\"graf graf--h3 graf-after--pre\" id=\"aca5\" name=\"aca5\">Using the Right Tool: gcloud vs Terraform</h3><p class=\"graf graf--p graf-after--h3\" id=\"8d16\" name=\"8d16\">Capturing and version controlling the configuration of your cloud environment has become best practice. However, engineers are faced with different ways of doing this. <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://terraform.io\" href=\"https://terraform.io\" rel=\"nofollow noopener\" target=\"_blank\">Terraform</a> provides a lot of value when you are spinning up several permanent components of your infrastructure, with various dependencies. In other words Terraform is great when you want something to authoritatively capture the state of your environment. The methods provided by the Google Cloud SDK (ie. the <code class=\"markup--code markup--p-code\">gcloud</code> CLI) are really convenient for spinning up a single resource during prototyping, and for managing ephemeral resources. When it comes to Dataproc clusters, if you plan to regularly tear down your cluster (as would be the case for a job scoped cluster), it is best to capture the configuration as a cluster template yaml (this can be <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://cloud.google.com/sdk/gcloud/reference/beta/dataproc/clusters/export\" href=\"https://cloud.google.com/sdk/gcloud/reference/beta/dataproc/clusters/export\" rel=\"nofollow noopener\" target=\"_blank\">exported from an existing cluster</a> or <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://cloud.google.com/dataproc/docs/reference/rest/v1/ClusterConfig\" href=\"https://cloud.google.com/dataproc/docs/reference/rest/v1/ClusterConfig\" rel=\"nofollow noopener\" target=\"_blank\">written by hand</a>). It doesn\u2019t make sense to reapply a terraform plan at the beginning and end of jobs to manage cluster spin-up /tear down, as this could be prone to breaking.</p><p class=\"graf graf--p graf-after--p\" id=\"9256\" name=\"9256\">The code for this example provides both terraform and yaml for both the history server and a cluster configured to persist its logs on GCS. The thought behind this is</p><ul class=\"postList\"><li class=\"graf graf--li graf-after--p\" id=\"1052\" name=\"1052\">If you are treating your history server as a rather permanent part of your environment, it should be in terraform</li><li class=\"graf graf--li graf-after--li\" id=\"ec07\" name=\"ec07\">If you are treating the history server as something you spin up and tear down when you\u2019re using it then it makes more sense to <a class=\"markup--anchor markup--li-anchor\" data-href=\"https://cloud.google.com/sdk/gcloud/reference/beta/dataproc/clusters/import\" href=\"https://cloud.google.com/sdk/gcloud/reference/beta/dataproc/clusters/import\" rel=\"nofollow noopener\" target=\"_blank\">create it using </a><code class=\"markup--code markup--li-code\"><a class=\"markup--anchor markup--li-anchor\" data-href=\"https://cloud.google.com/sdk/gcloud/reference/beta/dataproc/clusters/import\" href=\"https://cloud.google.com/sdk/gcloud/reference/beta/dataproc/clusters/import\" rel=\"nofollow noopener\" target=\"_blank\">gcloud beta dataproc clusters import</a></code>.</li></ul><p class=\"graf graf--p graf-after--li\" id=\"0483\" name=\"0483\">Similarly, the <code class=\"markup--code markup--p-code\"><a class=\"markup--anchor markup--p-anchor\" data-href=\"https://github.com/GoogleCloudPlatform/professional-services/blob/master/examples/dataproc-persistent-history-server/cluster_templates/ephemeral-cluster.yaml\" href=\"https://github.com/GoogleCloudPlatform/professional-services/blob/master/examples/dataproc-persistent-history-server/cluster_templates/ephemeral-cluster.yaml\" rel=\"nofollow noopener\" target=\"_blank\">ephemeral-cluster.yaml</a></code> and <code class=\"markup--code markup--p-code\"><a class=\"markup--anchor markup--p-anchor\" data-href=\"https://github.com/GoogleCloudPlatform/professional-services/blob/master/examples/dataproc-persistent-history-server/terraform/long-running-cluster.tf\" href=\"https://github.com/GoogleCloudPlatform/professional-services/blob/master/examples/dataproc-persistent-history-server/terraform/long-running-cluster.tf\" rel=\"nofollow noopener\" target=\"_blank\">long-running-cluster.tf</a></code> will spin up congruent clusters. Choose which cluster configuration tool makes more sense for your use of that cluster.</p><p class=\"graf graf--p graf-after--p\" id=\"b06a\" name=\"b06a\">If you are just trying to run this example, it\u2019s recommended you read the Google Cloud SDK Environment Setup without running the <code class=\"markup--code markup--p-code\">gcloud</code> blocks. Just check out the <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://github.com/GoogleCloudPlatform/professional-services\" href=\"https://github.com/GoogleCloudPlatform/professional-services\" rel=\"noopener nofollow\" target=\"_blank\">professional services repo</a> and read through the files in the <code class=\"markup--code markup--p-code\">terraform</code> directory, set the appropriate values in <code class=\"markup--code markup--p-code\">terrafom.tfvars</code> and apply the plan for this example. Note, you\u2019ll need to have <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://www.terraform.io/\" href=\"https://www.terraform.io/\" rel=\"noopener nofollow\" target=\"_blank\">terraform</a> installed. This will greatly simplify tearing down all the resources for this example when you\u2019re done.</p><h3 class=\"graf graf--h3 graf-after--p\" id=\"f3a8\" name=\"f3a8\">Terraform Environment Set\u00a0Up</h3><p class=\"graf graf--p graf-after--h3\" id=\"0302\" name=\"0302\">From the <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://github.com/GoogleCloudPlatform/professional-services/tree/master/examples/dataproc-persistent-history-server\" href=\"https://github.com/GoogleCloudPlatform/professional-services/tree/master/examples/dataproc-persistent-history-server\" rel=\"nofollow noopener\" target=\"_blank\">dataproc-persistent-history-server directory</a>, run the following commands.</p><pre class=\"graf graf--pre graf-after--p\" id=\"3122\" name=\"3122\">cd terraform<br/>terraform init<br/>terraform plan<br/>terraform apply</pre><p class=\"graf graf--p graf-after--pre\" id=\"76c7\" name=\"76c7\">You can skip the <code class=\"markup--code markup--p-code\">gcloud</code> blocks in the next section, but I\u2019d recommend skimming for explanation as to why certain decisions were made for configuring the environment for this example.</p><h3 class=\"graf graf--h3 graf-after--p\" id=\"1101\" name=\"1101\"><code class=\"markup--code markup--h3-code\">Google Cloud SDK </code>Environment Setup</h3><p class=\"graf graf--p graf-after--h3\" id=\"f6bc\" name=\"f6bc\">This walk-through will spin up an environment using <code class=\"markup--code markup--p-code\">gcloud</code> CLI while explaining each choice.</p><h4 class=\"graf graf--h4 graf-after--p\" id=\"3c26\" name=\"3c26\">Storage and Service Account\u00a0Setup</h4><p class=\"graf graf--p graf-after--h4\" id=\"523e\" name=\"523e\">Create a Google Cloud Storage Bucket in which you\u2019ll store your logs. It\u2019s a clean practice to keep logs in a separate bucket from your data to make the intention of the bucket clear and to simplify privileges.</p><p class=\"graf graf--p graf-after--p\" id=\"072c\" name=\"072c\">(Note: You must stage an empty object in this GCS bucket so that the <code class=\"markup--code markup--p-code\">spark-events</code> <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://spark.apache.org/docs/latest/monitoring.html#spark-history-server-configuration-options\" href=\"https://spark.apache.org/docs/latest/monitoring.html#spark-history-server-configuration-options\" rel=\"nofollow noopener\" target=\"_blank\">path exists</a> before running a job, otherwise the job will fail.)</p><pre class=\"graf graf--pre graf-after--p\" id=\"bb4c\" name=\"bb4c\">gsutil mb -c regional -l us-central1 gs://my_history_bucket<br/>touch .keep<br/>gsutil cp .keep gs://my_history_bucket/spark-events/.keep<br/>rm .keep</pre><p class=\"graf graf--p graf-after--pre\" id=\"35ac\" name=\"35ac\">Create a service account for your history server.</p><pre class=\"graf graf--pre graf-after--p\" id=\"fa7b\" name=\"fa7b\">gcloud iam service-accounts create history-server-account</pre><p class=\"graf graf--p graf-after--pre\" id=\"84a1\" name=\"84a1\">Give this service account permissions to run a Dataproc cluster:</p><pre class=\"graf graf--pre graf-after--p\" id=\"4327\" name=\"4327\">gcloud projects add-iam-policy-binding project_id \\<br/>--member=serviceAccount:history-server-account@project_id.iam.gserviceaccount.com \\<br/>--role=roles/dataproc.worker</pre><p class=\"graf graf--p graf-after--pre\" id=\"294a\" name=\"294a\">Grant read access to the history bucket:</p><pre class=\"graf graf--pre graf-after--p\" id=\"0df0\" name=\"0df0\">gsutil iam ch \\<br/>serviceAccount:history-server-account@project_id.iam.gserviceaccount.com:objectViewer \\<br/>gs://my_history_bucket</pre><h4 class=\"graf graf--h4 graf-after--pre\" id=\"8377\" name=\"8377\">Setting up your\u00a0Network</h4><p class=\"graf graf--p graf-after--h4\" id=\"d0c4\" name=\"d0c4\">You want to take extra care in setting up the firewall rules to avoid the <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://medium.com/@neerajsabharwal/hadoop-yarn-hack-9a72cc1328b6\" href=\"https://medium.com/@neerajsabharwal/hadoop-yarn-hack-9a72cc1328b6\" target=\"_blank\">common security pitfall</a> of exposing the YARN web interface port 8088 to the public internet allowing bad actors to submit jobs on your cluster. The recommended approach for engineers connecting to a cluster is to <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://cloud.google.com/compute/docs/instances/connecting-advanced#vpn\" href=\"https://cloud.google.com/compute/docs/instances/connecting-advanced#vpn\" rel=\"nofollow noopener\" target=\"_blank\">connect to your clusters via VPN</a> that is peered with your VPC network. This way, engineers can ssh into clusters referencing their private IP addresses using the <code class=\"markup--code markup--p-code\">gcloud compute ssh\u200a\u2014\u200ainternal-ip &lt;target-instance&gt;</code>. To automate Linux account creation you can enable <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://cloud.google.com/compute/docs/instances/managing-instance-access\" href=\"https://cloud.google.com/compute/docs/instances/managing-instance-access\" rel=\"nofollow noopener\" target=\"_blank\">OS Login</a>. To keep this example simple, you will assign the history server a public IP address and a firewall rule to allow any ingress traffic on port 22.</p><p class=\"graf graf--p graf-after--p\" id=\"7693\" name=\"7693\"><strong class=\"markup--strong markup--p-strong\">Note: The firewall rule will expose an entry point to your Dataproc cluster from the public internet on port 22.</strong></p><p class=\"graf graf--p graf-after--p\" id=\"2547\" name=\"2547\">First things first, get your networking pre-requisites in order. The following command creates a regional network and specifies that we will create your own sub-networks.</p><pre class=\"graf graf--pre graf-after--p\" id=\"2b1e\" name=\"2b1e\">gcloud compute networks create example-net \\<br/>--bgp-routing-mode regional \\<br/>--subnet-mode custom</pre><p class=\"graf graf--p graf-after--pre\" id=\"243b\" name=\"243b\">Add a sub-network for Dataproc. The following command creates a subnet for dataproc in the us-central1 region. It specifies a CIDR range that specifies the range of internal IPs for the machines on this network from <code class=\"markup--code markup--p-code\">10.128.0.0</code> to <code class=\"markup--code markup--p-code\">10.128.255.255</code>. We also <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://cloud.google.com/vpc/docs/configure-private-google-access\" href=\"https://cloud.google.com/vpc/docs/configure-private-google-access\" rel=\"nofollow noopener\" target=\"_blank\">enable private Google access</a>, so that the machines without public IP addresses on this network can reach GCP services.</p><pre class=\"graf graf--pre graf-after--p\" id=\"673a\" name=\"673a\">gcloud compute networks subnets create \\<br/>example-hadoop-subnet-central \\<br/>--range 10.128.0.0/16 \\<br/>--network example-net \\<br/>--region us-central1 \\<br/>--enable-private-ip-google-access</pre><p class=\"graf graf--p graf-after--pre\" id=\"f9b9\" name=\"f9b9\">Next, create a firewall rule to allow ssh for the <code class=\"markup--code markup--p-code\">hadoop-history-ui-access</code> tag. For the source range you\u2019re following in suit with the default network and allowing ssh from all IPs. You should consider restricting this CIDR range to only those of the data engineering teams that would need to ssh to the cluster.</p><pre class=\"graf graf--pre graf-after--p\" id=\"80a4\" name=\"80a4\">gcloud compute firewall-rules create \\<br/>example-hadoop-subnet-central-hadoop-history-ui-ssh \\<br/>--allow tcp:22 \\<br/>--direction INGRESS \\<br/>--network example-net \\<br/>--target-tags hadoop-history-ui-access,hadoop-admin-ui-access \\<br/>--source-ranges 0.0.0.0/0</pre><p class=\"graf graf--p graf-after--pre\" id=\"8346\" name=\"8346\">Finally, Hadoop uses a lot of ports for communication between nodes so create this firewall rule as well to allow all tcp, udp and icmp traffic between nodes with any of the specified tags.</p><pre class=\"graf graf--pre graf-after--p\" id=\"346e\" name=\"346e\">gcloud compute firewall-rules create \\<br/>example-hadoop-subnet-central \\<br/>--allow tcp,udp,icmp \\<br/>--source-tags hadoop-history-ui-access,hadoop-admin-ui-access \\<br/>--target-tags hadoop-history-ui-access,hadoop-admin-ui-access</pre><h4 class=\"graf graf--h4 graf-after--pre\" id=\"b6a0\" name=\"b6a0\">Spinning up a History\u00a0Server</h4><p class=\"graf graf--p graf-after--h4\" id=\"684a\" name=\"684a\">Think of this history server as a window to the logs you\u2019ve persisted on GCS. All of the state is captured on GCS so you can choose to spin this history server up and down at will or keep it running for convenience.</p><p class=\"graf graf--p graf-after--p\" id=\"f96f\" name=\"f96f\">However, keep in mind:</p><blockquote class=\"graf graf--blockquote graf-after--p\" id=\"88ff\" name=\"88ff\">\u2026 the MapReduce job history server only reads history from Cloud Storage when it first starts up. From that point forward, the only new job history you will see in the UI is for the jobs that were run on that cluster; in other words, these are jobs whose history was moved by that cluster\u2019s job history server. By contrast, the Spark job history server is completely stateless, so the previous caveats do not apply.\u200a\u2014\u200aMikayla Konst &amp; Chris Crosbie: <a class=\"markup--anchor markup--blockquote-anchor\" data-href=\"http://10 tips for building long-running clusters using Cloud Dataproc\" href=\"http://10%20tips%20for%20building%20long-running%20clusters%20using%20Cloud%20Dataproc\" rel=\"nofollow noopener\" target=\"_blank\">10 tips for building long-running clusters using Cloud Datapro</a>c</blockquote><p class=\"graf graf--p graf-after--blockquote\" id=\"85cb\" name=\"85cb\">Next, create a single-node Dataproc cluster on the sub-network created above. This will serve as your long-running Application History Server. You can use the <code class=\"markup--code markup--p-code\">history_server.yaml</code> file to create the history server.</p><p class=\"graf graf--p graf-after--p\" id=\"920f\" name=\"920f\">First, replace the placeholders in the yaml files by running the following <code class=\"markup--code markup--p-code\">sed</code> commands.</p><pre class=\"graf graf--pre graf-after--p\" id=\"2c40\" name=\"2c40\"><code class=\"markup--code markup--pre-code\">cd workflow_templates<br/>sed -i 's/PROJECT/your-gcp-project-id/g' *<br/>sed -i 's/HISTORY_BUCKET/your-history-bucket/g' *<br/>sed -i 's/HISTORY_SERVER/your-history-server/g' *<br/>sed -i 's/REGION/us-central1/g' *<br/>sed -i 's/ZONE/us-central1-f/g' *<br/>sed -i 's/SUBNET/your-subnet-id/g' *<br/><br/>cd ../cluster_templates<br/>sed -i 's/PROJECT/your-gcp-project-id/g' *<br/>sed -i 's/HISTORY_BUCKET/your-history-bucket/g' *<br/>sed -i 's/HISTORY_SERVER/your-history-server/g' *<br/>sed -i 's/REGION/us-central1/g' *<br/>sed -i 's/ZONE/us-central1-f/g' *<br/>sed -i 's/SUBNET/your-subnet-id/g' *</code></pre><p class=\"graf graf--p graf-after--pre\" id=\"8298\" name=\"8298\">Now you\u2019re ready to spin up the history server.</p><pre class=\"graf graf--pre graf-after--p\" id=\"6d01\" name=\"6d01\">cd ..<br/>gcloud beta dataproc clusters import \\<br/>history-server \\<br/>--source=cluster_templates/history-server.yaml \\<br/>--region=us-central1</pre><h3 class=\"graf graf--h3 graf-after--pre\" id=\"8a72\" name=\"8a72\">Creating a Cluster and Submitting Jobs</h3><p class=\"graf graf--p graf-after--h3\" id=\"e75a\" name=\"e75a\">Finally, spin up an ephemeral cluster, that\u2019s configured to write logs to Google Cloud Storage, so they can live long after your cluster is torn down. It\u2019s best practice to capture information about the clusters you are creating in a yaml file for consistent cluster creation.</p><p class=\"graf graf--p graf-after--p\" id=\"5fde\" name=\"5fde\">Note: The cluster yamls refer to an<a class=\"markup--anchor markup--p-anchor\" data-href=\"https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/init-actions\" href=\"https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/init-actions\" rel=\"nofollow noopener\" target=\"_blank\"> initialization action</a> on GCS to disable the local history servers on the ephemeral clusters. This can be found in <code class=\"markup--code markup--p-code\">disable_history_servers.sh</code>\u00a0. You must stage this in your history bucket.</p><pre class=\"graf graf--pre graf-after--p\" id=\"e3dd\" name=\"e3dd\">gsutil cp init_actions/disable_history_servers.sh \\<br/>gs://my_history_bucket/init_actions/</pre><p class=\"graf graf--p graf-after--pre\" id=\"a27a\" name=\"a27a\">You can manage cluster spin-up, submission of a Spark job, submission of a Hadoop job, and finally cluster tear-down with a<a class=\"markup--anchor markup--p-anchor\" data-href=\"https://cloud.google.com/dataproc/docs/concepts/workflows/overview\" href=\"https://cloud.google.com/dataproc/docs/concepts/workflows/overview\" rel=\"nofollow noopener\" target=\"_blank\"> workflow template</a>. This is the most straightforward way to run this example. The job dependencies and cluster definition can be found in <code class=\"markup--code markup--p-code\">spark_mr_workflow_template.yaml</code>.</p><pre class=\"graf graf--pre graf-after--p\" id=\"242a\" name=\"242a\">gcloud dataproc workflow-templates instantiate-from-file \\<br/>spark-mr-example \\<br/>--region=us-central1 \\<br/>--source=workflow_templates/spark_mr_workflow_template.yaml</pre><h4 class=\"graf graf--h4 graf-after--pre\" id=\"e0f0\" name=\"e0f0\">Analyze Your Spark application history Long After Your Cluster Is\u00a0Gone</h4><p class=\"graf graf--p graf-after--h4\" id=\"902b\" name=\"902b\">Now that the cluster where you ran the job has been deleted, use an SSH tunnel to your history server in order to display the Spark History on your Chrome browser. The following commands are for a Linux OS, you can follow the <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://cloud.google.com/dataproc/docs/concepts/accessing/cluster-web-interfaces\" href=\"https://cloud.google.com/dataproc/docs/concepts/accessing/cluster-web-interfaces\" rel=\"nofollow noopener\" target=\"_blank\">instructions for your OS</a> in the Dataproc docs.</p><pre class=\"graf graf--pre graf-after--p\" id=\"bf6b\" name=\"bf6b\">gcloud compute ssh history-server-m \\<br/>--project=your-project-id \\<br/>--zone=us-central1-a \\<br/>-- \\<br/>-D 1080 -N</pre><p class=\"graf graf--p graf-after--pre\" id=\"887d\" name=\"887d\">Connect Chrome through the proxy.</p><pre class=\"graf graf--pre graf-after--p\" id=\"edf9\" name=\"edf9\">/usr/bin/google-chrome \\<br/>--proxy-server=\u201dsocks5://localhost:1080\" \\<br/>--user-data-dir=\u201d/tmp/history-server-m\u201d \\<br/><a class=\"markup--anchor markup--pre-anchor\" data-href=\"http://history-server-m:18080\" href=\"http://history-server-m:18080\" rel=\"nofollow noopener\" target=\"_blank\">http://history-server-m:18080</a></pre><p class=\"graf graf--p graf-after--pre\" id=\"0ee2\" name=\"0ee2\">This should launch the Chrome browser and you should be able to see the Spark History UI.</p><figure class=\"graf graf--figure graf-after--p\" id=\"29f2\" name=\"29f2\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 393px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 56.2%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*37lMnorrOamlPw5N\" data-height=\"674\" data-image-id=\"0*37lMnorrOamlPw5N\" data-width=\"1200\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*37lMnorrOamlPw5N?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*37lMnorrOamlPw5N\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*37lMnorrOamlPw5N\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"7902\" name=\"7902\">Take a look at the YARN History Server.</p><pre class=\"graf graf--pre graf-after--p\" id=\"aace\" name=\"aace\">/usr/bin/google-chrome \\<br/>--proxy-server=\u201dsocks5://localhost:1080\" \\<br/>--user-data-dir=\u201d/tmp/history-server-m\u201d \\<br/><a class=\"markup--anchor markup--pre-anchor\" data-href=\"http://history-server-m:10020\" href=\"http://history-server-m:10020\" rel=\"nofollow noopener\" target=\"_blank\">http://history-server-m:10020</a></pre><figure class=\"graf graf--figure graf-after--pre\" id=\"dfa6\" name=\"dfa6\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 255px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 36.5%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*qeMmzqYTODOga4De\" data-height=\"547\" data-image-id=\"0*qeMmzqYTODOga4De\" data-width=\"1500\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*qeMmzqYTODOga4De?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*qeMmzqYTODOga4De\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*qeMmzqYTODOga4De\"/></noscript></div></div></figure><h3 class=\"graf graf--h3 graf-after--figure\" id=\"902c\" name=\"902c\">Closing Thoughts</h3><p class=\"graf graf--p graf-after--h3\" id=\"5d78\" name=\"5d78\">While this is just an example, hopefully it paints a picture of how you can maintain the logs that are important for diagnosing misbehaving jobs and still confidently destroy clusters when jobs complete. Depending on your team structure, you could build on top of this to:</p><ul class=\"postList\"><li class=\"graf graf--li graf-after--p\" id=\"a81d\" name=\"a81d\">If the engineers that author your pipelines do not also make infrastructure decisions: Create an API on top of workflow templates that abstracts these cluster configuration details away from your ETL engineers and allow them to just worry about writing their pipelines.</li><li class=\"graf graf--li graf-after--li\" id=\"710f\" name=\"710f\">If your ETL pipeline engineers want control over the infrastructure their pipelines run on: Implement a practice where each time your ETL engineer defines a job part of that job definition includes a workflow template that captures their job and the appropriate cluster configuration for it to run on. The configuration in this example can serve as boiler plate to configure the logging pattern discussed in this post.</li></ul><h4 class=\"graf graf--h4 graf-after--li\" id=\"3e4a\" name=\"3e4a\">Clean Up</h4><p class=\"graf graf--p graf-after--h4\" id=\"5eef\" name=\"5eef\">Don\u2019t forget to tear down the resources unless you want to pay for them\u00a0:).</p><figure class=\"graf graf--figure graf--iframe graf-after--p\" id=\"9f2c\" name=\"9f2c\"><div class=\"aspectRatioPlaceholder is-locked\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 53.300000000000004%;\"></div><div class=\"progressiveMedia js-progressiveMedia\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://i.embed.ly/1/display/resize?url=https%3A%2F%2Fmedia.giphy.com%2Fmedia%2FOTszKBXzfG5e8%2Fgiphy.gif&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;width=40\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><div class=\"iframeContainer\"><iframe allowfullscreen=\"\" class=\"progressiveMedia-iframe js-progressiveMedia-iframe\" data-height=\"232\" data-media-id=\"7db7134c9121b0504602b72853dcc843\" data-src=\"/media/7db7134c9121b0504602b72853dcc843?postId=7b1b03a49686\" data-thumbnail=\"https://i.embed.ly/1/image?url=https%3A%2F%2Fmedia.giphy.com%2Fmedia%2FOTszKBXzfG5e8%2Fgiphy.gif&amp;key=a19fcc184b9711e1b4764040d3dc5c07\" data-width=\"435\" frameborder=\"0\" height=\"232\" width=\"435\"></iframe></div><noscript class=\"js-progressiveMedia-inner\"><div class=\"iframeContainer\"><iframe allowfullscreen=\"\" data-height=\"232\" data-media-id=\"7db7134c9121b0504602b72853dcc843\" data-thumbnail=\"https://i.embed.ly/1/image?url=https%3A%2F%2Fmedia.giphy.com%2Fmedia%2FOTszKBXzfG5e8%2Fgiphy.gif&amp;key=a19fcc184b9711e1b4764040d3dc5c07\" data-width=\"435\" frameborder=\"0\" height=\"232\" src=\"/media/7db7134c9121b0504602b72853dcc843?postId=7b1b03a49686\" width=\"435\"></iframe></div></noscript></div></div><figcaption class=\"imageCaption\">Listen to the \u201cThreat Level Midnight\u201d hero, and clean up the artifacts from this example.</figcaption></figure><p class=\"graf graf--p graf-after--figure\" id=\"b00d\" name=\"b00d\">If you spun up with terraform just run <code class=\"markup--code markup--p-code\">terraform destroy</code>\u00a0. If not, delete your infrastructure down in the cloud console or the with <code class=\"markup--code markup--p-code\">gcloud</code> in the following order:</p><ol class=\"postList\"><li class=\"graf graf--li graf-after--p\" id=\"451c\" name=\"451c\">Dataproc clusters <code class=\"markup--code markup--li-code\">glcoud dataproc clusters delete &lt;cluster-id&gt;</code></li><li class=\"graf graf--li graf-after--li\" id=\"9aa3\" name=\"9aa3\">GCS bucket <code class=\"markup--code markup--li-code\">gsutil rb &lt;bucket-name&gt;</code>, service account <code class=\"markup--code markup--li-code\">gcloud iam service-accounts delete &lt;service-account-id&gt;</code>, VPC subnet <code class=\"markup--code markup--li-code\">gcloud compute networks subnets delete &lt;subnet-name&gt;</code></li><li class=\"graf graf--li graf-after--li graf--trailing\" id=\"82cf\" name=\"82cf\">VPC network <code class=\"markup--code markup--li-code\">gcloud compute networks delete &lt;network-name&gt;</code></li></ol></div></div></section></div><footer class=\"u-paddingTop10\"><div class=\"container u-maxWidth740\"><div class=\"row\"><div class=\"col u-size12of12\"><div class=\"postMetaInline postMetaInline--acknowledgments u-paddingTop5 u-paddingBottom20 js-postMetaAcknowledgments\"><span data-tooltip=\"The following people helped the author by providing feedback before the story was published.\">Thanks to</span> <span><a class=\"link u-baseColor--link\" data-action=\"show-user-card\" data-action-source=\"post_page\" data-action-type=\"hover\" data-action-value=\"c183f06998a1\" data-user-id=\"c183f06998a1\" dir=\"auto\" href=\"https://medium.com/@danielrdeleo?source=post_page\">Daniel De Leo</a></span>. </div></div></div><div class=\"row\"><div class=\"col u-size12of12 js-postTags\"><div class=\"u-paddingBottom10\"><ul class=\"tags tags--postTags tags--borderless\"><li><a class=\"link u-baseColor--link\" data-action-source=\"post\" href=\"https://medium.com/tag/google-cloud-platform?source=post\">Google Cloud Platform</a></li></ul></div></div></div><div class=\"postActions js-postActionsFooter\"><div class=\"u-flexCenter\"><div class=\"u-flex1\"><div class=\"multirecommend js-actionMultirecommend u-flexCenter\" data-clap-string-plural=\"claps\" data-clap-string-singular=\"clap\" data-has-recommend-list=\"true\" data-is-circle=\"true\" data-is-icon-29px=\"true\" data-post-id=\"7b1b03a49686\" data-source=\"post_actions_footer-----7b1b03a49686---------------------clap_footer\"><div class=\"u-relative u-foreground\"><button aria-label=\"Clap\" class=\"button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal clap-onboardingcollection\" data-action=\"sign-up-prompt\" data-action-source=\"post_actions_footer-----7b1b03a49686---------------------clap_footer\" data-redirect=\"https://medium.com/_/vote/p/7b1b03a49686\" data-requires-token=\"true\" data-sign-in-action=\"multivote\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0\"><svg class=\"svgIcon-use\" height=\"33\" width=\"33\"><path d=\"M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z\" fill-rule=\"evenodd\"></path></svg></span></span><span class=\"button-activeState\"><span class=\"svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0\"><svg class=\"svgIcon-use\" height=\"33\" width=\"33\"><g fill-rule=\"evenodd\"><path d=\"M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z\"></path><path d=\"M13.285.48l-1.916.881 2.37 2.837z\"></path><path d=\"M21.719 1.361L19.79.501l-.44 3.697z\"></path><path d=\"M16.502 3.298L15.481 0h2.043z\"></path></g></svg></span></span></button><div class=\"clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Springu-backgroundGrayLighter js-clapUndo\" style=\"top: 14px; padding: 2px;\"><button class=\"button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight\" data-action=\"multivote-undo\" data-action-value=\"7b1b03a49686\"><span class=\"svgIcon svgIcon--removeThin svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61\" fill-rule=\"evenodd\"></path></svg></span></button></div></div><span class=\"u-relative u-background js-actionMultirecommendCount u-marginLeft16\"><button class=\"button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-textColorDarker\" data-action=\"show-recommends\" data-action-value=\"7b1b03a49686\">13 claps</button><span class=\"u-xs-hide\"></span></span></div></div><div class=\"buttonSet u-flex0\"><a aria-label=\"Share on Twitter\" class=\"button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless u-xs-hide u-marginRight12\" data-action-source=\"post_actions_footer\" href=\"https://medium.com/p/7b1b03a49686/share/twitter\" target=\"_blank\" title=\"Share on Twitter\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--twitterFilled svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z\"></path></svg></span></span></a><a aria-label=\"Share on Facebook\" class=\"button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless u-xs-hide u-marginRight12\" data-action-source=\"post_actions_footer\" href=\"https://medium.com/p/7b1b03a49686/share/facebook\" target=\"_blank\" title=\"Share on Facebook\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--facebookSquare svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79\"></path></svg></span></span></a><button aria-label=\"Share this story on Twitter or Facebook\" class=\"button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show u-marginRight10\" data-action=\"show-share-popover\" data-action-source=\"post_actions_footer\" title=\"Share this story on Twitter or Facebook\"><span class=\"svgIcon svgIcon--share svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706\" fill-rule=\"evenodd\"></path></svg></span></button><button class=\"button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon\" data-action=\"show-membership-respond-warning\" data-action-source=\"post_actions_footer\"><span class=\"svgIcon svgIcon--response svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z\"></path></svg></span></button><button aria-label=\"Bookmark this story to read later\" class=\"button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton\" data-action=\"sign-up-prompt\" data-action-source=\"post_actions_footer\" data-redirect=\"https://medium.com/_/bookmark/p/7b1b03a49686\" data-requires-token=\"true\" data-sign-in-action=\"add-to-bookmarks\" title=\"Bookmark this story to read later\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--bookmark svgIcon--29px u-marginRight4\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z\" fill-rule=\"evenodd\"></path></svg></span></span><span class=\"button-activeState\"><span class=\"svgIcon svgIcon--bookmarkFilled svgIcon--29px u-marginRight4\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z\" fill-rule=\"evenodd\"></path></svg></span></span></button><button aria-label=\"More actions\" class=\"button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon js-moreActionsButton\" data-action=\"more-actions\" title=\"More actions\"><span class=\"svgIcon svgIcon--more svgIcon--25px\"><svg class=\"svgIcon-use\" height=\"25\" viewbox=\"-480.5 272.5 21 21\" width=\"25\"><path d=\"M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z\"></path></svg></span></button></div></div></div></div><div class=\"u-maxWidth740 u-paddingTop20 u-marginTop20 u-borderTopLightest container u-paddingBottom20 u-xs-paddingBottom10 js-postAttributionFooterContainer\"><div class=\"row js-postFooterInfo\"><div class=\"col u-size6of12 u-xs-size12of12\"><li class=\"uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardUser\"><div class=\"u-marginLeft20 u-floatRight\"><span class=\"followState js-followState\" data-user-id=\"3b0d197b82f8\"><button class=\"button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton\" data-action=\"sign-up-prompt\" data-action-source=\"footer_card\" data-redirect=\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\" data-requires-token=\"true\" data-sign-in-action=\"toggle-block-user\"><span class=\"button-label button-defaultState\">Blocked</span><span class=\"button-label button-hoverState\">Unblock</span></button><button class=\"button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton\" data-action=\"sign-up-prompt\" data-action-source=\"footer_card-3b0d197b82f8-------------------------follow_footer\" data-redirect=\"https://medium.com/_/subscribe/user/3b0d197b82f8\" data-requires-token=\"true\" data-sign-in-action=\"toggle-subscribe-user\"><span class=\"button-label button-defaultState js-buttonLabel\">Follow</span><span class=\"button-label button-activeState\">Following</span></button></span></div><div class=\"u-tableCell\"><a aria-label=\"Go to the profile of Jacob Ferriero\" class=\"link u-baseColor--link avatar\" data-action-source=\"footer_card\" data-user-id=\"3b0d197b82f8\" dir=\"auto\" href=\"https://medium.com/@jtferriero?source=footer_card\" title=\"Go to the profile of Jacob Ferriero\"><div class=\"u-relative u-inlineBlock u-flex0\"><img alt=\"Go to the profile of Jacob Ferriero\" class=\"avatar-image avatar-image--small\" src=\"https://cdn-images-1.medium.com/fit/c/120/120/1*HV-Gei_diNhBWCBKaMSesw.jpeg\"/><div class=\"avatar-halo u-absolute u-textColorGreenNormal svgIcon\" style=\"width: calc(100% + 12px); height: calc(100% + 12px); top:-6px; left:-6px\"><svg viewbox=\"0 0 114 114\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M7.66922967,32.092726 C17.0070768,13.6353618 35.9421928,1.75 57,1.75 C78.0578072,1.75 96.9929232,13.6353618 106.33077,32.092726 L107.66923,31.4155801 C98.0784505,12.4582656 78.6289015,0.25 57,0.25 C35.3710985,0.25 15.9215495,12.4582656 6.33077033,31.4155801 L7.66922967,32.092726 Z\"></path><path d=\"M106.33077,81.661427 C96.9929232,100.118791 78.0578072,112.004153 57,112.004153 C35.9421928,112.004153 17.0070768,100.118791 7.66922967,81.661427 L6.33077033,82.338573 C15.9215495,101.295887 35.3710985,113.504153 57,113.504153 C78.6289015,113.504153 98.0784505,101.295887 107.66923,82.338573 L106.33077,81.661427 Z\"></path></svg></div></div></a></div><div class=\"u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15\"><h3 class=\"ui-h3 u-fontSize18 u-lineHeightTighter\"><a aria-label=\"Go to the profile of Jacob Ferriero\" class=\"link link--primary u-accentColor--hoverTextNormal\" data-user-id=\"3b0d197b82f8\" dir=\"auto\" href=\"https://medium.com/@jtferriero\" property=\"cc:attributionName\" rel=\"author cc:attributionUrl\" title=\"Go to the profile of Jacob Ferriero\">Jacob Ferriero</a></h3><div class=\"ui-caption u-textColorGreenNormal u-fontSize13 u-tintSpectrum u-accentColor--textNormal u-marginBottom7\">Medium member since Oct 2018</div><p class=\"ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4\">Data Engineer <a href=\"http://twitter.com/Google\" target=\"_blank\" title=\"Twitter profile for @Google\">@Google</a></p></div></li></div><div class=\"col u-size6of12 u-xs-size12of12 u-xs-marginTop30\"><li class=\"uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardCollection\"><div class=\"u-marginLeft20 u-floatRight\"><button class=\"button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal js-relationshipButton\" data-action=\"sign-up-prompt\" data-action-source=\"footer_card----e52cf94d98af----------------------follow_footer\" data-collection-id=\"e52cf94d98af\" data-redirect=\"https://medium.com/_/subscribe/collection/google-cloud\" data-requires-token=\"true\" data-sign-in-action=\"toggle-follow-collection\"><span class=\"button-label js-buttonLabel\">Follow</span></button></div><div class=\"u-tableCell\"><a aria-label=\"Go to Google Cloud Platform - Community\" class=\"link u-baseColor--link avatar avatar--roundedRectangle\" data-action-source=\"footer_card\" href=\"https://medium.com/google-cloud?source=footer_card\" title=\"Go to Google Cloud Platform - Community\"><img alt=\"Google Cloud Platform - Community\" class=\"avatar-image u-size60x60\" src=\"https://cdn-images-1.medium.com/fit/c/120/120/1*FUjLiCANvATKeaJEeg20Rw.png\"/></a></div><div class=\"u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15\"><h3 class=\"ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4\"><a class=\"link link--primary u-accentColor--hoverTextNormal\" data-action-source=\"footer_card\" href=\"https://medium.com/google-cloud?source=footer_card\" rel=\"collection\">Google Cloud Platform - Community</a></h3><p class=\"ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4\">A collection of technical articles published or curated by Google Cloud Platform Developer Advocates. The views expressed are those of the authors and don't necessarily reflect those of Google.</p><div class=\"buttonSet\"></div></div></li></div></div></div><div class=\"js-postFooterPlacements\" data-collection-id=\"e52cf94d98af\" data-post-id=\"7b1b03a49686\"></div><div class=\"u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper\"></div><div class=\"supplementalPostContent js-heroPromo\"></div></footer></article></main><aside class=\"u-marginAuto u-maxWidth1032 js-postLeftSidebar\"><div class=\"u-foreground u-top0 u-transition--fadeOut300 u-fixed u-sm-hide js-postShareWidget\"><ul><li class=\"u-marginVertical10\"><div class=\"multirecommend js-actionMultirecommend u-flexCenter\" data-has-recommend-list=\"true\" data-is-icon-29px=\"true\" data-post-id=\"7b1b03a49686\" data-source=\"post_share_widget-----7b1b03a49686---------------------clap_sidebar\"><div class=\"u-relative u-foreground\"><button aria-label=\"Clap\" class=\"button button--primary button--large button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker\" data-action=\"sign-up-prompt\" data-action-source=\"post_share_widget-----7b1b03a49686---------------------clap_sidebar\" data-redirect=\"https://medium.com/_/vote/p/7b1b03a49686\" data-requires-token=\"true\" data-sign-in-action=\"multivote\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--clap svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><g fill-rule=\"evenodd\"><path d=\"M13.739 1l.761 2.966L15.261 1z\"></path><path d=\"M16.815 4.776l1.84-2.551-1.43-.471z\"></path><path d=\"M10.378 2.224l1.84 2.551-.408-3.022z\"></path><path d=\"M22.382 22.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L6.11 15.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L8.43 9.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L20.628 15c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM12.99 6.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z\"></path></g></svg></span></span><span class=\"button-activeState\"><span class=\"svgIcon svgIcon--clapFilled svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><g fill-rule=\"evenodd\"><path d=\"M13.738 1l.762 2.966L15.262 1z\"></path><path d=\"M18.634 2.224l-1.432-.47-.408 3.022z\"></path><path d=\"M11.79 1.754l-1.431.47 1.84 2.552z\"></path><path d=\"M24.472 14.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914\"></path><path d=\"M14.58 10.887c-.156-.83.096-1.569.692-2.142L12.78 6.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z\"></path><path d=\"M17.812 10.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L9.2 7.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L7.046 9.54 5.802 8.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394l1.241 1.241 4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L4.89 11.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C21.74 20.8 22.271 18 20.62 14.982l-2.809-4.942z\"></path></g></svg></span></span></button></div><span class=\"u-relative u-background js-actionMultirecommendCount u-marginLeft5\"><button class=\"button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton\" data-action=\"show-recommends\" data-action-value=\"7b1b03a49686\">13</button></span></div></li><li class=\"u-marginVertical10 u-marginLeft3\"><button aria-label=\"Bookmark this story to read later\" class=\"button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton\" data-action=\"sign-up-prompt\" data-action-source=\"post_share_widget-----7b1b03a49686---------------------bookmark_sidebar\" data-redirect=\"https://medium.com/_/bookmark/p/7b1b03a49686\" data-requires-token=\"true\" data-sign-in-action=\"add-to-bookmarks\" title=\"Bookmark this story to read later\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--bookmark svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z\" fill-rule=\"evenodd\"></path></svg></span></span><span class=\"button-activeState\"><span class=\"svgIcon svgIcon--bookmarkFilled svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z\" fill-rule=\"evenodd\"></path></svg></span></span></button></li><li class=\"u-marginVertical10 u-marginLeft3\"><a aria-label=\"Share on Twitter\" class=\"button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless\" data-action-source=\"post_share_widget\" href=\"https://medium.com/p/7b1b03a49686/share/twitter\" target=\"_blank\" title=\"Share on Twitter\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--twitterFilled svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z\"></path></svg></span></span></a></li><li class=\"u-marginVertical10 u-marginLeft3\"><a aria-label=\"Share on Facebook\" class=\"button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless\" data-action-source=\"post_share_widget\" href=\"https://medium.com/p/7b1b03a49686/share/facebook\" target=\"_blank\" title=\"Share on Facebook\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--facebookSquare svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79\"></path></svg></span></span></a></li></ul></div></aside><style class=\"js-collectionStyle\">\n.u-accentColor--borderLight {border-color: #02B875 !important;}\n.u-accentColor--borderNormal {border-color: #02B875 !important;}\n.u-accentColor--borderDark {border-color: #1C9963 !important;}\n.u-accentColor--iconLight .svgIcon,.u-accentColor--iconLight.svgIcon {fill: #02B875 !important;}\n.u-accentColor--iconNormal .svgIcon,.u-accentColor--iconNormal.svgIcon {fill: #02B875 !important;}\n.u-accentColor--iconDark .svgIcon,.u-accentColor--iconDark.svgIcon {fill: #1C9963 !important;}\n.u-accentColor--textNormal {color: #1C9963 !important;}\n.u-accentColor--hoverTextNormal:hover {color: #1C9963 !important;}\n.u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #1C9963 !important;}\n.u-accentColor--textDark {color: #1C9963 !important;}\n.u-accentColor--backgroundLight {background-color: #02B875 !important;}\n.u-accentColor--backgroundNormal {background-color: #02B875 !important;}\n.u-accentColor--backgroundDark {background-color: #1C9963 !important;}\n.u-accentColor--buttonDark {border-color: #1C9963 !important; color: #1C9963 !important;}\n.u-accentColor--buttonDark:hover {border-color: #1C9963 !important;}\n.u-accentColor--buttonDark .icon:before,.u-accentColor--buttonDark .svgIcon{color: #1C9963 !important; fill: #1C9963 !important;}\n.u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #02B875 !important; color: #1C9963 !important;}\n.u-accentColor--buttonNormal:hover {border-color: #1C9963 !important;}\n.u-accentColor--buttonNormal .icon:before,.u-accentColor--buttonNormal .svgIcon{color: #02B875 !important; fill: #02B875 !important;}\n.u-accentColor--buttonNormal.button--filled .icon:before,.u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-accentColor--buttonDark.button--filled,.u-accentColor--buttonDark.button--withChrome.is-active,.u-accentColor--fillWhenActive.is-active {background-color: #1C9963 !important; border-color: #1C9963 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #02B875 !important; border-color: #02B875 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.postArticle.is-withAccentColors .markup--user,.postArticle.is-withAccentColors .markup--query {color: #1C9963 !important;}\n.u-accentColor--highlightFaint {background-color: rgba(233, 253, 240, 1) !important;}\n.u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(125, 255, 179, 1) !important;}\n.postArticle.is-withAccentColors .markup--quote.is-other {background-color: rgba(233, 253, 240, 1) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(233, 253, 240, 1), rgba(233, 253, 240, 1));}\n.postArticle.is-withAccentColors .markup--quote.is-me {background-color: rgba(173, 255, 207, 1) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(173, 255, 207, 1), rgba(173, 255, 207, 1));}\n.postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: rgba(125, 255, 179, 1) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(125, 255, 179, 1), rgba(125, 255, 179, 1));}\n.postArticle.is-withAccentColors .markup--quote.is-selected {background-color: rgba(125, 255, 179, 1) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(125, 255, 179, 1), rgba(125, 255, 179, 1));}\n.postArticle.is-withAccentColors .markup--highlight {background-color: rgba(125, 255, 179, 1) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(125, 255, 179, 1), rgba(125, 255, 179, 1));}.u-baseColor--iconNormal.avatar-halo {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}</style><style class=\"js-collectionStyleConstant\">.u-imageBgColor {background-color: rgba(0, 0, 0, 0.24705882352941178);}\n.u-imageSpectrum .u-baseColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}\n.u-imageSpectrum .u-baseColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}\n.u-imageSpectrum .u-baseColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--iconLight .svgIcon,.u-imageSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}\n.u-imageSpectrum .u-baseColor--iconNormal .svgIcon,.u-imageSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--iconDark .svgIcon,.u-imageSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--textDark {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--textDarker {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}\n.u-imageSpectrum .u-baseColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--buttonLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important; color: rgba(255, 255, 255, 0.8) !important;}\n.u-imageSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}\n.u-imageSpectrum .u-baseColor--buttonLight .icon:before,.u-imageSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}\n.u-imageSpectrum .u-baseColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--buttonDark .icon:before,.u-imageSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--buttonNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--buttonNormal .icon:before,.u-imageSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--buttonDark.button--filled,.u-imageSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}\n.u-imageSpectrum .u-baseColor--buttonNormal.button--filled,.u-imageSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}\n.u-imageSpectrum .u-baseColor--link {color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--link.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--darken:active {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--link.link--dark {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--link.link--darker {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(255, 255, 255, 0.8);}\n.u-imageSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(255, 255, 255, 0.8);}\n.u-imageSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(255, 255, 255, 0.8);}\n.u-imageSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum  .ui-h1,.u-imageSpectrum  .ui-h2,.u-imageSpectrum  .ui-h3,.u-imageSpectrum  .ui-h4,.u-imageSpectrum  .ui-brand1,.u-imageSpectrum  .ui-brand2,.u-imageSpectrum  .ui-captionStrong {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum  .ui-body,.u-imageSpectrum  .ui-caps {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum  .ui-summary,.u-imageSpectrum  .ui-caption {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}\n.u-imageSpectrum .u-accentColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}\n.u-imageSpectrum .u-accentColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}\n.u-imageSpectrum .u-accentColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--iconLight .svgIcon,.u-imageSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}\n.u-imageSpectrum .u-accentColor--iconNormal .svgIcon,.u-imageSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--iconDark .svgIcon,.u-imageSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--textDark {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}\n.u-imageSpectrum .u-accentColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--buttonDark .icon:before,.u-imageSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--buttonNormal .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}\n.u-imageSpectrum .u-accentColor--buttonDark.button--filled,.u-imageSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-imageSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}\n.u-imageSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-imageSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}\n.u-imageSpectrum .postArticle.is-withAccentColors .markup--user,.u-imageSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--highlightFaint {background-color: rgba(255, 255, 255, 0.2) !important;}\n.u-imageSpectrum .u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(255, 255, 255, 0.6) !important;}\n.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: rgba(255, 255, 255, 0.2) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2));}\n.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: rgba(255, 255, 255, 0.4) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.4), rgba(255, 255, 255, 0.4));}\n.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: rgba(255, 255, 255, 0.6) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}\n.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: rgba(255, 255, 255, 0.6) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}\n.postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: rgba(255, 255, 255, 0.6) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}.u-resetSpectrum .u-tintBgColor {background-color: rgba(255, 255, 255, 1) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 100%) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 100%) !important;}\n.u-resetSpectrum .u-baseColor--borderLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--borderNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--borderDark {border-color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--iconLight .svgIcon,.u-resetSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--iconNormal .svgIcon,.u-resetSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--iconDark .svgIcon,.u-resetSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--textNormal {color: rgba(0, 0, 0, 0.4980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--textDark {color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--textDarker {color: rgba(0, 0, 0, 0.8) !important;}\n.u-resetSpectrum .u-baseColor--backgroundLight {background-color: rgba(0, 0, 0, 0.09803921568627451) !important;}\n.u-resetSpectrum .u-baseColor--backgroundNormal {background-color: rgba(0, 0, 0, 0.2) !important;}\n.u-resetSpectrum .u-baseColor--backgroundDark {background-color: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--buttonLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--buttonLight .icon:before,.u-resetSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--buttonDark {border-color: rgba(0, 0, 0, 0.6) !important; color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(0, 0, 0, 0.8) !important;}\n.u-resetSpectrum .u-baseColor--buttonDark .icon:before,.u-resetSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--buttonNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important; color: rgba(0, 0, 0, 0.4980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--buttonNormal .icon:before,.u-resetSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(0, 0, 0, 0.4980392156862745) !important; fill: rgba(0, 0, 0, 0.4980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--buttonDark.button--filled,.u-resetSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2980392156862745) !important; border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-resetSpectrum .u-baseColor--buttonNormal.button--filled,.u-resetSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2) !important; border-color: rgba(0, 0, 0, 0.2) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-resetSpectrum .u-baseColor--link {color: rgba(0, 0, 0, 0.4980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--link.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--darken:active {color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--link.link--dark {color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(0, 0, 0, 0.8) !important;}\n.u-resetSpectrum .u-baseColor--link.link--darker {color: rgba(0, 0, 0, 0.8) !important;}\n.u-resetSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}\n.u-resetSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}\n.u-resetSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}\n.u-resetSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum  .ui-h1,.u-resetSpectrum  .ui-h2,.u-resetSpectrum  .ui-h3,.u-resetSpectrum  .ui-h4,.u-resetSpectrum  .ui-brand1,.u-resetSpectrum  .ui-brand2,.u-resetSpectrum  .ui-captionStrong {color: rgba(0, 0, 0, 0.8) !important; fill: rgba(0, 0, 0, 0.8) !important;}\n.u-resetSpectrum  .ui-body,.u-resetSpectrum  .ui-caps {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum  .ui-summary,.u-resetSpectrum  .ui-caption {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-accentColor--borderLight {border-color: rgba(2, 184, 117, 1) !important;}\n.u-resetSpectrum .u-accentColor--borderNormal {border-color: rgba(2, 184, 117, 1) !important;}\n.u-resetSpectrum .u-accentColor--borderDark {border-color: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--iconLight .svgIcon,.u-resetSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(2, 184, 117, 1) !important;}\n.u-resetSpectrum .u-accentColor--iconNormal .svgIcon,.u-resetSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--iconDark .svgIcon,.u-resetSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--textNormal {color: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--textDark {color: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--backgroundLight {background-color: rgba(2, 184, 117, 1) !important;}\n.u-resetSpectrum .u-accentColor--backgroundNormal {background-color: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--backgroundDark {background-color: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonDark {border-color: rgba(0, 171, 107, 1) !important; color: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonDark .icon:before,.u-resetSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(28, 153, 99, 1) !important; fill: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(2, 184, 117, 1) !important; color: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonNormal .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(0, 171, 107, 1) !important; fill: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonDark.button--filled,.u-resetSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-resetSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(28, 153, 99, 1) !important; border-color: rgba(28, 153, 99, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-resetSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(0, 171, 107, 1) !important; border-color: rgba(0, 171, 107, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-resetSpectrum .postArticle.is-withAccentColors .markup--user,.u-resetSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(0, 171, 107, 1) !important;}</style></div></div></div><div class=\"loadingBar\"></div><script>// <![CDATA[\nwindow[\"obvInit\"] = function (opt_embedded) {window[\"obvInit\"][\"embedded\"] = opt_embedded; window[\"obvInit\"][\"ready\"] = true;}\n// ]]></script><script>// <![CDATA[\nvar GLOBALS = {\"audioUrl\":\"https://d1fcbxp97j4nb2.cloudfront.net\",\"baseUrl\":\"https://medium.com\",\"buildLabel\":\"37089-823c9b4\",\"currentUser\":{\"userId\":\"lo_IHx7XZw0T0sc\",\"isVerified\":false,\"subscriberEmail\":\"\",\"hasPastMemberships\":false,\"isEnrolledInHightower\":false,\"isEligibleForHightower\":false,\"hightowerLastLockedAt\":0,\"isWriterProgramEnrolled\":false,\"isWriterProgramInvited\":false,\"isWriterProgramOptedOut\":false,\"writerProgramVersion\":0,\"writerProgramEnrolledAt\":0,\"friendLinkOnboarding\":0,\"hasAdditionalUnlocks\":false,\"hasApiAccess\":false,\"isQuarantined\":false,\"writerProgramDistributionSettingOptedIn\":false},\"currentUserHasUnverifiedEmail\":false,\"isAuthenticated\":false,\"isCurrentUserVerified\":false,\"miroUrl\":\"https://cdn-images-1.medium.com\",\"moduleUrls\":{\"base\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.IbkHvfLQzCD_wSB0aORB_Q.js\",\"common-async\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.htWnIUvdXGDiHIvvp2N7dw.js\",\"hightower\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-hightower.bundle.aT2OFc8Ccsu1VzDz-c0s8g.js\",\"home-screens\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.U3bY-35_vFokhgpKDpmBVw.js\",\"misc-screens\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.ksRllN8YzkymFaj-CrvFLA.js\",\"notes\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.3Lawe7ZU5a9e9z9jB-Uc9Q.js\",\"payments\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.J5j1KGPzOC52detbkGRWYQ.js\",\"posters\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.ph-GLSdgsAfDWIPCMPgLLg.js\",\"power-readers\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-power-readers.bundle.Ns-aXsnqdGPXVOPt0_AnsQ.js\",\"pubs\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-pubs.bundle.nHBfyugbb6I1JWtdPO600w.js\",\"stats\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.7nKgIEvisRK11udIOQk93g.js\"},\"previewConfig\":{\"weightThreshold\":1,\"weightImageParagraph\":0.51,\"weightIframeParagraph\":0.8,\"weightTextParagraph\":0.08,\"weightEmptyParagraph\":0,\"weightP\":0.003,\"weightH\":0.005,\"weightBq\":0.003,\"minPTextLength\":60,\"truncateBoundaryChars\":20,\"detectTitle\":true,\"detectTitleLevThreshold\":0.15},\"productName\":\"Medium\",\"supportsEdit\":true,\"termsUrl\":\"//medium.com/policy/9db0094a1e0f\",\"textshotHost\":\"textshot.medium.com\",\"transactionId\":\"1554318668488:31bcab5fbe98\",\"useragent\":{\"browser\":\"chrome\",\"family\":\"chrome\",\"os\":\"windows\",\"version\":49,\"supportsDesktopEdit\":true,\"supportsInteract\":true,\"supportsView\":true,\"isMobile\":false,\"isTablet\":false,\"isNative\":false,\"supportsFileAPI\":true,\"isTier1\":true,\"clientVersion\":\"\",\"unknownParagraphsBad\":false,\"clientChannel\":\"\",\"supportsRealScrollEvents\":true,\"supportsVhUnits\":true,\"ruinsViewportSections\":false,\"supportsHtml5Video\":true,\"supportsMagicUnderlines\":true,\"isWebView\":false,\"isFacebookWebView\":false,\"supportsProgressiveMedia\":true,\"supportsPromotedPosts\":true,\"isBot\":false,\"isNativeIphone\":false,\"supportsCssVariables\":true,\"supportsVideoSections\":true,\"emojiSupportLevel\":1,\"isSearchBot\":false,\"isSyndicationBot\":false,\"isNativeAndroid\":false,\"supportsScrollableMetabar\":true},\"variants\":{\"allow_access\":true,\"allow_signup\":true,\"allow_test_auth\":\"disallow\",\"signin_services\":\"twitter,facebook,google,email,google-fastidv,google-one-tap\",\"signup_services\":\"twitter,facebook,google,email,google-fastidv,google-one-tap\",\"google_sign_in_android\":true,\"reengagement_notification_duration\":3,\"browsable_stream_config_bucket\":\"curated-topics\",\"enable_dedicated_series_tab_api_ios\":true,\"enable_post_import\":true,\"available_monthly_plan\":\"60e220181034\",\"available_annual_plan\":\"2c754bcc2995\",\"disable_ios_resume_reading_toast\":true,\"is_not_medium_subscriber\":true,\"glyph_font_set\":\"m2\",\"enable_branding\":true,\"enable_branding_fonts\":true,\"max_premium_content_per_user_under_metering\":3,\"enable_automated_mission_control_triggers\":true,\"enable_lite_profile\":true,\"enable_marketing_emails\":true,\"enable_topic_lifecycle_email\":true,\"enable_parsely\":true,\"enable_branch_io\":true,\"enable_ios_post_stats\":true,\"enable_lite_topics\":true,\"enable_lite_stories\":true,\"redis_read_write_splitting\":true,\"enable_tipalti_onboarding\":true,\"enable_annual_renewal_reminder_email\":true,\"enable_janky_spam_rules\":\"users,posts\",\"enable_new_collaborative_filtering_data\":true,\"android_rating_prompt_stories_read_threshold\":2,\"enable_smart_meter_with_incentive\":true,\"stripe_v3\":true,\"enable_google_one_tap\":true,\"enable_email_sign_in_captcha\":true,\"enable_rito_sequence_post_recirc_query\":true,\"editorial_push_notifications\":true,\"enable_primary_topic_for_mobile\":true,\"enable_rito_sequence_post_handler\":true,\"enable_improved_stats_curation_status\":true,\"enable_logged_out_homepage_signup\":true,\"enable_email_signup_recirc\":true,\"use_new_admin_topic_backend\":true,\"enable_full_name_screen_refresh\":true,\"enable_quarantine_rules\":true,\"enable_lite_privacy_banner\":true,\"enable_simplified_welcome_email\":true},\"xsrfToken\":\"\",\"iosAppId\":\"828256236\",\"supportEmail\":\"yourfriends@medium.com\",\"fp\":{\"/icons/monogram-mask.svg\":\"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg\",\"/icons/favicon-dev-editor.ico\":\"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico\",\"/icons/favicon-hatch-editor.ico\":\"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico\",\"/icons/favicon-medium-editor.ico\":\"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico\"},\"authBaseUrl\":\"https://medium.com\",\"imageUploadSizeMb\":25,\"isAuthDomainRequest\":true,\"algoliaApiEndpoint\":\"https://MQ57UUUQZ2-dsn.algolia.net\",\"algoliaAppId\":\"MQ57UUUQZ2\",\"algoliaSearchOnlyApiKey\":\"394474ced050e3911ae2249ecc774921\",\"iosAppStoreUrl\":\"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8\",\"iosAppLinkBaseUrl\":\"medium:\",\"algoliaIndexPrefix\":\"medium_\",\"androidPlayStoreUrl\":\"https://play.google.com/store/apps/details?id=com.medium.reader\",\"googleClientId\":\"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com\",\"androidPackage\":\"com.medium.reader\",\"androidPlayStoreMarketScheme\":\"market://details?id=com.medium.reader\",\"googleAuthUri\":\"https://accounts.google.com/o/oauth2/auth\",\"androidScheme\":\"medium\",\"layoutData\":{\"useDynamicScripts\":false,\"googleAnalyticsTrackingCode\":\"UA-24232453-2\",\"jsShivUrl\":\"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js\",\"useDynamicCss\":false,\"faviconUrl\":\"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico\",\"faviconImageId\":\"1*8I-HPL0bfoIzGied-dzOvA.png\",\"fontSets\":[{\"id\":8,\"url\":\"https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css\"},{\"id\":11,\"url\":\"https://glyph.medium.com/css/m2.css\"},{\"id\":9,\"url\":\"https://glyph.medium.com/css/mkt.css\"}],\"editorFaviconUrl\":\"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium-editor.3Y6xpZ-0FSdWDnPM3hSBIA.ico\",\"glyphUrl\":\"https://glyph.medium.com\"},\"authBaseUrlRev\":\"moc.muidem//:sptth\",\"isDnt\":false,\"stripePublishableKey\":\"pk_live_7FReX44VnNIInZwrIIx6ghjl\",\"archiveUploadSizeMb\":100,\"paymentData\":{\"currencies\":{\"1\":{\"label\":\"US Dollar\",\"external\":\"usd\"}},\"countries\":{\"1\":{\"label\":\"United States of America\",\"external\":\"US\"}},\"accountTypes\":{\"1\":{\"label\":\"Individual\",\"external\":\"individual\"},\"2\":{\"label\":\"Company\",\"external\":\"company\"}}},\"previewConfig2\":{\"weightThreshold\":1,\"weightImageParagraph\":0.05,\"raiseImage\":true,\"enforceHeaderHierarchy\":true,\"isImageInsetRight\":true},\"isAmp\":false,\"iosScheme\":\"medium\",\"isSwBoot\":false,\"lightstep\":{\"accessToken\":\"ce5be895bef60919541332990ac9fef2\",\"carrier\":\"{\\\"ot-tracer-spanid\\\":\\\"75dc0e582e3d2524\\\",\\\"ot-tracer-traceid\\\":\\\"3693b769521233a0\\\",\\\"ot-tracer-sampled\\\":\\\"true\\\"}\",\"host\":\"collector-medium.lightstep.com\"},\"facebook\":{\"key\":\"542599432471018\",\"namespace\":\"medium-com\",\"scope\":{\"default\":[\"public_profile\",\"email\"],\"connect\":[\"public_profile\",\"email\"],\"login\":[\"public_profile\",\"email\"],\"share\":[\"public_profile\",\"email\"]}},\"editorsPicksTopicId\":\"3985d2a191c5\",\"popularOnMediumTopicId\":\"9d34e48ecf94\",\"memberContentTopicId\":\"13d7efd82fb2\",\"audioContentTopicId\":\"3792abbd134\",\"brandedSequenceId\":\"7d337ddf1941\",\"isDoNotAuth\":false,\"goldfinchUrl\":\"https://goldfinch.medium.com\",\"buggle\":{\"url\":\"https://buggle.medium.com\",\"videoUrl\":\"https://cdn-videos-1.medium.com\",\"audioUrl\":\"https://cdn-audio-1.medium.com\"},\"referrerType\":5,\"isMeteredOut\":false,\"meterConfig\":{\"maxUnlockCount\":3,\"windowLength\":\"MONTHLY\"},\"partnerProgramEmail\":\"partnerprogram@medium.com\",\"userResearchPrompts\":[{\"promptId\":\"lo_post_page_4\",\"type\":0,\"url\":\"www.calendly.com\"},{\"promptId\":\"lo_home_page\",\"type\":1,\"url\":\"www.calendly.com\"},{\"promptId\":\"lo_profile_page\",\"type\":2,\"url\":\"www.calendly.com\"}],\"recaptchaKey\":\"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ\",\"signinWallCustomDomainCollectionIds\":[\"3a8144eabfe3\",\"336d898217ee\",\"61061eb0c96b\",\"138adf9c44c\",\"819cc2aaeee0\"],\"countryCode\":\"A1\",\"bypassMeter\":false,\"branchKey\":\"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm\",\"paypal\":{\"clientMode\":\"production\",\"oneYearGift\":{\"name\":\"Medium Membership (1 Year, Digital Gift Code)\",\"description\":\"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com/redeem.\",\"price\":\"50.00\",\"currency\":\"USD\",\"sku\":\"membership-gift-1-yr\"}},\"collectionConfig\":{\"mediumOwnedAndOperatedCollectionIds\":[\"544c7006046e // Human Parts\",\"bcc38c8f6edf // Matter\",\"444d13b52878 // OneZero\"]}}\n// ]]></script><script async=\"\" charset=\"UTF-8\" src=\"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.IbkHvfLQzCD_wSB0aORB_Q.js\"></script><script>// <![CDATA[\nwindow[\"obvInit\"]({\"value\":{\"id\":\"7b1b03a49686\",\"versionId\":\"8776c12c9ba5\",\"creatorId\":\"3b0d197b82f8\",\"creator\":{\"userId\":\"3b0d197b82f8\",\"name\":\"Jacob Ferriero\",\"username\":\"jtferriero\",\"createdAt\":1503925606898,\"imageId\":\"1*HV-Gei_diNhBWCBKaMSesw.jpeg\",\"backgroundImageId\":\"\",\"bio\":\"Data Engineer @Google\",\"twitterScreenName\":\"\",\"socialStats\":{\"userId\":\"3b0d197b82f8\",\"usersFollowedCount\":7,\"usersFollowedByCount\":49,\"type\":\"SocialStats\"},\"social\":{\"userId\":\"lo_IHx7XZw0T0sc\",\"targetUserId\":\"3b0d197b82f8\",\"type\":\"Social\"},\"facebookAccountId\":\"\",\"allowNotes\":1,\"mediumMemberAt\":1539124629000,\"isNsfw\":false,\"isWriterProgramEnrolled\":true,\"isQuarantined\":false,\"type\":\"User\"},\"homeCollection\":{\"id\":\"e52cf94d98af\",\"name\":\"Google Cloud Platform - Community\",\"slug\":\"google-cloud\",\"tags\":[\"GOOGLE CLOUD PLATFORM\",\"DEVELOPERS\",\"CLOUD COMPUTING\",\"DEVOPS\",\"MACHINE LEARNING\"],\"creatorId\":\"a535baed6389\",\"description\":\"A collection of technical articles published or curated by Google Cloud Platform Developer Advocates. The views expressed are those of the authors and don't necessarily reflect those of Google.\",\"shortDescription\":\"A collection of technical articles published or curated by\u2026\",\"image\":{\"imageId\":\"1*FUjLiCANvATKeaJEeg20Rw.png\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":192,\"originalHeight\":192,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"metadata\":{\"followerCount\":24562,\"activeAt\":1554230801924},\"virtuals\":{\"permissions\":{\"canPublish\":false,\"canPublishAll\":false,\"canRepublish\":false,\"canRemove\":false,\"canManageAll\":false,\"canSubmit\":false,\"canEditPosts\":false,\"canAddWriters\":false,\"canViewStats\":false,\"canSendNewsletter\":false,\"canViewLockedPosts\":false,\"canViewCloaked\":false,\"canEditOwnPosts\":false,\"canBeAssignedAuthor\":false,\"canEnrollInHightower\":false,\"canLockPostsForMediumMembers\":false,\"canLockOwnPostsForMediumMembers\":false},\"isSubscribed\":false,\"isNewsletterSubscribed\":false,\"memberOfMembershipPlanId\":\"\",\"isEnrolledInHightower\":false,\"isEligibleForHightower\":false},\"logo\":{\"imageId\":\"1*FUjLiCANvATKeaJEeg20Rw.png\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":192,\"originalHeight\":192,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"twitterUsername\":\"gcpcloud\",\"facebookPageName\":\"googlecloud\",\"collectionMastheadId\":\"536cf63fce6\",\"sections\":[{\"type\":2,\"collectionHeaderMetadata\":{\"title\":\"Google Cloud Platform\",\"description\":\"Curated articles for developers\",\"backgroundImage\":{},\"logoImage\":{\"id\":\"1*Wbm0PGaB2AuerxdZb0SDUw.png\",\"originalWidth\":1024,\"originalHeight\":1024,\"alt\":\"Google Cloud Platform - Community\"},\"alignment\":2,\"layout\":5}},{\"type\":1,\"postListMetadata\":{\"source\":3,\"layout\":4,\"number\":10,\"postIds\":[\"719c317bf2df\",\"c3483e88a352\",\"84170ea44833\",\"b167d0eb487a\",\"63872b56a58e\",\"4cffa22e3348\",\"be418274d36c\",\"4e7873811e86\",\"42bbb1308e76\",\"76442253a45a\"]}},{\"type\":1,\"postListMetadata\":{\"source\":2,\"layout\":4,\"number\":7,\"postIds\":[],\"sectionHeader\":\"Trending\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":5,\"number\":10,\"postIds\":[],\"sectionHeader\":\"Latest\"}}],\"favicon\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"colorPalette\":{\"defaultBackgroundSpectrum\":{\"colorPoints\":[{\"color\":\"#FF02B875\",\"point\":0},{\"color\":\"#FF00AB6B\",\"point\":0.1},{\"color\":\"#FF1C9963\",\"point\":0.2},{\"color\":\"#FF092E20\",\"point\":1}],\"backgroundColor\":\"#FFFFFFFF\"},\"highlightSpectrum\":{\"colorPoints\":[{\"color\":\"#FFFFFFFF\",\"point\":0},{\"color\":\"#FFE9FDF0\",\"point\":0.1},{\"color\":\"#FFE2FAEE\",\"point\":0.2},{\"color\":\"#FFADFFCF\",\"point\":0.6},{\"color\":\"#FF7DFFB3\",\"point\":1}],\"backgroundColor\":\"#FFFFFFFF\"}},\"navItems\":[{\"type\":4,\"title\":\"This Week in GCP\",\"url\":\"https://medium.com/google-cloud/weekly/home\",\"topicId\":\"af575ce9e5c7\",\"source\":\"topicId\"},{\"type\":1,\"title\":\"Containers\",\"tagSlug\":\"kubernetes\",\"url\":\"https://medium.com/google-cloud/tagged/kubernetes\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"Virtualization\",\"tagSlug\":\"google-compute-engine\",\"url\":\"https://medium.com/google-cloud/tagged/google-compute-engine\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"Platform as a Service\",\"tagSlug\":\"google-app-engine\",\"url\":\"https://medium.com/google-cloud/tagged/google-app-engine\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"Data\",\"tagSlug\":\"bigquery\",\"url\":\"https://medium.com/google-cloud/tagged/bigquery\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"Machine Learning\",\"tagSlug\":\"machine-learning\",\"url\":\"https://medium.com/google-cloud/tagged/machine-learning\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"IoT\",\"tagSlug\":\"iot\",\"url\":\"https://medium.com/google-cloud/tagged/iot\",\"source\":\"tagSlug\"},{\"type\":3,\"title\":\"More\",\"url\":\"https://cloud.google.com/blog/\"}],\"colorBehavior\":1,\"instantArticlesState\":0,\"acceleratedMobilePagesState\":0,\"ampLogo\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"header\":{\"title\":\"Google Cloud Platform\",\"description\":\"Curated articles for developers\",\"backgroundImage\":{},\"logoImage\":{\"id\":\"1*Wbm0PGaB2AuerxdZb0SDUw.png\",\"originalWidth\":1024,\"originalHeight\":1024,\"alt\":\"Google Cloud Platform - Community\"},\"alignment\":2,\"layout\":5},\"type\":\"Collection\"},\"homeCollectionId\":\"e52cf94d98af\",\"title\":\"Persisting Application History from Ephemeral Clusters on Google Cloud Dataproc\",\"detectedLanguage\":\"en\",\"latestVersion\":\"8776c12c9ba5\",\"latestPublishedVersion\":\"8776c12c9ba5\",\"hasUnpublishedEdits\":false,\"latestRev\":5511,\"createdAt\":1550969167112,\"updatedAt\":1554236262531,\"acceptedAt\":0,\"firstPublishedAt\":1554229043832,\"latestPublishedAt\":1554230801789,\"vote\":false,\"experimentalCss\":\"\",\"displayAuthor\":\"\",\"content\":{\"subtitle\":\"So you want to use ephemeral Dataproc Clusters, but don\u2019t want to lose your valuable YARN and Spark history once my cluster is torn down.\",\"bodyModel\":{\"paragraphs\":[{\"name\":\"adf4\",\"type\":3,\"text\":\"Persisting Application History from Ephemeral Clusters on Google Cloud Dataproc\",\"markups\":[]},{\"name\":\"986f\",\"type\":1,\"text\":\"So you want to use ephemeral Dataproc Clusters, but don\u2019t want to lose your valuable YARN and Spark history once your cluster is torn down.\",\"markups\":[]},{\"name\":\"d8dc\",\"type\":1,\"text\":\"Enter the single node Dataproc cluster. It will serve as your persistent history server for MapReduce and Spark job history as well as a window into aggregated YARN logs.\",\"markups\":[{\"type\":3,\"start\":10,\"end\":38,\"href\":\"https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/single-node-clusters\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"8bd7\",\"type\":3,\"text\":\"Background\",\"markups\":[]},{\"name\":\"b487\",\"type\":1,\"text\":\"Hadoop engineers who have been around for a while are probably used to the YARN and Spark UIs for Application history. Some may even dig through the YARN container logs for a deeper layer of debugging. These UIs and container logs provide valuable information for diagnosing what went wrong during a certain job. In the cloud era (no pun intended) of cluster ephemerality, you\u2019d like to have a persistent way of accessing these familiar interfaces. Dataproc is the Google Cloud Platform service for managing Hadoop clusters, making it simple to spin-up and tear-down resources at will. This post outlines a pattern to have a single-node long-running Dataproc cluster that acts as an Application History Server for a shorter lived cluster (or several such clusters). This post follows best practices for creating long-running Dataproc environments as described in Google\u2019s blog plost: \u201c10 tips for building long-running clusters using Cloud Dataproc\u201d\",\"markups\":[{\"type\":3,\"start\":885,\"end\":948,\"href\":\"https://cloud.google.com/blog/products/data-analytics/10-tips-for-building-long-running-clusters-using-cloud-dataproc\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"d722\",\"type\":3,\"text\":\"What We\u2019re Building\",\"markups\":[]},{\"name\":\"3e6a\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*PatkVyBLe0rsHS69\",\"originalWidth\":797,\"originalHeight\":507,\"isFeatured\":true}},{\"name\":\"894d\",\"type\":9,\"text\":\"A GCS bucket to house cluster templates, initialization actions, aggregated YARN logs, Spark events and MapReduce done-dir and intermediate-done-dir.\",\"markups\":[{\"type\":10,\"start\":114,\"end\":122},{\"type\":10,\"start\":127,\"end\":148}]},{\"name\":\"e576\",\"type\":9,\"text\":\"A VPC network for your clusters. (Note: ssh access to private IP addressed machines could be provided by a VPN paired with this VPC, but this is out of scope for this example.)\",\"markups\":[]},{\"name\":\"7a8c\",\"type\":9,\"text\":\"A single-node Dataproc cluster for viewing the Spark and MapReduce job history UIs. This will have a public IP to allow simple SSH access via OS Login.\",\"markups\":[]},{\"name\":\"394c\",\"type\":9,\"text\":\"A Dataproc cluster configured to persist its YARN logs in GCS. This will not have public IP addresses.\",\"markups\":[]},{\"name\":\"0ccc\",\"type\":3,\"text\":\"Let\u2019s Get Building\",\"markups\":[]},{\"name\":\"2c61\",\"type\":1,\"text\":\"First things first we need to enable a few services in the project you wish to spin up this example.\",\"markups\":[{\"type\":3,\"start\":30,\"end\":51,\"href\":\"https://console.cloud.google.com/flows/enableapi?apiid=dataproc,compute\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"f2bc\",\"type\":8,\"text\":\"gcloud config set project \\x3cyour-project-id\\x3e\",\"markups\":[]},{\"name\":\"aed8\",\"type\":8,\"text\":\"gcloud services enable \\\\\\ncompute.googleapis.com \\\\\\ndataproc.googleapis.com\",\"markups\":[]},{\"name\":\"42c4\",\"type\":1,\"text\":\"Next, pull down the Google Cloud professional services repository and navigate to the source for this example.\",\"markups\":[{\"type\":3,\"start\":33,\"end\":54,\"href\":\"https://github.com/GoogleCloudPlatform/professional-services\",\"title\":\"\",\"rel\":\"noopener\",\"anchorType\":0}]},{\"name\":\"7566\",\"type\":8,\"text\":\"git clone https://github.com/GoogleCloudPlatform/professional-services.git\",\"markups\":[{\"type\":3,\"start\":10,\"end\":74,\"href\":\"https://github.com/GoogleCloudPlatform/professional-services.git\",\"title\":\"\",\"rel\":\"nofollow\",\"anchorType\":0}]},{\"name\":\"1e6f\",\"type\":8,\"text\":\"cd professional-services/examples/dataproc-persistent-history-server\",\"markups\":[]},{\"name\":\"aca5\",\"type\":3,\"text\":\"Using the Right Tool: gcloud vs Terraform\",\"markups\":[]},{\"name\":\"8d16\",\"type\":1,\"text\":\"Capturing and version controlling the configuration of your cloud environment has become best practice. However, engineers are faced with different ways of doing this. Terraform provides a lot of value when you are spinning up several permanent components of your infrastructure, with various dependencies. In other words Terraform is great when you want something to authoritatively capture the state of your environment. The methods provided by the Google Cloud SDK (ie. the gcloud CLI) are really convenient for spinning up a single resource during prototyping, and for managing ephemeral resources. When it comes to Dataproc clusters, if you plan to regularly tear down your cluster (as would be the case for a job scoped cluster), it is best to capture the configuration as a cluster template yaml (this can be exported from an existing cluster or written by hand). It doesn\u2019t make sense to reapply a terraform plan at the beginning and end of jobs to manage cluster spin-up /tear down, as this could be prone to breaking.\",\"markups\":[{\"type\":10,\"start\":477,\"end\":483},{\"type\":3,\"start\":168,\"end\":177,\"href\":\"https://terraform.io\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0},{\"type\":3,\"start\":816,\"end\":849,\"href\":\"https://cloud.google.com/sdk/gcloud/reference/beta/dataproc/clusters/export\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0},{\"type\":3,\"start\":853,\"end\":868,\"href\":\"https://cloud.google.com/dataproc/docs/reference/rest/v1/ClusterConfig\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"9256\",\"type\":1,\"text\":\"The code for this example provides both terraform and yaml for both the history server and a cluster configured to persist its logs on GCS. The thought behind this is\",\"markups\":[]},{\"name\":\"1052\",\"type\":9,\"text\":\"If you are treating your history server as a rather permanent part of your environment, it should be in terraform\",\"markups\":[]},{\"name\":\"ec07\",\"type\":9,\"text\":\"If you are treating the history server as something you spin up and tear down when you\u2019re using it then it makes more sense to create it using gcloud beta dataproc clusters import.\",\"markups\":[{\"type\":10,\"start\":143,\"end\":179},{\"type\":3,\"start\":127,\"end\":179,\"href\":\"https://cloud.google.com/sdk/gcloud/reference/beta/dataproc/clusters/import\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"0483\",\"type\":1,\"text\":\"Similarly, the ephemeral-cluster.yaml and long-running-cluster.tf will spin up congruent clusters. Choose which cluster configuration tool makes more sense for your use of that cluster.\",\"markups\":[{\"type\":10,\"start\":15,\"end\":37},{\"type\":10,\"start\":42,\"end\":65},{\"type\":3,\"start\":15,\"end\":37,\"href\":\"https://github.com/GoogleCloudPlatform/professional-services/blob/master/examples/dataproc-persistent-history-server/cluster_templates/ephemeral-cluster.yaml\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0},{\"type\":3,\"start\":42,\"end\":65,\"href\":\"https://github.com/GoogleCloudPlatform/professional-services/blob/master/examples/dataproc-persistent-history-server/terraform/long-running-cluster.tf\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"b06a\",\"type\":1,\"text\":\"If you are just trying to run this example, it\u2019s recommended you read the Google Cloud SDK Environment Setup without running the gcloud blocks. Just check out the professional services repo and read through the files in the terraform directory, set the appropriate values in terrafom.tfvars and apply the plan for this example. Note, you\u2019ll need to have terraform installed. This will greatly simplify tearing down all the resources for this example when you\u2019re done.\",\"markups\":[{\"type\":10,\"start\":129,\"end\":135},{\"type\":10,\"start\":224,\"end\":233},{\"type\":10,\"start\":275,\"end\":290},{\"type\":3,\"start\":163,\"end\":189,\"href\":\"https://github.com/GoogleCloudPlatform/professional-services\",\"title\":\"\",\"rel\":\"noopener\",\"anchorType\":0},{\"type\":3,\"start\":354,\"end\":363,\"href\":\"https://www.terraform.io/\",\"title\":\"\",\"rel\":\"noopener\",\"anchorType\":0}]},{\"name\":\"f3a8\",\"type\":3,\"text\":\"Terraform Environment Set Up\",\"markups\":[]},{\"name\":\"0302\",\"type\":1,\"text\":\"From the dataproc-persistent-history-server directory, run the following commands.\",\"markups\":[{\"type\":3,\"start\":9,\"end\":53,\"href\":\"https://github.com/GoogleCloudPlatform/professional-services/tree/master/examples/dataproc-persistent-history-server\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"3122\",\"type\":8,\"text\":\"cd terraform\\nterraform init\\nterraform plan\\nterraform apply\",\"markups\":[]},{\"name\":\"76c7\",\"type\":1,\"text\":\"You can skip the gcloud blocks in the next section, but I\u2019d recommend skimming for explanation as to why certain decisions were made for configuring the environment for this example.\",\"markups\":[{\"type\":10,\"start\":17,\"end\":23}]},{\"name\":\"1101\",\"type\":3,\"text\":\"Google Cloud SDK Environment Setup\",\"markups\":[{\"type\":10,\"start\":0,\"end\":17}]},{\"name\":\"f6bc\",\"type\":1,\"text\":\"This walk-through will spin up an environment using gcloud CLI while explaining each choice.\",\"markups\":[{\"type\":10,\"start\":52,\"end\":58}]},{\"name\":\"3c26\",\"type\":13,\"text\":\"Storage and Service Account Setup\",\"markups\":[]},{\"name\":\"523e\",\"type\":1,\"text\":\"Create a Google Cloud Storage Bucket in which you\u2019ll store your logs. It\u2019s a clean practice to keep logs in a separate bucket from your data to make the intention of the bucket clear and to simplify privileges.\",\"markups\":[]},{\"name\":\"072c\",\"type\":1,\"text\":\"(Note: You must stage an empty object in this GCS bucket so that the spark-events path exists before running a job, otherwise the job will fail.)\",\"markups\":[{\"type\":10,\"start\":69,\"end\":81},{\"type\":3,\"start\":82,\"end\":93,\"href\":\"https://spark.apache.org/docs/latest/monitoring.html#spark-history-server-configuration-options\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"bb4c\",\"type\":8,\"text\":\"gsutil mb -c regional -l us-central1 gs://my_history_bucket\\ntouch .keep\\ngsutil cp .keep gs://my_history_bucket/spark-events/.keep\\nrm .keep\",\"markups\":[]},{\"name\":\"35ac\",\"type\":1,\"text\":\"Create a service account for your history server.\",\"markups\":[]},{\"name\":\"fa7b\",\"type\":8,\"text\":\"gcloud iam service-accounts create history-server-account\",\"markups\":[]},{\"name\":\"84a1\",\"type\":1,\"text\":\"Give this service account permissions to run a Dataproc cluster:\",\"markups\":[]},{\"name\":\"4327\",\"type\":8,\"text\":\"gcloud projects add-iam-policy-binding project_id \\\\\\n--member=serviceAccount:history-server-account@project_id.iam.gserviceaccount.com \\\\\\n--role=roles/dataproc.worker\",\"markups\":[]},{\"name\":\"294a\",\"type\":1,\"text\":\"Grant read access to the history bucket:\",\"markups\":[]},{\"name\":\"0df0\",\"type\":8,\"text\":\"gsutil iam ch \\\\\\nserviceAccount:history-server-account@project_id.iam.gserviceaccount.com:objectViewer \\\\\\ngs://my_history_bucket\",\"markups\":[]},{\"name\":\"8377\",\"type\":13,\"text\":\"Setting up your Network\",\"markups\":[]},{\"name\":\"d0c4\",\"type\":1,\"text\":\"You want to take extra care in setting up the firewall rules to avoid the common security pitfall of exposing the YARN web interface port 8088 to the public internet allowing bad actors to submit jobs on your cluster. The recommended approach for engineers connecting to a cluster is to connect to your clusters via VPN that is peered with your VPC network. This way, engineers can ssh into clusters referencing their private IP addresses using the gcloud compute ssh \u2014 internal-ip \\x3ctarget-instance\\x3e. To automate Linux account creation you can enable OS Login. To keep this example simple, you will assign the history server a public IP address and a firewall rule to allow any ingress traffic on port 22.\",\"markups\":[{\"type\":10,\"start\":449,\"end\":499},{\"type\":3,\"start\":74,\"end\":97,\"href\":\"https://medium.com/@neerajsabharwal/hadoop-yarn-hack-9a72cc1328b6\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0},{\"type\":3,\"start\":287,\"end\":319,\"href\":\"https://cloud.google.com/compute/docs/instances/connecting-advanced#vpn\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0},{\"type\":3,\"start\":551,\"end\":559,\"href\":\"https://cloud.google.com/compute/docs/instances/managing-instance-access\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"7693\",\"type\":1,\"text\":\"Note: The firewall rule will expose an entry point to your Dataproc cluster from the public internet on port 22.\",\"markups\":[{\"type\":1,\"start\":0,\"end\":112}]},{\"name\":\"2547\",\"type\":1,\"text\":\"First things first, get your networking pre-requisites in order. The following command creates a regional network and specifies that we will create your own sub-networks.\",\"markups\":[]},{\"name\":\"2b1e\",\"type\":8,\"text\":\"gcloud compute networks create example-net \\\\\\n--bgp-routing-mode regional \\\\\\n--subnet-mode custom\",\"markups\":[]},{\"name\":\"243b\",\"type\":1,\"text\":\"Add a sub-network for Dataproc. The following command creates a subnet for dataproc in the us-central1 region. It specifies a CIDR range that specifies the range of internal IPs for the machines on this network from 10.128.0.0 to 10.128.255.255. We also enable private Google access, so that the machines without public IP addresses on this network can reach GCP services.\",\"markups\":[{\"type\":10,\"start\":216,\"end\":226},{\"type\":10,\"start\":230,\"end\":244},{\"type\":3,\"start\":254,\"end\":282,\"href\":\"https://cloud.google.com/vpc/docs/configure-private-google-access\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"673a\",\"type\":8,\"text\":\"gcloud compute networks subnets create \\\\\\nexample-hadoop-subnet-central \\\\\\n--range 10.128.0.0/16 \\\\\\n--network example-net \\\\\\n--region us-central1 \\\\\\n--enable-private-ip-google-access\",\"markups\":[]},{\"name\":\"f9b9\",\"type\":1,\"text\":\"Next, create a firewall rule to allow ssh for the hadoop-history-ui-access tag. For the source range you\u2019re following in suit with the default network and allowing ssh from all IPs. You should consider restricting this CIDR range to only those of the data engineering teams that would need to ssh to the cluster.\",\"markups\":[{\"type\":10,\"start\":50,\"end\":74}]},{\"name\":\"80a4\",\"type\":8,\"text\":\"gcloud compute firewall-rules create \\\\\\nexample-hadoop-subnet-central-hadoop-history-ui-ssh \\\\\\n--allow tcp:22 \\\\\\n--direction INGRESS \\\\\\n--network example-net \\\\\\n--target-tags hadoop-history-ui-access,hadoop-admin-ui-access \\\\\\n--source-ranges 0.0.0.0/0\",\"markups\":[]},{\"name\":\"8346\",\"type\":1,\"text\":\"Finally, Hadoop uses a lot of ports for communication between nodes so create this firewall rule as well to allow all tcp, udp and icmp traffic between nodes with any of the specified tags.\",\"markups\":[]},{\"name\":\"346e\",\"type\":8,\"text\":\"gcloud compute firewall-rules create \\\\\\nexample-hadoop-subnet-central \\\\\\n--allow tcp,udp,icmp \\\\\\n--source-tags hadoop-history-ui-access,hadoop-admin-ui-access \\\\\\n--target-tags hadoop-history-ui-access,hadoop-admin-ui-access\",\"markups\":[]},{\"name\":\"b6a0\",\"type\":13,\"text\":\"Spinning up a History Server\",\"markups\":[]},{\"name\":\"684a\",\"type\":1,\"text\":\"Think of this history server as a window to the logs you\u2019ve persisted on GCS. All of the state is captured on GCS so you can choose to spin this history server up and down at will or keep it running for convenience.\",\"markups\":[]},{\"name\":\"f96f\",\"type\":1,\"text\":\"However, keep in mind:\",\"markups\":[]},{\"name\":\"88ff\",\"type\":6,\"text\":\"\u2026 the MapReduce job history server only reads history from Cloud Storage when it first starts up. From that point forward, the only new job history you will see in the UI is for the jobs that were run on that cluster; in other words, these are jobs whose history was moved by that cluster\u2019s job history server. By contrast, the Spark job history server is completely stateless, so the previous caveats do not apply. \u2014 Mikayla Konst & Chris Crosbie: 10 tips for building long-running clusters using Cloud Dataproc\",\"markups\":[{\"type\":3,\"start\":449,\"end\":511,\"href\":\"http://10 tips for building long-running clusters using Cloud Dataproc\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"85cb\",\"type\":1,\"text\":\"Next, create a single-node Dataproc cluster on the sub-network created above. This will serve as your long-running Application History Server. You can use the history_server.yaml file to create the history server.\",\"markups\":[{\"type\":10,\"start\":159,\"end\":178}]},{\"name\":\"920f\",\"type\":1,\"text\":\"First, replace the placeholders in the yaml files by running the following sed commands.\",\"markups\":[{\"type\":10,\"start\":75,\"end\":78}]},{\"name\":\"2c40\",\"type\":8,\"text\":\"cd workflow_templates\\nsed -i 's/PROJECT/your-gcp-project-id/g' *\\nsed -i 's/HISTORY_BUCKET/your-history-bucket/g' *\\nsed -i 's/HISTORY_SERVER/your-history-server/g' *\\nsed -i 's/REGION/us-central1/g' *\\nsed -i 's/ZONE/us-central1-f/g' *\\nsed -i 's/SUBNET/your-subnet-id/g' *\\n\\ncd ../cluster_templates\\nsed -i 's/PROJECT/your-gcp-project-id/g' *\\nsed -i 's/HISTORY_BUCKET/your-history-bucket/g' *\\nsed -i 's/HISTORY_SERVER/your-history-server/g' *\\nsed -i 's/REGION/us-central1/g' *\\nsed -i 's/ZONE/us-central1-f/g' *\\nsed -i 's/SUBNET/your-subnet-id/g' *\",\"markups\":[{\"type\":10,\"start\":0,\"end\":542}]},{\"name\":\"8298\",\"type\":1,\"text\":\"Now you\u2019re ready to spin up the history server.\",\"markups\":[]},{\"name\":\"6d01\",\"type\":8,\"text\":\"cd ..\\ngcloud beta dataproc clusters import \\\\\\nhistory-server \\\\\\n--source=cluster_templates/history-server.yaml \\\\\\n--region=us-central1\",\"markups\":[]},{\"name\":\"8a72\",\"type\":3,\"text\":\"Creating a Cluster and Submitting Jobs\",\"markups\":[]},{\"name\":\"e75a\",\"type\":1,\"text\":\"Finally, spin up an ephemeral cluster, that\u2019s configured to write logs to Google Cloud Storage, so they can live long after your cluster is torn down. It\u2019s best practice to capture information about the clusters you are creating in a yaml file for consistent cluster creation.\",\"markups\":[]},{\"name\":\"5fde\",\"type\":1,\"text\":\"Note: The cluster yamls refer to an initialization action on GCS to disable the local history servers on the ephemeral clusters. This can be found in disable_history_servers.sh . You must stage this in your history bucket.\",\"markups\":[{\"type\":10,\"start\":150,\"end\":176},{\"type\":3,\"start\":35,\"end\":57,\"href\":\"https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/init-actions\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"e3dd\",\"type\":8,\"text\":\"gsutil cp init_actions/disable_history_servers.sh \\\\\\ngs://my_history_bucket/init_actions/\",\"markups\":[]},{\"name\":\"a27a\",\"type\":1,\"text\":\"You can manage cluster spin-up, submission of a Spark job, submission of a Hadoop job, and finally cluster tear-down with a workflow template. This is the most straightforward way to run this example. The job dependencies and cluster definition can be found in spark_mr_workflow_template.yaml.\",\"markups\":[{\"type\":10,\"start\":261,\"end\":292},{\"type\":3,\"start\":123,\"end\":141,\"href\":\"https://cloud.google.com/dataproc/docs/concepts/workflows/overview\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"242a\",\"type\":8,\"text\":\"gcloud dataproc workflow-templates instantiate-from-file \\\\\\nspark-mr-example \\\\\\n--region=us-central1 \\\\\\n--source=workflow_templates/spark_mr_workflow_template.yaml\",\"markups\":[]},{\"name\":\"e0f0\",\"type\":13,\"text\":\"Analyze Your Spark application history Long After Your Cluster Is Gone\",\"markups\":[]},{\"name\":\"902b\",\"type\":1,\"text\":\"Now that the cluster where you ran the job has been deleted, use an SSH tunnel to your history server in order to display the Spark History on your Chrome browser. The following commands are for a Linux OS, you can follow the instructions for your OS in the Dataproc docs.\",\"markups\":[{\"type\":3,\"start\":226,\"end\":250,\"href\":\"https://cloud.google.com/dataproc/docs/concepts/accessing/cluster-web-interfaces\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"bf6b\",\"type\":8,\"text\":\"gcloud compute ssh history-server-m \\\\\\n--project=your-project-id \\\\\\n--zone=us-central1-a \\\\\\n-- \\\\\\n-D 1080 -N\",\"markups\":[]},{\"name\":\"887d\",\"type\":1,\"text\":\"Connect Chrome through the proxy.\",\"markups\":[]},{\"name\":\"edf9\",\"type\":8,\"text\":\"/usr/bin/google-chrome \\\\\\n--proxy-server=\u201dsocks5://localhost:1080\\\" \\\\\\n--user-data-dir=\u201d/tmp/history-server-m\u201d \\\\\\nhttp://history-server-m:18080\",\"markups\":[{\"type\":3,\"start\":110,\"end\":139,\"href\":\"http://history-server-m:18080\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"0ee2\",\"type\":1,\"text\":\"This should launch the Chrome browser and you should be able to see the Spark History UI.\",\"markups\":[]},{\"name\":\"29f2\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*37lMnorrOamlPw5N\",\"originalWidth\":1200,\"originalHeight\":674}},{\"name\":\"7902\",\"type\":1,\"text\":\"Take a look at the YARN History Server.\",\"markups\":[]},{\"name\":\"aace\",\"type\":8,\"text\":\"/usr/bin/google-chrome \\\\\\n--proxy-server=\u201dsocks5://localhost:1080\\\" \\\\\\n--user-data-dir=\u201d/tmp/history-server-m\u201d \\\\\\nhttp://history-server-m:10020\",\"markups\":[{\"type\":3,\"start\":110,\"end\":139,\"href\":\"http://history-server-m:10020\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0}]},{\"name\":\"dfa6\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*qeMmzqYTODOga4De\",\"originalWidth\":1500,\"originalHeight\":547}},{\"name\":\"902c\",\"type\":3,\"text\":\"Closing Thoughts\",\"markups\":[]},{\"name\":\"5d78\",\"type\":1,\"text\":\"While this is just an example, hopefully it paints a picture of how you can maintain the logs that are important for diagnosing misbehaving jobs and still confidently destroy clusters when jobs complete. Depending on your team structure, you could build on top of this to:\",\"markups\":[]},{\"name\":\"a81d\",\"type\":9,\"text\":\"If the engineers that author your pipelines do not also make infrastructure decisions: Create an API on top of workflow templates that abstracts these cluster configuration details away from your ETL engineers and allow them to just worry about writing their pipelines.\",\"markups\":[]},{\"name\":\"710f\",\"type\":9,\"text\":\"If your ETL pipeline engineers want control over the infrastructure their pipelines run on: Implement a practice where each time your ETL engineer defines a job part of that job definition includes a workflow template that captures their job and the appropriate cluster configuration for it to run on. The configuration in this example can serve as boiler plate to configure the logging pattern discussed in this post.\",\"markups\":[]},{\"name\":\"3e4a\",\"type\":13,\"text\":\"Clean Up\",\"markups\":[]},{\"name\":\"5eef\",\"type\":1,\"text\":\"Don\u2019t forget to tear down the resources unless you want to pay for them :).\",\"markups\":[]},{\"name\":\"9f2c\",\"type\":11,\"text\":\"Listen to the \u201cThreat Level Midnight\u201d hero, and clean up the artifacts from this example.\",\"markups\":[],\"layout\":1,\"iframe\":{\"mediaResourceId\":\"7db7134c9121b0504602b72853dcc843\",\"iframeWidth\":435,\"iframeHeight\":232,\"thumbnailUrl\":\"https://i.embed.ly/1/image?url=https%3A%2F%2Fmedia.giphy.com%2Fmedia%2FOTszKBXzfG5e8%2Fgiphy.gif&key=a19fcc184b9711e1b4764040d3dc5c07\"}},{\"name\":\"b00d\",\"type\":1,\"text\":\"If you spun up with terraform just run terraform destroy . If not, delete your infrastructure down in the cloud console or the with gcloud in the following order:\",\"markups\":[{\"type\":10,\"start\":39,\"end\":56},{\"type\":10,\"start\":132,\"end\":138}]},{\"name\":\"451c\",\"type\":10,\"text\":\"Dataproc clusters glcoud dataproc clusters delete \\x3ccluster-id\\x3e\",\"markups\":[{\"type\":10,\"start\":18,\"end\":62}]},{\"name\":\"9aa3\",\"type\":10,\"text\":\"GCS bucket gsutil rb \\x3cbucket-name\\x3e, service account gcloud iam service-accounts delete \\x3cservice-account-id\\x3e, VPC subnet gcloud compute networks subnets delete \\x3csubnet-name\\x3e\",\"markups\":[{\"type\":10,\"start\":11,\"end\":34},{\"type\":10,\"start\":52,\"end\":107},{\"type\":10,\"start\":120,\"end\":172}]},{\"name\":\"82cf\",\"type\":10,\"text\":\"VPC network gcloud compute networks delete \\x3cnetwork-name\\x3e\",\"markups\":[{\"type\":10,\"start\":12,\"end\":57}]}],\"sections\":[{\"name\":\"8575\",\"startIndex\":0},{\"name\":\"0088\",\"startIndex\":3}]},\"postDisplay\":{\"coverless\":true}},\"virtuals\":{\"statusForCollection\":\"APPROVED\",\"allowNotes\":true,\"previewImage\":{\"imageId\":\"0*PatkVyBLe0rsHS69\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":797,\"originalHeight\":507,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"wordCount\":2235,\"imageCount\":3,\"readingTime\":8.983962264150945,\"subtitle\":\"So you want to use ephemeral Dataproc Clusters, but don\u2019t want to lose your valuable YARN and Spark history once my cluster is torn down.\",\"publishedInCount\":1,\"usersBySocialRecommends\":[],\"noIndex\":false,\"recommends\":3,\"socialRecommends\":[],\"isBookmarked\":false,\"tags\":[{\"slug\":\"google-cloud-platform\",\"name\":\"Google Cloud Platform\",\"postCount\":5170,\"metadata\":{\"postCount\":5170,\"coverImage\":{\"id\":\"1*7eSm8rEwDoBn4Fk2tNecWg.png\",\"originalWidth\":1152,\"originalHeight\":864,\"isFeatured\":true}},\"type\":\"Tag\"}],\"socialRecommendsCount\":0,\"responsesCreatedCount\":0,\"links\":{\"entries\":[{\"url\":\"http://10 tips for building long-running clusters using Cloud Dataproc\",\"alts\":[],\"httpStatus\":0},{\"url\":\"http://history-server-m:10020\",\"alts\":[],\"httpStatus\":0},{\"url\":\"http://history-server-m:18080\",\"alts\":[],\"httpStatus\":0},{\"url\":\"https://terraform.io\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://www.terraform.io/\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://spark.apache.org/docs/latest/monitoring.html#spark-history-server-configuration-options\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://github.com/GoogleCloudPlatform/professional-services/tree/master/examples/dataproc-persistent-history-server\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://github.com/GoogleCloudPlatform/professional-services/blob/master/examples/dataproc-persistent-history-server/cluster_templates/ephemeral-cluster.yaml\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://medium.com/@neerajsabharwal/hadoop-yarn-hack-9a72cc1328b6\",\"alts\":[{\"type\":2,\"url\":\"medium://p/9a72cc1328b6\"},{\"type\":3,\"url\":\"medium://p/9a72cc1328b6\"}],\"httpStatus\":200},{\"url\":\"https://console.cloud.google.com/flows/enableapi?apiid=dataproc,compute\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://github.com/GoogleCloudPlatform/professional-services/blob/master/examples/dataproc-persistent-history-server/terraform/long-running-cluster.tf\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://github.com/GoogleCloudPlatform/professional-services\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://github.com/GoogleCloudPlatform/professional-services.git\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://cloud.google.com/blog/products/data-analytics/10-tips-for-building-long-running-clusters-using-cloud-dataproc\",\"alts\":[{\"type\":1,\"url\":\"https://cdn.ampproject.org/c/s/cloudblog.withgoogle.com/products/data-analytics/10-tips-for-building-long-running-clusters-using-cloud-dataproc/amp/\"}],\"httpStatus\":200},{\"url\":\"https://cloud.google.com/vpc/docs/configure-private-google-access\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://cloud.google.com/dataproc/docs/concepts/accessing/cluster-web-interfaces\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/single-node-clusters\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/init-actions\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://cloud.google.com/dataproc/docs/concepts/workflows/overview\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://cloud.google.com/dataproc/docs/reference/rest/v1/ClusterConfig\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://cloud.google.com/compute/docs/instances/connecting-advanced#vpn\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://cloud.google.com/compute/docs/instances/managing-instance-access\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://cloud.google.com/sdk/gcloud/reference/beta/dataproc/clusters/import\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://cloud.google.com/sdk/gcloud/reference/beta/dataproc/clusters/export\",\"alts\":[],\"httpStatus\":200}],\"version\":\"0.3\",\"generatedAt\":1554230804134},\"isLockedPreviewOnly\":false,\"takeoverId\":\"\",\"metaDescription\":\"\",\"totalClapCount\":13,\"sectionCount\":2,\"readingList\":0,\"topics\":[{\"topicId\":\"55f1c20aba7a\",\"slug\":\"software-engineering\",\"createdAt\":1491949272237,\"deletedAt\":0,\"image\":{\"id\":\"1*U8FboK4lz1wqwQC6IcqxKw@2x.jpeg\",\"originalWidth\":5507,\"originalHeight\":3098},\"name\":\"Software Engineering\",\"description\":\"Back-end to front-end.\",\"relatedTopics\":[],\"visibility\":1,\"relatedTags\":[],\"type\":\"Topic\"},{\"topicId\":\"decb52b64abf\",\"slug\":\"programming\",\"createdAt\":1493934116328,\"deletedAt\":0,\"image\":{\"id\":\"1*iPa136b1cGEO7lvoXg6uHQ@2x.jpeg\",\"originalWidth\":6016,\"originalHeight\":4016},\"name\":\"Programming\",\"description\":\"The good, the bad, the buggy.\",\"relatedTopics\":[],\"visibility\":1,\"relatedTags\":[],\"type\":\"Topic\"}]},\"coverless\":true,\"slug\":\"persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc\",\"translationSourcePostId\":\"\",\"translationSourceCreatorId\":\"\",\"isApprovedTranslation\":false,\"inResponseToPostId\":\"\",\"inResponseToRemovedAt\":0,\"isTitleSynthesized\":false,\"allowResponses\":true,\"importedUrl\":\"\",\"importedPublishedAt\":0,\"visibility\":2,\"uniqueSlug\":\"persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\",\"previewContent\":{\"bodyModel\":{\"paragraphs\":[{\"name\":\"previewImage\",\"type\":4,\"text\":\"\",\"layout\":10,\"metadata\":{\"id\":\"0*PatkVyBLe0rsHS69\",\"originalWidth\":797,\"originalHeight\":507,\"isFeatured\":true}},{\"name\":\"adf4\",\"type\":3,\"text\":\"Persisting Application History from Ephemeral Clusters on Google Cloud Dataproc\",\"markups\":[],\"alignment\":1}],\"sections\":[{\"startIndex\":0}]},\"isFullContent\":false,\"subtitle\":\"So you want to use ephemeral Dataproc Clusters, but don\u2019t want to lose your valuable YARN and Spark history once my cluster is torn down.\"},\"license\":0,\"inResponseToMediaResourceId\":\"\",\"canonicalUrl\":\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\",\"approvedHomeCollectionId\":\"e52cf94d98af\",\"approvedHomeCollection\":{\"id\":\"e52cf94d98af\",\"name\":\"Google Cloud Platform - Community\",\"slug\":\"google-cloud\",\"tags\":[\"GOOGLE CLOUD PLATFORM\",\"DEVELOPERS\",\"CLOUD COMPUTING\",\"DEVOPS\",\"MACHINE LEARNING\"],\"creatorId\":\"a535baed6389\",\"description\":\"A collection of technical articles published or curated by Google Cloud Platform Developer Advocates. The views expressed are those of the authors and don't necessarily reflect those of Google.\",\"shortDescription\":\"A collection of technical articles published or curated by\u2026\",\"image\":{\"imageId\":\"1*FUjLiCANvATKeaJEeg20Rw.png\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":192,\"originalHeight\":192,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"metadata\":{\"followerCount\":24562,\"activeAt\":1554230801924},\"virtuals\":{\"permissions\":{\"canPublish\":false,\"canPublishAll\":false,\"canRepublish\":false,\"canRemove\":false,\"canManageAll\":false,\"canSubmit\":false,\"canEditPosts\":false,\"canAddWriters\":false,\"canViewStats\":false,\"canSendNewsletter\":false,\"canViewLockedPosts\":false,\"canViewCloaked\":false,\"canEditOwnPosts\":false,\"canBeAssignedAuthor\":false,\"canEnrollInHightower\":false,\"canLockPostsForMediumMembers\":false,\"canLockOwnPostsForMediumMembers\":false},\"isSubscribed\":false,\"isNewsletterSubscribed\":false,\"memberOfMembershipPlanId\":\"\",\"isEnrolledInHightower\":false,\"isEligibleForHightower\":false},\"logo\":{\"imageId\":\"1*FUjLiCANvATKeaJEeg20Rw.png\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":192,\"originalHeight\":192,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"twitterUsername\":\"gcpcloud\",\"facebookPageName\":\"googlecloud\",\"collectionMastheadId\":\"536cf63fce6\",\"sections\":[{\"type\":2,\"collectionHeaderMetadata\":{\"title\":\"Google Cloud Platform\",\"description\":\"Curated articles for developers\",\"backgroundImage\":{},\"logoImage\":{\"id\":\"1*Wbm0PGaB2AuerxdZb0SDUw.png\",\"originalWidth\":1024,\"originalHeight\":1024,\"alt\":\"Google Cloud Platform - Community\"},\"alignment\":2,\"layout\":5}},{\"type\":1,\"postListMetadata\":{\"source\":3,\"layout\":4,\"number\":10,\"postIds\":[\"719c317bf2df\",\"c3483e88a352\",\"84170ea44833\",\"b167d0eb487a\",\"63872b56a58e\",\"4cffa22e3348\",\"be418274d36c\",\"4e7873811e86\",\"42bbb1308e76\",\"76442253a45a\"]}},{\"type\":1,\"postListMetadata\":{\"source\":2,\"layout\":4,\"number\":7,\"postIds\":[],\"sectionHeader\":\"Trending\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":5,\"number\":10,\"postIds\":[],\"sectionHeader\":\"Latest\"}}],\"favicon\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"colorPalette\":{\"defaultBackgroundSpectrum\":{\"colorPoints\":[{\"color\":\"#FF02B875\",\"point\":0},{\"color\":\"#FF00AB6B\",\"point\":0.1},{\"color\":\"#FF1C9963\",\"point\":0.2},{\"color\":\"#FF092E20\",\"point\":1}],\"backgroundColor\":\"#FFFFFFFF\"},\"highlightSpectrum\":{\"colorPoints\":[{\"color\":\"#FFFFFFFF\",\"point\":0},{\"color\":\"#FFE9FDF0\",\"point\":0.1},{\"color\":\"#FFE2FAEE\",\"point\":0.2},{\"color\":\"#FFADFFCF\",\"point\":0.6},{\"color\":\"#FF7DFFB3\",\"point\":1}],\"backgroundColor\":\"#FFFFFFFF\"}},\"navItems\":[{\"type\":4,\"title\":\"This Week in GCP\",\"url\":\"https://medium.com/google-cloud/weekly/home\",\"topicId\":\"af575ce9e5c7\",\"source\":\"topicId\"},{\"type\":1,\"title\":\"Containers\",\"tagSlug\":\"kubernetes\",\"url\":\"https://medium.com/google-cloud/tagged/kubernetes\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"Virtualization\",\"tagSlug\":\"google-compute-engine\",\"url\":\"https://medium.com/google-cloud/tagged/google-compute-engine\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"Platform as a Service\",\"tagSlug\":\"google-app-engine\",\"url\":\"https://medium.com/google-cloud/tagged/google-app-engine\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"Data\",\"tagSlug\":\"bigquery\",\"url\":\"https://medium.com/google-cloud/tagged/bigquery\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"Machine Learning\",\"tagSlug\":\"machine-learning\",\"url\":\"https://medium.com/google-cloud/tagged/machine-learning\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"IoT\",\"tagSlug\":\"iot\",\"url\":\"https://medium.com/google-cloud/tagged/iot\",\"source\":\"tagSlug\"},{\"type\":3,\"title\":\"More\",\"url\":\"https://cloud.google.com/blog/\"}],\"colorBehavior\":1,\"instantArticlesState\":0,\"acceleratedMobilePagesState\":0,\"ampLogo\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"header\":{\"title\":\"Google Cloud Platform\",\"description\":\"Curated articles for developers\",\"backgroundImage\":{},\"logoImage\":{\"id\":\"1*Wbm0PGaB2AuerxdZb0SDUw.png\",\"originalWidth\":1024,\"originalHeight\":1024,\"alt\":\"Google Cloud Platform - Community\"},\"alignment\":2,\"layout\":5},\"type\":\"Collection\"},\"newsletterId\":\"\",\"webCanonicalUrl\":\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\",\"mediumUrl\":\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\",\"migrationId\":\"\",\"notifyFollowers\":true,\"notifyTwitter\":false,\"notifyFacebook\":false,\"responseHiddenOnParentPostAt\":0,\"isSeries\":false,\"isSubscriptionLocked\":true,\"seriesLastAppendedAt\":0,\"audioVersionDurationSec\":0,\"sequenceId\":\"\",\"isNsfw\":false,\"isEligibleForRevenue\":true,\"isBlockedFromHightower\":false,\"deletedAt\":0,\"lockedPostSource\":1,\"hightowerMinimumGuaranteeStartsAt\":0,\"hightowerMinimumGuaranteeEndsAt\":0,\"featureLockRequestAcceptedAt\":0,\"mongerRequestType\":1,\"layerCake\":3,\"socialTitle\":\"\",\"socialDek\":\"\",\"editorialPreviewTitle\":\"\",\"editorialPreviewDek\":\"\",\"curationEligibleAt\":1554229043220,\"primaryTopic\":{\"topicId\":\"55f1c20aba7a\",\"slug\":\"software-engineering\",\"createdAt\":1491949272237,\"deletedAt\":0,\"image\":{\"id\":\"1*U8FboK4lz1wqwQC6IcqxKw@2x.jpeg\",\"originalWidth\":5507,\"originalHeight\":3098},\"name\":\"Software Engineering\",\"description\":\"Back-end to front-end.\",\"relatedTopics\":[],\"visibility\":1,\"relatedTags\":[],\"type\":\"Topic\"},\"type\":\"Post\"},\"mentionedUsers\":[],\"collaborators\":[{\"user\":{\"userId\":\"c183f06998a1\",\"name\":\"Daniel De Leo\",\"username\":\"danielrdeleo\",\"createdAt\":1524509692696,\"imageId\":\"1*MfvMWH0vdVXU9je34THC0w.png\",\"backgroundImageId\":\"\",\"bio\":\"Googler, Cloud Mechanic\",\"twitterScreenName\":\"\",\"facebookAccountId\":\"\",\"allowNotes\":1,\"mediumMemberAt\":0,\"isNsfw\":false,\"isWriterProgramEnrolled\":true,\"isQuarantined\":false,\"type\":\"User\"},\"state\":\"visible\"}],\"collectionUserRelations\":[],\"mode\":null,\"references\":{\"User\":{\"3b0d197b82f8\":{\"userId\":\"3b0d197b82f8\",\"name\":\"Jacob Ferriero\",\"username\":\"jtferriero\",\"createdAt\":1503925606898,\"imageId\":\"1*HV-Gei_diNhBWCBKaMSesw.jpeg\",\"backgroundImageId\":\"\",\"bio\":\"Data Engineer @Google\",\"twitterScreenName\":\"\",\"socialStats\":{\"userId\":\"3b0d197b82f8\",\"usersFollowedCount\":7,\"usersFollowedByCount\":49,\"type\":\"SocialStats\"},\"social\":{\"userId\":\"lo_IHx7XZw0T0sc\",\"targetUserId\":\"3b0d197b82f8\",\"type\":\"Social\"},\"facebookAccountId\":\"\",\"allowNotes\":1,\"mediumMemberAt\":1539124629000,\"isNsfw\":false,\"isWriterProgramEnrolled\":true,\"isQuarantined\":false,\"type\":\"User\"}},\"Collection\":{\"e52cf94d98af\":{\"id\":\"e52cf94d98af\",\"name\":\"Google Cloud Platform - Community\",\"slug\":\"google-cloud\",\"tags\":[\"GOOGLE CLOUD PLATFORM\",\"DEVELOPERS\",\"CLOUD COMPUTING\",\"DEVOPS\",\"MACHINE LEARNING\"],\"creatorId\":\"a535baed6389\",\"description\":\"A collection of technical articles published or curated by Google Cloud Platform Developer Advocates. The views expressed are those of the authors and don't necessarily reflect those of Google.\",\"shortDescription\":\"A collection of technical articles published or curated by\u2026\",\"image\":{\"imageId\":\"1*FUjLiCANvATKeaJEeg20Rw.png\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":192,\"originalHeight\":192,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"metadata\":{\"followerCount\":24562,\"activeAt\":1554230801924},\"virtuals\":{\"permissions\":{\"canPublish\":false,\"canPublishAll\":false,\"canRepublish\":false,\"canRemove\":false,\"canManageAll\":false,\"canSubmit\":false,\"canEditPosts\":false,\"canAddWriters\":false,\"canViewStats\":false,\"canSendNewsletter\":false,\"canViewLockedPosts\":false,\"canViewCloaked\":false,\"canEditOwnPosts\":false,\"canBeAssignedAuthor\":false,\"canEnrollInHightower\":false,\"canLockPostsForMediumMembers\":false,\"canLockOwnPostsForMediumMembers\":false},\"isSubscribed\":false,\"isNewsletterSubscribed\":false,\"memberOfMembershipPlanId\":\"\",\"isEnrolledInHightower\":false,\"isEligibleForHightower\":false},\"logo\":{\"imageId\":\"1*FUjLiCANvATKeaJEeg20Rw.png\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":192,\"originalHeight\":192,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"twitterUsername\":\"gcpcloud\",\"facebookPageName\":\"googlecloud\",\"collectionMastheadId\":\"536cf63fce6\",\"sections\":[{\"type\":2,\"collectionHeaderMetadata\":{\"title\":\"Google Cloud Platform\",\"description\":\"Curated articles for developers\",\"backgroundImage\":{},\"logoImage\":{\"id\":\"1*Wbm0PGaB2AuerxdZb0SDUw.png\",\"originalWidth\":1024,\"originalHeight\":1024,\"alt\":\"Google Cloud Platform - Community\"},\"alignment\":2,\"layout\":5}},{\"type\":1,\"postListMetadata\":{\"source\":3,\"layout\":4,\"number\":10,\"postIds\":[\"719c317bf2df\",\"c3483e88a352\",\"84170ea44833\",\"b167d0eb487a\",\"63872b56a58e\",\"4cffa22e3348\",\"be418274d36c\",\"4e7873811e86\",\"42bbb1308e76\",\"76442253a45a\"]}},{\"type\":1,\"postListMetadata\":{\"source\":2,\"layout\":4,\"number\":7,\"postIds\":[],\"sectionHeader\":\"Trending\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":5,\"number\":10,\"postIds\":[],\"sectionHeader\":\"Latest\"}}],\"favicon\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"colorPalette\":{\"defaultBackgroundSpectrum\":{\"colorPoints\":[{\"color\":\"#FF02B875\",\"point\":0},{\"color\":\"#FF00AB6B\",\"point\":0.1},{\"color\":\"#FF1C9963\",\"point\":0.2},{\"color\":\"#FF092E20\",\"point\":1}],\"backgroundColor\":\"#FFFFFFFF\"},\"highlightSpectrum\":{\"colorPoints\":[{\"color\":\"#FFFFFFFF\",\"point\":0},{\"color\":\"#FFE9FDF0\",\"point\":0.1},{\"color\":\"#FFE2FAEE\",\"point\":0.2},{\"color\":\"#FFADFFCF\",\"point\":0.6},{\"color\":\"#FF7DFFB3\",\"point\":1}],\"backgroundColor\":\"#FFFFFFFF\"}},\"navItems\":[{\"type\":4,\"title\":\"This Week in GCP\",\"url\":\"https://medium.com/google-cloud/weekly/home\",\"topicId\":\"af575ce9e5c7\",\"source\":\"topicId\"},{\"type\":1,\"title\":\"Containers\",\"tagSlug\":\"kubernetes\",\"url\":\"https://medium.com/google-cloud/tagged/kubernetes\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"Virtualization\",\"tagSlug\":\"google-compute-engine\",\"url\":\"https://medium.com/google-cloud/tagged/google-compute-engine\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"Platform as a Service\",\"tagSlug\":\"google-app-engine\",\"url\":\"https://medium.com/google-cloud/tagged/google-app-engine\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"Data\",\"tagSlug\":\"bigquery\",\"url\":\"https://medium.com/google-cloud/tagged/bigquery\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"Machine Learning\",\"tagSlug\":\"machine-learning\",\"url\":\"https://medium.com/google-cloud/tagged/machine-learning\",\"source\":\"tagSlug\"},{\"type\":1,\"title\":\"IoT\",\"tagSlug\":\"iot\",\"url\":\"https://medium.com/google-cloud/tagged/iot\",\"source\":\"tagSlug\"},{\"type\":3,\"title\":\"More\",\"url\":\"https://cloud.google.com/blog/\"}],\"colorBehavior\":1,\"instantArticlesState\":0,\"acceleratedMobilePagesState\":0,\"ampLogo\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"header\":{\"title\":\"Google Cloud Platform\",\"description\":\"Curated articles for developers\",\"backgroundImage\":{},\"logoImage\":{\"id\":\"1*Wbm0PGaB2AuerxdZb0SDUw.png\",\"originalWidth\":1024,\"originalHeight\":1024,\"alt\":\"Google Cloud Platform - Community\"},\"alignment\":2,\"layout\":5},\"type\":\"Collection\"}},\"Social\":{\"3b0d197b82f8\":{\"userId\":\"lo_IHx7XZw0T0sc\",\"targetUserId\":\"3b0d197b82f8\",\"type\":\"Social\"}},\"SocialStats\":{\"3b0d197b82f8\":{\"userId\":\"3b0d197b82f8\",\"usersFollowedCount\":7,\"usersFollowedByCount\":49,\"type\":\"SocialStats\"}}}})\n// ]]></script><script id=\"parsely-cfg\" src=\"//d1z2jf7jlzjs58.cloudfront.net/keys/medium.com/p.js\"></script><script type=\"text/javascript\">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src=\"https://cdn.branch.io/branch-latest.min.js\";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,\"script\",\"branch\",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},\"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent\".split(\" \"), 0); branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled':  false }, function(err, data) {});</script></body></html>", "title": "Persisting Application History from Ephemeral Clusters on Google Cloud\u00a0Dataproc", "title_html": "<h1 class=\"graf graf--h3 graf--leading graf--title\" id=\"adf4\" name=\"adf4\">Persisting Application History from Ephemeral Clusters on Google Cloud\u00a0Dataproc</h1>", "content_html": "<div class=\"section-content\"><div class=\"section-inner sectionLayout--insetColumn\"><h1 class=\"graf graf--h3 graf--leading graf--title\" id=\"adf4\" name=\"adf4\">Persisting Application History from Ephemeral Clusters on Google Cloud\u00a0Dataproc</h1><div class=\"uiScale uiScale-ui--regular uiScale-caption--regular u-flexCenter u-marginVertical24 u-fontSize15 js-postMetaLockup\"><div class=\"u-flex0\"><a class=\"link u-baseColor--link avatar\" data-action=\"show-user-card\" data-action-source=\"post_header_lockup\" data-action-type=\"hover\" data-action-value=\"3b0d197b82f8\" data-user-id=\"3b0d197b82f8\" dir=\"auto\" href=\"https://medium.com/@jtferriero?source=post_header_lockup\"><div class=\"u-relative u-inlineBlock u-flex0\"><img alt=\"Go to the profile of Jacob Ferriero\" class=\"avatar-image u-size50x50\" src=\"https://cdn-images-1.medium.com/fit/c/100/100/1*HV-Gei_diNhBWCBKaMSesw.jpeg\"/><div class=\"avatar-halo u-absolute u-textColorGreenNormal svgIcon\" style=\"width: calc(100% + 10px); height: calc(100% + 10px); top:-5px; left:-5px\"><svg viewbox=\"0 0 70 70\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M5.53538374,19.9430227 C11.180401,8.78497536 22.6271155,1.6 35.3571429,1.6 C48.0871702,1.6 59.5338847,8.78497536 65.178902,19.9430227 L66.2496695,19.401306 C60.4023065,7.84329843 48.5440457,0.4 35.3571429,0.4 C22.17024,0.4 10.3119792,7.84329843 4.46461626,19.401306 L5.53538374,19.9430227 Z\"></path><path d=\"M65.178902,49.9077131 C59.5338847,61.0657604 48.0871702,68.2507358 35.3571429,68.2507358 C22.6271155,68.2507358 11.180401,61.0657604 5.53538374,49.9077131 L4.46461626,50.4494298 C10.3119792,62.0074373 22.17024,69.4507358 35.3571429,69.4507358 C48.5440457,69.4507358 60.4023065,62.0074373 66.2496695,50.4494298 L65.178902,49.9077131 Z\"></path></svg></div></div></a></div><div class=\"u-flex1 u-paddingLeft15 u-overflowHidden\"><div class=\"u-paddingBottom3\"><a class=\"ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker\" data-action=\"show-user-card\" data-action-type=\"hover\" data-action-value=\"3b0d197b82f8\" data-user-id=\"3b0d197b82f8\" dir=\"auto\" href=\"https://medium.com/@jtferriero\">Jacob Ferriero</a><span class=\"followState js-followState\" data-user-id=\"3b0d197b82f8\"><button class=\"button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide\" data-action=\"sign-up-prompt\" data-action-source=\"post_header_lockup\" data-redirect=\"https://medium.com/google-cloud/persisting-application-history-from-ephemeral-clusters-on-google-cloud-dataproc-7b1b03a49686\" data-requires-token=\"true\" data-sign-in-action=\"toggle-block-user\"><span class=\"button-label button-defaultState\">Blocked</span><span class=\"button-label button-hoverState\">Unblock</span></button><button class=\"button button--primary button--smallest button--dark u-noUserSelect button--withChrome u-accentColor--buttonDark button--follow js-followButton u-marginLeft10 u-xs-hide\" data-action=\"sign-up-prompt\" data-action-source=\"post_header_lockup-3b0d197b82f8-------------------------follow_byline\" data-redirect=\"https://medium.com/_/subscribe/user/3b0d197b82f8\" data-requires-token=\"true\" data-sign-in-action=\"toggle-subscribe-user\"><span class=\"button-label button-defaultState js-buttonLabel\">Follow</span><span class=\"button-label button-activeState\">Following</span></button></span></div><div class=\"ui-caption u-noWrapWithEllipsis js-testPostMetaInlineSupplemental\"><time datetime=\"2019-04-02T18:17:23.832Z\">Apr 2</time><span class=\"middotDivider u-fontSize12\"></span><span class=\"readingTime\" title=\"9 min read\"></span><span class=\"u-paddingLeft4\"><span class=\"svgIcon svgIcon--star svgIcon--15px\"><svg class=\"svgIcon-use\" height=\"15\" width=\"15\"><path d=\"M7.438 2.324c.034-.099.09-.099.123 0l1.2 3.53a.29.29 0 0 0 .26.19h3.884c.11 0 .127.049.038.111L9.8 8.327a.271.271 0 0 0-.099.291l1.2 3.53c.034.1-.011.131-.098.069l-3.142-2.18a.303.303 0 0 0-.32 0l-3.145 2.182c-.087.06-.132.03-.099-.068l1.2-3.53a.271.271 0 0 0-.098-.292L2.056 6.146c-.087-.06-.071-.112.038-.112h3.884a.29.29 0 0 0 .26-.19l1.2-3.52z\"></path></svg></span></span></div></div></div><p class=\"graf graf--p graf-after--h3\" id=\"986f\" name=\"986f\">So you want to use ephemeral Dataproc Clusters, but don\u2019t want to lose your valuable YARN and Spark history once your cluster is torn down.</p><p class=\"graf graf--p graf-after--p graf--trailing\" id=\"d8dc\" name=\"d8dc\">Enter the <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/single-node-clusters\" href=\"https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/single-node-clusters\" rel=\"nofollow noopener\" target=\"_blank\">single node Dataproc cluster</a>. It will serve as your persistent history server for MapReduce and Spark job history as well as a window into aggregated YARN logs.</p></div></div>"}