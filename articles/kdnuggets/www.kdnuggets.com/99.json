{"content_html": "<div class=\"post\" id=\"post-\">\n<div class=\"author-link\"><b>By <a href=\"https://www.kdnuggets.com/author/derrick-mwiti\" rel=\"author\" title=\"Posts by Derrick Mwiti\">Derrick Mwiti</a>, Data Analyst.</b></div>\n<div align=\"right\"><img alt=\"c\" height=\"12\" src=\"/images/comment.gif\" width=\"16\"/> <a href=\"#comments\">comments</a></div>\n<p>Sales forecasting is one the most common tasks in many sales driven organizations. This activity enables organizations to adequately plan for the future with a degree of confidence. In this tutorial we\u2019ll use\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fresearch.fb.com%2Fprophet-forecasting-at-scale%2F\" rel=\"noopener noreferrer\" target=\"_blank\">Prophet</a>, a package developed by\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fresearch.fb.com%2Fprophet-forecasting-at-scale%2F\" rel=\"noopener noreferrer\" target=\"_blank\">Facebook</a>\u00a0to show how one can achieve this. This package is available in both\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fpypi.org%2Fproject%2Ffbprophet%2F\" rel=\"noopener noreferrer\" target=\"_blank\">Python</a>\u00a0and\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fcran.r-project.org%2Fpackage%3Dprophet\" rel=\"noopener noreferrer\" target=\"_blank\">R</a>. We assume that the reader has basic understanding of handling\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-time-series-data-in-pandas-be3887fdd621\" rel=\"noopener noreferrer\" target=\"_blank\">time series\u00a0</a>data in Python.</p>\n<p>\u00a0</p>\n<h3>Plan of\u00a0Attack</h3>\n<p>\u00a0</p>\n<ol>\n<li>Introduction and Installation\n<li>Model Fitting\n<li>Making Future Predictions\n<li>Obtaining the Forecasts\n<li>Plotting the Forecasts\n<li>Plotting the Forecast Components\n<li>Cross Validation\n<li>Obtaining the Performance Metrics\n<li>Visualizing Performance Metrics\n<li>Conclusion\n</li></li></li></li></li></li></li></li></li></li></ol>\n<p>\u00a0</p>\n<h3>Introduction and Installation</h3>\n<p>\u00a0<br>\nThere are very many open source forecastings tools, however none of these would be fit to solve all forecasting problems.\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fgithub.com%2Ffacebook%2Fprophet\" rel=\"noopener noreferrer\" target=\"_blank\">Prophet</a>\u00a0works best with hourly, and weekly data that is several months. When working with Prophet yearly data is most prefered. According to Facebook Research:</br></p>\n<blockquote><p>At its core, the Prophet procedure is an\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FAdditive_model\" rel=\"noopener noreferrer\" target=\"_blank\">additive regression model</a>\u00a0with four main components:</p>\n<p>1. A piecewise linear or logistic growth curve trend. Prophet automatically detects changes in trends by selecting changepoints from the data.<br>\n2. A yearly seasonal component modeled using\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FFourier_series\" rel=\"noopener noreferrer\" target=\"_blank\">Fourier series.</a><br>\n3. A weekly seasonal component using dummy variables.<br>\n4. A user-provided list of important holidays.</br></br></br></p></blockquote>\n<p>Prophet can be installed using pip in Python as shown below. Prophet depends on a Python module called\u00a0<code>pystan.</code>\u00a0This module will be installed automatically as we install Prophet.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/1573b98b13b7c99f60eb8e31b44810ef.js\"></script></p>\n<p>The dataset we\u2019ve used for this tutorial is available\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fdatamarket.com%2Fdata%2Fset%2F235d%2Fmean-daily-temperature-fisher-river-near-dallas-jan-01-1988-to-dec-31-1991%23!ds%3D235d%26display%3Dline\" rel=\"noopener noreferrer\" target=\"_blank\">here</a>. Once you download the dataset make sure to delete some unnecessary rows towards the end of the file because they might interfere with the analysis. For this\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FUnivariate\" rel=\"noopener noreferrer\" target=\"_blank\">univariate analysis</a>Prophet expects the dataset to have two columns named as\u00a0<em>ds</em>\u00a0and\u00a0<em>y</em>.\u00a0<em>ds</em>\u00a0is the date column while\u00a0<em>y</em>\u00a0is the column that we are forecasting.</p>\n<p>Let\u2019s get the ball rolling by importing Pandas for data manipulation and Prophet for forecasting. Next we load in our dataset and check its head.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/be31519504e3149b0fe7941129fd33d9.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*zd662AMnxKxPKEptfxedfw.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3>Model Fitting</h3>\n<p>\u00a0<br/>\nSince we\u2019ve worked with\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fscikit-learn.org%2F\" rel=\"noopener noreferrer\" target=\"_blank\">Scikit-learn</a>\u00a0before,working with Prophet will be a walk in the park for us. This is because the API implementation for Prophet and Scikit-learn are very similar as we\u2019ll see below. We start by creating an instance of the Prophet class and then fit it to our dataset.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/9ca8ceafae1581f3bfceae4265f98d1c.js\"></script></p>\n<p>\u00a0</p>\n<h3>Making Future Predictions</h3>\n<p>\u00a0<br/>\nThe next step is to prepare our model to make future predictions. This is achieved using the\u00a0<em>Prophet.make_future_dataframe\u00a0</em>method and passing the number of days we\u2019d like to predict in the future. We use the\u00a0<em>periods</em>\u00a0attribute to specify this. This also include the historical dates. We\u2019ll use these historical dates to compare the predictions with the actual values in the\u00a0<em>ds</em>\u00a0column.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/2cf6a29d0cd3fd967ef5e6e389d608e6.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*ajOKg6cMUUTiX86bXJHOfg.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3>Obtaining the Forecasts</h3>\n<p>\u00a0<br/>\nWe use the\u00a0<em>predict</em>\u00a0method to make future predictions. This will generate a dataframe with a\u00a0<em>yhat\u00a0</em>column that will contain the predictions.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/7b5353ee86ad93611620aa7cc2257817.js\"></script></p>\n<p>If we check the\u00a0<em>head</em>\u00a0for our forecast dataframe we\u2019ll notice that it has very many columns. However, we are mainly interested in\u00a0<strong><em>ds, yhat, yhat_lower\u00a0</em></strong>and<strong>\u00a0<em>yhat_upper. yhat\u00a0</em></strong>is our predicted forecast,\u00a0<strong><em>yhat_lower\u00a0</em></strong>is the lower bound for our predictions and\u00a0<strong><em>yhat_upper</em></strong>\u00a0is the upper bound for our predictions.</p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*WwdiMjOnZFmo2F4daQNclA.png\" width=\"99%\"/></p>\n<p>Let\u2019s proceed to check the tail and head of the forecast\u2019s dataframe.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/98405db5b0f266437bb5be0e4f5262cc.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*P9cUvHGwQT9LrqHV8zeP4Q.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3>Plotting the Forecasts</h3>\n<p>\u00a0<br/>\nProphet has an inbuilt feature that enables us to plot the forecasts we just generated. This is achieved using\u00a0<em>mode.plot()\u00a0</em>and passing in our forecasts as the argument. The blue line in the graph represents the predicted values while the black dots represents the data in our dataset.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/50a6682ab1e791e26030ef855fece645.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*6Kgkov_NzDrjIJOwisdDjQ.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3>Plotting the Forecast Components</h3>\n<p>\u00a0<br/>\nThe\u00a0<em>plot_components\u00a0</em>method plots the trend, yearly and weekly seasonality of the time series data.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/bce5e7006aa34481ac6c195600f300f0.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*57-ajfWL9-xkusMGNtWEeA.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3>Cross Validation</h3>\n<p>\u00a0<br/>\nNext let\u2019s measure the forecast error using the historical data. We\u2019ll do this by comparing the predicted values with the actual values. In order to perform this operation we select cut of points in the history of the data and fit the model with data upto that cut off point. Afterwards we compare the actual values to the predicted values. The\u00a0<em>cross_validation\u00a0</em>method allows us to do this in Prophet. This method take the following parameters as explained below:</p>\n<ol>\n<li><em>horizon\u00a0</em>the forecast horizon\n<li><em>initial\u00a0</em>the size of the initial training period\n<li><em>period\u00a0</em>the spacing between cutoff dates\n</li></li></li></ol>\n<p>The output of the\u00a0<em>cross_validation\u00a0</em>method is a dataframe containing\u00a0<em>y</em>\u00a0the true values and\u00a0<em>yhat</em>\u00a0the predicted values. We\u2019ll use this dataframe to compute the prediction errors.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/601f7cfea81203ff18cd27adca3f270f.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*7TO_HCAMYSegF7d5vSN2Bg.png\" width=\"50%\"/></p>\n<p>\u00a0</p>\n<h3>Obtaining the Performance Metrics</h3>\n<p>\u00a0<br/>\nWe use the\u00a0<em>performance_metrics</em>\u00a0utility to compute the Mean Squared Error(MSE), Root Mean Squared Error(RMSE),Mean Absolute Error(MAE), Mean Absolute Percentage Error(MAPE) and the coverage of the the\u00a0<code>yhat_lower</code>\u00a0and\u00a0<code>yhat_upper</code>\u00a0estimates.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/1c788520488eb3e7b9bfe07ba5f60398.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*kN-ye83y6bsSV8uIW3bt8A.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3><strong>Visualizing Performance Metrics</strong></h3>\n<p>\u00a0<br/>\nThe performance Metrics can be visualized using the\u00a0<em>plot_cross_validation_metric</em>\u00a0utility. Let\u2019s visualize the RMSE below.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/cb636d7d0e54921a807aff60650cdd7c.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*KQhliE9dH9IoCGGtDOjoZQ.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3>Conclusion</h3>\n<p>\u00a0<br/>\nAs we have seen Prophet is very powerful and effective in time series forecasting. However, as we mentioned earlier there are a few other forecasting tools. Choice of tool is on a case by case basis depending on the nature of the dataset. One can always compare these tools and use the one that gives the best predictions with the least amount of errors. Some of these methods include\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fwww.statsmodels.org%2Fdev%2Fgenerated%2Fstatsmodels.tsa.arima_model.ARIMA.html\" rel=\"noopener noreferrer\" target=\"_blank\">ARIMA</a>,\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fotexts.org%2Ffpp2%2Fholt-winters.html\" rel=\"noopener noreferrer\" target=\"_blank\">Holt-Winters\u2019 Method</a>,\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fotexts.org%2Ffpp2%2Fholt.html\" rel=\"noopener noreferrer\" target=\"_blank\">Holt\u2019s linear trend</a>,<a href=\"https://medium.com/r/?url=https%3A%2F%2Fotexts.org%2Ffpp2%2Fses.html\" rel=\"noopener noreferrer\" target=\"_blank\">\u00a0Simple exponential smoothing</a>\u00a0and\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fwww.babypips.com%2Flearn%2Fforex%2Fusing-moving-averages\" rel=\"noopener noreferrer\" target=\"_blank\">Moving Averages</a>\u00a0among others. You can learn more about Prophet from the\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Ffacebook.github.io%2Fprophet%2F\" rel=\"noopener noreferrer\" target=\"_blank\">official docs</a>\u00a0or by reading\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fpeerj.com%2Fpreprints%2F3190.pdf\" rel=\"noopener noreferrer\" target=\"_blank\">Prophet\u2019s Paper</a>.</p>\n<p>\u00a0<br/>\n<b>Bio: <a href=\"https://derrickmwiti.com/\" rel=\"noopener noreferrer\" target=\"_blank\">Derrick Mwiti</a></b> is a data analyst, a writer, and a mentor. He is driven by delivering great results in every task, and is a mentor at Lapid Leaders Africa.</p>\n<p><b>Related:</b></p>\n<ul class=\"three_ul\">\n<li><a href=\"/2018/11/keras-long-short-term-memory-lstm-model-predict-stock-prices.html\">Using a Keras Long Short-Term Memory (LSTM) Model to Predict Stock Prices</a>\n<li><a href=\"/2018/10/introduction-deep-learning-keras.html\">Introduction to Deep Learning with Keras</a>\n<li><a href=\"/2018/11/introduction-pytorch-deep-learning.html\">Introduction to PyTorch for Deep Learning</a>\n</li></li></li></ul>\n<p><a name=\"comments\"></a></p>\n<div id=\"disqus_thread\"></div>\n<p> <script type=\"text/javascript\">\n var disqus_shortname = 'kdnuggets';\n (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = 'https://kdnuggets.disqus.com/embed.js';\n (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })();\n </script></p>\n</div> ", "url": "https://www.kdnuggets.com/2018/11/sales-forecasting-using-prophet.html", "html": "<!DOCTYPE html>\n\n<html lang=\"en-US\" xmlns=\"http://www.w3.org/1999/xhtml\">\n<head profile=\"http://gmpg.org/xfn/11\">\n<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/>\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\"/>\n<title>  Sales Forecasting Using Facebook\u2019s Prophet</title>\n<link href=\"/wp-content/themes/kdn17/images/favicon.ico\" rel=\"shortcut icon\"/>\n<link href=\"/wp-content/themes/kdn17/style.css\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\"/>\n<script src=\"/wp-content/themes/kdn17/js/jquery-1.9.1.min.js\" type=\"text/javascript\"></script>\n<script src=\"/aps/kda_all.js\" type=\"text/javascript\"></script>\n<link href=\"/feed/\" rel=\"alternate\" title=\"KDnuggets: Analytics, Big Data, Data Mining and Data Science Feed\" type=\"application/rss+xml\"/>\n<link href=\"//s.w.org\" rel=\"dns-prefetch\"/>\n<link href=\"https://www.kdnuggets.com/feed\" rel=\"alternate\" title=\"KDnuggets \u00bb Feed\" type=\"application/rss+xml\"/>\n<link href=\"https://www.kdnuggets.com/comments/feed\" rel=\"alternate\" title=\"KDnuggets \u00bb Comments Feed\" type=\"application/rss+xml\"/>\n<link href=\"https://www.kdnuggets.com/2018/11/sales-forecasting-using-prophet.html/feed\" rel=\"alternate\" title=\"KDnuggets \u00bb Sales Forecasting Using Facebook\u2019s Prophet Comments Feed\" type=\"application/rss+xml\"/>\n<link href=\"https://www.kdnuggets.com/wp-json/\" rel=\"https://api.w.org/\"/>\n<link href=\"https://www.kdnuggets.com/xmlrpc.php?rsd\" rel=\"EditURI\" title=\"RSD\" type=\"application/rsd+xml\"/>\n<link href=\"https://www.kdnuggets.com/wp-includes/wlwmanifest.xml\" rel=\"wlwmanifest\" type=\"application/wlwmanifest+xml\"/>\n<link href=\"https://www.kdnuggets.com/2018/11/deep-learning-cheat-sheets.html\" rel=\"prev\" title=\"Deep Learning Cheat Sheets\"/>\n<link href=\"https://www.kdnuggets.com/2018/11/machine-learning-team-when-not-google-facebook.html\" rel=\"next\" title=\"How to Build a Machine Learning Team When You Are Not Google or Facebook\"/>\n<meta content=\"WordPress 4.9.10\" name=\"generator\">\n<link href=\"https://www.kdnuggets.com/2018/11/sales-forecasting-using-prophet.html\" rel=\"canonical\"/>\n<link href=\"https://www.kdnuggets.com/?p=87744\" rel=\"shortlink\"/>\n<link href=\"https://www.kdnuggets.com/2018/11/sales-forecasting-using-prophet.html\" rel=\"canonical\"/>\n<!-- BEGIN ExactMetrics v5.3.7 Universal Analytics - https://exactmetrics.com/ -->\n<script>\n(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n\t(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n\tm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');\n  ga('create', 'UA-361129-1', 'auto');\n  ga('send', 'pageview');\n</script>\n<!-- END ExactMetrics Universal Analytics -->\n</meta></head>\n<body class=\"post-template-default single single-post postid-87744 single-format-standard\">\n<div class=\"main_wrapper\"><!-- publ: 28-Nov, 2018  -->\n<div id=\"wrapper\">\n<div id=\"header\">\n<div id=\"header_log\">\n<div class=\"logo\">\n<a href=\"/\"></a>\n</div>\n<h1>KDnuggets</h1>\n<div class=\"text-container\">\n            \u00a0\u00a0<a href=\"/news/subscribe.html\" target=\"_blank\"><b>Subscribe to KDnuggets News</b></a> \u00a0|\n <a href=\"https://twitter.com/kdnuggets\" target=\"_blank\"><img alt=\"Twitter\" height=\"48\" src=\"/images/tw_c48.png\" style=\"vertical-align: bottom\" width=\"48\"/></a> \u00a0\u00a0\n <a href=\"https://www.facebook.com/kdnuggets\" target=\"_blank\"><img alt=\"Facebook\" height=\"48\" src=\"/images/fb_c48.png\" style=\"vertical-align: bottom\" width=\"48\"/></a> \u00a0\u00a0\n<a href=\"https://www.linkedin.com/groups/54257/\" target=\"_blank\"><img alt=\"LinkedIn\" height=\"48\" src=\"/images/in_c48.png\" style=\"vertical-align: bottom\" width=\"48\"/></a> \n\u00a0|\u00a0 <a href=\"/contact.html\"><b>Contact</b></a>\n</div>\n</div>\n<div class=\"search\">\n<form action=\"/\" id=\"searchform\" method=\"get\">\n<input id=\"s\" name=\"s\" placeholder=\"search KDnuggets\" type=\"text\" value=\"\"/>\n<input type=\"submit\" value=\"Search\"/></form>\n</div>\n<div href=\"#\" id=\"pull\">\n<img class=\"menu\" src=\"/images/menu-30.png\">\n<div class=\"logo\">\n<a href=\"/\"></a>\n</div>\n<img class=\"search-icon\" src=\"/images/search-icon.png\">\n</img></img></div>\n<div id=\"pull-menu\">\n<div class=\"navigation\"><ul class=\"menu\" id=\"menu-menu\"><li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-1070\" id=\"menu-item-1070\"><a href=\"/software/index.html\" title=\"Data Science Software\">SOFTWARE</a></li>\n<li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-13756\" id=\"menu-item-13756\"><a href=\"/news/index.html\" title=\"News\">News/Blog</a></li>\n<li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-46286\" id=\"menu-item-46286\"><a href=\"/news/top-stories.html\">Top stories</a></li>\n<li class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-42152\" id=\"menu-item-42152\"><a href=\"https://www.kdnuggets.com/opinions/index.html\" title=\"Opinions\">Opinions</a></li>\n<li class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-46415\" id=\"menu-item-46415\"><a href=\"https://www.kdnuggets.com/tutorials/index.html\">Tutorials</a></li>\n<li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-13364\" id=\"menu-item-13364\"><a href=\"/jobs/index.html\" title=\"Jobs in Analytics, Data Science\">JOBS</a></li>\n<li class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-63505\" id=\"menu-item-63505\"><a href=\"https://www.kdnuggets.com/companies/index.html\">Companies</a></li>\n<li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-13366\" id=\"menu-item-13366\"><a href=\"/courses/index.html\">Courses</a></li>\n<li class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-1499\" id=\"menu-item-1499\"><a href=\"https://www.kdnuggets.com/datasets/index.html\">Datasets</a></li>\n<li class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-14286\" id=\"menu-item-14286\"><a href=\"https://www.kdnuggets.com/education/index.html\" title=\"Education in Analytics, Big Data, Data Science\">EDUCATION</a></li>\n<li class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-51558\" id=\"menu-item-51558\"><a href=\"https://www.kdnuggets.com/education/analytics-data-mining-certificates.html\" title=\"Certificates in Analytics, Big Data, Data Science\">Certificates</a></li>\n<li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-14752\" id=\"menu-item-14752\"><a href=\"/meetings/index.html\">Meetings</a></li>\n<li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-13721\" id=\"menu-item-13721\"><a href=\"/webcasts/index.html\" title=\"Webcasts and Webinars\">Webinars</a></li>\n</ul></div></div>\n</div> <!--#header end-->\n<div id=\"spacer\">\n         \u00a0\n      </div>\n<div id=\"content_wrapper\">\n<div id=\"ad_wrapper\">\n<script type=\"text/javascript\">\n\tjQuery(function() {\n   \t    var pull        = $('#pull');\n            menu        = $('#header .navigation ul');\n            menuImage = $('#header img.menu');\n            mobileMenu        = $('#pull-menu-mobile');\n            search = $('img.search-icon');\n            searchBar = $('div.search');\n            searchClick = false;\n            search.on('click', function() {\n                  searchBar.slideToggle();\n                  searchClick = true;\n            });  \n     \t    $(menuImage).on('click', function(e) {\n\t        //e.preventDefault();\n                if (!searchClick) {\n                  menu.slideToggle();\n                }\n                searchClick = false;\n\t    });\n           /* pullMobile.on('click', function(e) {\n              e.preventDefault();\n                if (!searchClick) {\n                  mobileMenu.slideToggle();\n                }\n                searchClick = false;\n\t    });*/\n            \n\t});\n\tkpath = '/'; kda_top(); kda_sid_init(); kda_sid_n=3;\n\t</script>\n</div> <div class=\"breadcumb\">\n<br/>\n<a href=\"/\">KDnuggets Home</a> \u00bb <a href=\"/news/index.html\">News</a> \u00bb <a href=\"/2018/index.html\">2018</a> \u00bb <a href=\"https://www.kdnuggets.com/2018/11/index.html\">Nov</a> \u00bb <a href=\"https://www.kdnuggets.com/2018/11/tutorials.html\">Tutorials, Overviews</a> \u00bb Sales Forecasting Using Facebook\u2019s Prophet (\u00a0<a href=\"/2018/n46.html\">18:n46</a>\u00a0)    </div>\n<div class=\"single\" id=\"content\">\n<div id=\"post-header\">\n<h1 id=\"title\">Sales Forecasting Using Facebook\u2019s Prophet</h1>\n<div class=\"pagi\">\n<div class=\"pagi-left\">\n<a href=\"https://www.kdnuggets.com/2018/11/deep-learning-cheat-sheets.html\" rel=\"prev\"><img height=\"10\" src=\"/images/prv.gif\" width=\"8\"> <strong>Previous post</strong></img></a></div>\n<div class=\"pagi-right\">\n<a href=\"https://www.kdnuggets.com/2018/11/machine-learning-team-when-not-google-facebook.html\" rel=\"next\"><strong>Next post</strong> <img height=\"10\" src=\"/images/nxt.gif\" width=\"8\"/></a></div>\n<br/>\u00a0<br/>\u00a0\n    <div class=\"addthis_native_toolbox\"></div>\n</div>\n<div class=\"tag-data\">Tags: <a href=\"https://www.kdnuggets.com/tag/facebook\" rel=\"tag\">Facebook</a>, <a href=\"https://www.kdnuggets.com/tag/python\" rel=\"tag\">Python</a>, <a href=\"https://www.kdnuggets.com/tag/sales\" rel=\"tag\">Sales</a>, <a href=\"https://www.kdnuggets.com/tag/time-series\" rel=\"tag\">Time Series</a></div>\n<br/>\n<p class=\"excerpt\">\n     In this tutorial we\u2019ll use Prophet, a package developed by Facebook to show how one can achieve this.\n  </p>\n</div>\n<div id=\"post-header-ad\">\n<script type=\"text/javascript\">kda_sid_write(1); kda_sid_n=2;</script>\n</div>\n<hr class=\"grey-line\"/><br/>\n<div class=\"post\" id=\"post-\">\n<div class=\"author-link\"><b>By <a href=\"https://www.kdnuggets.com/author/derrick-mwiti\" rel=\"author\" title=\"Posts by Derrick Mwiti\">Derrick Mwiti</a>, Data Analyst.</b></div>\n<div align=\"right\"><img alt=\"c\" height=\"12\" src=\"/images/comment.gif\" width=\"16\"/> <a href=\"#comments\">comments</a></div>\n<p>Sales forecasting is one the most common tasks in many sales driven organizations. This activity enables organizations to adequately plan for the future with a degree of confidence. In this tutorial we\u2019ll use\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fresearch.fb.com%2Fprophet-forecasting-at-scale%2F\" rel=\"noopener noreferrer\" target=\"_blank\">Prophet</a>, a package developed by\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fresearch.fb.com%2Fprophet-forecasting-at-scale%2F\" rel=\"noopener noreferrer\" target=\"_blank\">Facebook</a>\u00a0to show how one can achieve this. This package is available in both\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fpypi.org%2Fproject%2Ffbprophet%2F\" rel=\"noopener noreferrer\" target=\"_blank\">Python</a>\u00a0and\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fcran.r-project.org%2Fpackage%3Dprophet\" rel=\"noopener noreferrer\" target=\"_blank\">R</a>. We assume that the reader has basic understanding of handling\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-time-series-data-in-pandas-be3887fdd621\" rel=\"noopener noreferrer\" target=\"_blank\">time series\u00a0</a>data in Python.</p>\n<p>\u00a0</p>\n<h3>Plan of\u00a0Attack</h3>\n<p>\u00a0</p>\n<ol>\n<li>Introduction and Installation\n<li>Model Fitting\n<li>Making Future Predictions\n<li>Obtaining the Forecasts\n<li>Plotting the Forecasts\n<li>Plotting the Forecast Components\n<li>Cross Validation\n<li>Obtaining the Performance Metrics\n<li>Visualizing Performance Metrics\n<li>Conclusion\n</li></li></li></li></li></li></li></li></li></li></ol>\n<p>\u00a0</p>\n<h3>Introduction and Installation</h3>\n<p>\u00a0<br>\nThere are very many open source forecastings tools, however none of these would be fit to solve all forecasting problems.\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fgithub.com%2Ffacebook%2Fprophet\" rel=\"noopener noreferrer\" target=\"_blank\">Prophet</a>\u00a0works best with hourly, and weekly data that is several months. When working with Prophet yearly data is most prefered. According to Facebook Research:</br></p>\n<blockquote><p>At its core, the Prophet procedure is an\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FAdditive_model\" rel=\"noopener noreferrer\" target=\"_blank\">additive regression model</a>\u00a0with four main components:</p>\n<p>1. A piecewise linear or logistic growth curve trend. Prophet automatically detects changes in trends by selecting changepoints from the data.<br>\n2. A yearly seasonal component modeled using\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FFourier_series\" rel=\"noopener noreferrer\" target=\"_blank\">Fourier series.</a><br>\n3. A weekly seasonal component using dummy variables.<br>\n4. A user-provided list of important holidays.</br></br></br></p></blockquote>\n<p>Prophet can be installed using pip in Python as shown below. Prophet depends on a Python module called\u00a0<code>pystan.</code>\u00a0This module will be installed automatically as we install Prophet.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/1573b98b13b7c99f60eb8e31b44810ef.js\"></script></p>\n<p>The dataset we\u2019ve used for this tutorial is available\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fdatamarket.com%2Fdata%2Fset%2F235d%2Fmean-daily-temperature-fisher-river-near-dallas-jan-01-1988-to-dec-31-1991%23!ds%3D235d%26display%3Dline\" rel=\"noopener noreferrer\" target=\"_blank\">here</a>. Once you download the dataset make sure to delete some unnecessary rows towards the end of the file because they might interfere with the analysis. For this\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FUnivariate\" rel=\"noopener noreferrer\" target=\"_blank\">univariate analysis</a>Prophet expects the dataset to have two columns named as\u00a0<em>ds</em>\u00a0and\u00a0<em>y</em>.\u00a0<em>ds</em>\u00a0is the date column while\u00a0<em>y</em>\u00a0is the column that we are forecasting.</p>\n<p>Let\u2019s get the ball rolling by importing Pandas for data manipulation and Prophet for forecasting. Next we load in our dataset and check its head.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/be31519504e3149b0fe7941129fd33d9.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*zd662AMnxKxPKEptfxedfw.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3>Model Fitting</h3>\n<p>\u00a0<br/>\nSince we\u2019ve worked with\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fscikit-learn.org%2F\" rel=\"noopener noreferrer\" target=\"_blank\">Scikit-learn</a>\u00a0before,working with Prophet will be a walk in the park for us. This is because the API implementation for Prophet and Scikit-learn are very similar as we\u2019ll see below. We start by creating an instance of the Prophet class and then fit it to our dataset.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/9ca8ceafae1581f3bfceae4265f98d1c.js\"></script></p>\n<p>\u00a0</p>\n<h3>Making Future Predictions</h3>\n<p>\u00a0<br/>\nThe next step is to prepare our model to make future predictions. This is achieved using the\u00a0<em>Prophet.make_future_dataframe\u00a0</em>method and passing the number of days we\u2019d like to predict in the future. We use the\u00a0<em>periods</em>\u00a0attribute to specify this. This also include the historical dates. We\u2019ll use these historical dates to compare the predictions with the actual values in the\u00a0<em>ds</em>\u00a0column.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/2cf6a29d0cd3fd967ef5e6e389d608e6.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*ajOKg6cMUUTiX86bXJHOfg.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3>Obtaining the Forecasts</h3>\n<p>\u00a0<br/>\nWe use the\u00a0<em>predict</em>\u00a0method to make future predictions. This will generate a dataframe with a\u00a0<em>yhat\u00a0</em>column that will contain the predictions.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/7b5353ee86ad93611620aa7cc2257817.js\"></script></p>\n<p>If we check the\u00a0<em>head</em>\u00a0for our forecast dataframe we\u2019ll notice that it has very many columns. However, we are mainly interested in\u00a0<strong><em>ds, yhat, yhat_lower\u00a0</em></strong>and<strong>\u00a0<em>yhat_upper. yhat\u00a0</em></strong>is our predicted forecast,\u00a0<strong><em>yhat_lower\u00a0</em></strong>is the lower bound for our predictions and\u00a0<strong><em>yhat_upper</em></strong>\u00a0is the upper bound for our predictions.</p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*WwdiMjOnZFmo2F4daQNclA.png\" width=\"99%\"/></p>\n<p>Let\u2019s proceed to check the tail and head of the forecast\u2019s dataframe.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/98405db5b0f266437bb5be0e4f5262cc.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*P9cUvHGwQT9LrqHV8zeP4Q.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3>Plotting the Forecasts</h3>\n<p>\u00a0<br/>\nProphet has an inbuilt feature that enables us to plot the forecasts we just generated. This is achieved using\u00a0<em>mode.plot()\u00a0</em>and passing in our forecasts as the argument. The blue line in the graph represents the predicted values while the black dots represents the data in our dataset.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/50a6682ab1e791e26030ef855fece645.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*6Kgkov_NzDrjIJOwisdDjQ.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3>Plotting the Forecast Components</h3>\n<p>\u00a0<br/>\nThe\u00a0<em>plot_components\u00a0</em>method plots the trend, yearly and weekly seasonality of the time series data.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/bce5e7006aa34481ac6c195600f300f0.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*57-ajfWL9-xkusMGNtWEeA.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3>Cross Validation</h3>\n<p>\u00a0<br/>\nNext let\u2019s measure the forecast error using the historical data. We\u2019ll do this by comparing the predicted values with the actual values. In order to perform this operation we select cut of points in the history of the data and fit the model with data upto that cut off point. Afterwards we compare the actual values to the predicted values. The\u00a0<em>cross_validation\u00a0</em>method allows us to do this in Prophet. This method take the following parameters as explained below:</p>\n<ol>\n<li><em>horizon\u00a0</em>the forecast horizon\n<li><em>initial\u00a0</em>the size of the initial training period\n<li><em>period\u00a0</em>the spacing between cutoff dates\n</li></li></li></ol>\n<p>The output of the\u00a0<em>cross_validation\u00a0</em>method is a dataframe containing\u00a0<em>y</em>\u00a0the true values and\u00a0<em>yhat</em>\u00a0the predicted values. We\u2019ll use this dataframe to compute the prediction errors.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/601f7cfea81203ff18cd27adca3f270f.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*7TO_HCAMYSegF7d5vSN2Bg.png\" width=\"50%\"/></p>\n<p>\u00a0</p>\n<h3>Obtaining the Performance Metrics</h3>\n<p>\u00a0<br/>\nWe use the\u00a0<em>performance_metrics</em>\u00a0utility to compute the Mean Squared Error(MSE), Root Mean Squared Error(RMSE),Mean Absolute Error(MAE), Mean Absolute Percentage Error(MAPE) and the coverage of the the\u00a0<code>yhat_lower</code>\u00a0and\u00a0<code>yhat_upper</code>\u00a0estimates.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/1c788520488eb3e7b9bfe07ba5f60398.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*kN-ye83y6bsSV8uIW3bt8A.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3><strong>Visualizing Performance Metrics</strong></h3>\n<p>\u00a0<br/>\nThe performance Metrics can be visualized using the\u00a0<em>plot_cross_validation_metric</em>\u00a0utility. Let\u2019s visualize the RMSE below.</p>\n<p><script src=\"https://gist.github.com/mwitiderrick/cb636d7d0e54921a807aff60650cdd7c.js\"></script></p>\n<p><img class=\"aligncenter\" src=\"https://cdn-images-1.medium.com/max/720/1*KQhliE9dH9IoCGGtDOjoZQ.png\" width=\"99%\"/></p>\n<p>\u00a0</p>\n<h3>Conclusion</h3>\n<p>\u00a0<br/>\nAs we have seen Prophet is very powerful and effective in time series forecasting. However, as we mentioned earlier there are a few other forecasting tools. Choice of tool is on a case by case basis depending on the nature of the dataset. One can always compare these tools and use the one that gives the best predictions with the least amount of errors. Some of these methods include\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fwww.statsmodels.org%2Fdev%2Fgenerated%2Fstatsmodels.tsa.arima_model.ARIMA.html\" rel=\"noopener noreferrer\" target=\"_blank\">ARIMA</a>,\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fotexts.org%2Ffpp2%2Fholt-winters.html\" rel=\"noopener noreferrer\" target=\"_blank\">Holt-Winters\u2019 Method</a>,\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fotexts.org%2Ffpp2%2Fholt.html\" rel=\"noopener noreferrer\" target=\"_blank\">Holt\u2019s linear trend</a>,<a href=\"https://medium.com/r/?url=https%3A%2F%2Fotexts.org%2Ffpp2%2Fses.html\" rel=\"noopener noreferrer\" target=\"_blank\">\u00a0Simple exponential smoothing</a>\u00a0and\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fwww.babypips.com%2Flearn%2Fforex%2Fusing-moving-averages\" rel=\"noopener noreferrer\" target=\"_blank\">Moving Averages</a>\u00a0among others. You can learn more about Prophet from the\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Ffacebook.github.io%2Fprophet%2F\" rel=\"noopener noreferrer\" target=\"_blank\">official docs</a>\u00a0or by reading\u00a0<a href=\"https://medium.com/r/?url=https%3A%2F%2Fpeerj.com%2Fpreprints%2F3190.pdf\" rel=\"noopener noreferrer\" target=\"_blank\">Prophet\u2019s Paper</a>.</p>\n<p>\u00a0<br/>\n<b>Bio: <a href=\"https://derrickmwiti.com/\" rel=\"noopener noreferrer\" target=\"_blank\">Derrick Mwiti</a></b> is a data analyst, a writer, and a mentor. He is driven by delivering great results in every task, and is a mentor at Lapid Leaders Africa.</p>\n<p><b>Related:</b></p>\n<ul class=\"three_ul\">\n<li><a href=\"/2018/11/keras-long-short-term-memory-lstm-model-predict-stock-prices.html\">Using a Keras Long Short-Term Memory (LSTM) Model to Predict Stock Prices</a>\n<li><a href=\"/2018/10/introduction-deep-learning-keras.html\">Introduction to Deep Learning with Keras</a>\n<li><a href=\"/2018/11/introduction-pytorch-deep-learning.html\">Introduction to PyTorch for Deep Learning</a>\n</li></li></li></ul>\n<p><a name=\"comments\"></a></p>\n<div id=\"disqus_thread\"></div>\n<p> <script type=\"text/javascript\">\n var disqus_shortname = 'kdnuggets';\n (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = 'https://kdnuggets.disqus.com/embed.js';\n (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })();\n </script></p>\n</div>\n<div class=\"page-link\"></div>\n<div class=\"pagi\">\n<hr class=\"grey-line\"/>\n<div class=\"pagi-left\">\n<a href=\"https://www.kdnuggets.com/2018/11/deep-learning-cheat-sheets.html\" rel=\"prev\"><img height=\"10\" src=\"/images/prv.gif\" width=\"8\"/> <strong>Previous post</strong></a></div>\n<div class=\"pagi-right\">\n<a href=\"https://www.kdnuggets.com/2018/11/machine-learning-team-when-not-google-facebook.html\" rel=\"next\"><strong>Next post</strong> <img height=\"10\" src=\"/images/nxt.gif\" width=\"8\"/></a></div>\n<br/><br/>\n<div>\n<hr class=\"grey-line\"/><br/>\n<h2>Top Stories Past 30 Days</h2>\n<table align=\"center\" cellpadding=\"3\" cellspacing=\"10\" class=\"latn\" width=\"100%\">\n<tr>\n<td valign=\"top\" width=\"50%\">\n<table cellpadding=\"3\" cellspacing=\"2\">\n<tr><th><b>Most Popular</b></th></tr>\n<tr><td>\n<ol class=\"three_ol\"><li> <a href=\"/2019/03/another-10-free-must-read-books-for-machine-learning-and-data-science.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-mp-1-another-10']);\"><b>Another 10 Free Must-Read Books for Machine Learning and Data Science</b></a>\n<li> <a href=\"/2018/05/simplilearn-9-must-have-skills-data-scientist.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-mp-2-simplilearn']);\"><b>9 Must-have skills you need to become a Data Scientist, updated</b></a>\n<li> <a href=\"/2019/03/typical-data-scientist-2019.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-mp-3-typical']);\"><b>Who is a typical Data Scientist in 2019?</b></a>\n<li> <a href=\"/2019/03/pareto-principle-data-scientists.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-mp-4-pareto']);\"><b>The Pareto Principle for Data Scientists</b></a>\n<li> <a href=\"/2019/03/data-science-job-applications.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-mp-5-tell-you']);\"><b>What no one will tell you about data science job applications</b></a>\n<li> <a href=\"/2019/03/women-ai-big-data-science-machine-learning.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-mp-6-inspiring-women']);\"><b>19 Inspiring Women in AI, Big Data, Data Science, Machine Learning</b></a>\n<li> <a href=\"/2019/03/favorite-ml-ai-breakthroughs.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-mp-7-breakthroughs']);\"><b>My favorite mind-blowing Machine Learning/AI breakthroughs</b></a>\n</li></li></li></li></li></li></li></ol>\n</td></tr>\n</table>\n</td> <td valign=\"top\">\n<table cellpadding=\"3\" cellspacing=\"2\">\n<tr><th><b>Most Shared</b></th></tr>\n<tr><td><ol class=\"three_ol\">\n<li> <a href=\"/2019/03/artificial-neural-networks-optimization-genetic-algorithm-python.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-ms-1-ann-optim-ga']);\"><b>Artificial Neural Networks Optimization using Genetic Algorithm with Python</b></a>\n<li> <a href=\"/2019/03/typical-data-scientist-2019.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-ms-2-typical']);\"><b>Who is a typical Data Scientist in 2019?</b></a>\n<li> <a href=\"/2019/03/simplilearn-8-reasons-microsoft-azure-certification.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-ms-3-azure-cert']);\"><b>8 Reasons Why You Should Get a Microsoft Azure Certification</b></a>\n<li> <a href=\"/2019/03/pareto-principle-data-scientists.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-ms-4-pareto']);\"><b>The Pareto Principle for Data Scientists</b></a>\n<li> <a href=\"/2019/03/r-vs-python-data-visualization.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-ms-5-r-vs-py-viz']);\"><b>R vs Python for Data Visualization</b></a>\n<li> <a href=\"/2019/03/work-data-science-ai-big-data.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-ms-6-how-work']);\"><b>How To Work In Data Science, AI, Big Data</b></a>\n<li> <a href=\"/2019/03/deep-learning-toolset-overview.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-02-ms-7-dl-toolset']);\"><b>The Deep Learning Toolset \u2014 An Overview</b></a>\n</li></li></li></li></li></li></li></ol>\n</td></tr>\n</table>\n</td>\n</tr>\n</table>\n</div>\n</div>\n<!--#content end--></div>\n<div id=\"sidebar\">\n<div class=\"latn\">\n<h3><b><a href=\"/news/index.html\">Latest News</a></b></h3>\n<ul style=\"font-size:14px; margin-top:5px\">\n<li> <a href=\"https://www.kdnuggets.com/2019/04/jmp-statistical-thinking-free-online-course.html\">Statistical Thinking for Industrial Problem Solving (ST...</a><li> <a href=\"https://www.kdnuggets.com/2019/04/datarobot-from-business-intelligence-machine-intelligence.html\">From Business Intelligence to Machine Intelligence</a><li> <a href=\"https://www.kdnuggets.com/2019/04/ai-makes-decision.html\">What is missing when AI makes a decision?</a><li> <a href=\"https://www.kdnuggets.com/2019/04/spatio-temporal-statistics-primer.html\">Spatio-Temporal Statistics: A Primer</a><li> <a href=\"https://www.kdnuggets.com/2019/04/another-10-free-must-see-courses-machine-learning-data-science.html\">Another 10 Free Must-See Courses for Machine Learning a...</a><li> <a href=\"https://www.kdnuggets.com/2019/04/datax-download-guide-ai-marketing.html\">Download your DATAx guide to AI in Marketing</a></li></li></li></li></li></li></ul>\n</div>\n<div>\n<script type=\"text/javascript\">kda_sid_write(kda_sid_n);</script>\n</div>\n<br/><script src=\"/aps/sbm.js\" type=\"text/javascript\"></script>\n</div>\n</div><div class=\"breadcrumbs_bottom\">\n<div class=\"breadcumb\">\n<br>\n<a href=\"/\">KDnuggets Home</a> \u00bb <a href=\"/news/index.html\">News</a> \u00bb <a href=\"/2018/index.html\">2018</a> \u00bb <a href=\"https://www.kdnuggets.com/2018/11/index.html\">Nov</a> \u00bb <a href=\"https://www.kdnuggets.com/2018/11/tutorials.html\">Tutorials, Overviews</a> \u00bb Sales Forecasting Using Facebook\u2019s Prophet (\u00a0<a href=\"/2018/n46.html\">18:n46</a>\u00a0)    </br></div>\n</div>\n<!--#content_wrapper end--></div>\n<br>\n<div id=\"footer\">\n<br/>\u00a9 2019 KDnuggets. <a href=\"/about/index.html\">About KDnuggets</a>. \u00a0<a href=\"/news/privacy-policy.html\">Privacy policy</a>. <a href=\"/terms-of-service.html\">Terms of Service</a><br/>\u00a0\n<div class=\"kd_bottom\">\n<div class=\"footer-container\">\n<div class=\"footer-news\">\n<a href=\"/news/subscribe.html\" onclick=\"_gaq.push(['_trackPageview','/x/bot/sub']);\" target=\"_blank\"><b>Subscribe to KDnuggets News</b></a>\n</div>\n<div class=\"footer-sm\">\n<a href=\"https://twitter.com/kdnuggets\" onclick=\"_gaq.push(['_trackPageview','/x/bot/twt']);\" target=\"_blank\"><img height=\"32\" src=\"/images/tw_c48.png\" width=\"32\"/></a>\n<a href=\"https://facebook.com/kdnuggets\" onclick=\"_gaq.push(['_trackPageview','/x/bot/fb']);\" target=\"_blank\"><img alt=\"Facebook\" height=\"32\" src=\"/images/fb_c48.png\" width=\"32\"/></a>\n<a href=\"https://www.linkedin.com/groups/54257\" onclick=\"_gaq.push(['_trackPageview','/x/bot/in']);\" target=\"_blank\"><img alt=\"LinkedIn\" height=\"32\" src=\"/images/in_c48.png\" width=\"32\"/></a>\n</div>\n</div>\n<div class=\"close-footer\">X</div>\n</div>\n<script type=\"text/javascript\">\n  jQuery('.close-footer').click(\n      function(){       \n         jQuery('.kd_bottom').hide();\n      }\n   );\n</script> </div>\n<div class=\"clear\"><!--blank--></div>\n</br></div>\n<div style=\"display: none;\"><div id=\"boxzilla-box-82996-content\"><script type=\"text/javascript\">(function() {\n\tif (!window.mc4wp) {\n\t\twindow.mc4wp = {\n\t\t\tlisteners: [],\n\t\t\tforms    : {\n\t\t\t\ton: function (event, callback) {\n\t\t\t\t\twindow.mc4wp.listeners.push({\n\t\t\t\t\t\tevent   : event,\n\t\t\t\t\t\tcallback: callback\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n})();\n</script><!-- MailChimp for WordPress v4.1.14 - https://wordpress.org/plugins/mailchimp-for-wp/ --><form class=\"mc4wp-form mc4wp-form-77281\" data-id=\"77281\" data-name=\"Subscribe to KDnuggets News\" id=\"mc4wp-form-1\" method=\"post\"><div class=\"mc4wp-form-fields\"><div class=\"header-container\">\n<img align=\"left\" src=\"/wp-content/uploads/envelope.png\"><a href=\"/news/subscribe.html\">Get KDnuggets, a leading newsletter on AI, \r\n  Data Science, and Machine Learning</a>\n</img></div>\n<div class=\"form-fields\">\n<div class=\"field-container\"><label>Email:</label><input maxlength=\"60\" name=\"EMAIL\" placeholder=\"Your email\" required=\"\" size=\"30\" type=\"email\"/></div>\n<div class=\"field-container submit-container\"><div class=\"form-button\" onclick=\"document.getElementById('mc4wp-form-1').submit()\">Sign Up</div></div>\n</div>\n<label style=\"display: none !important;\">Leave this field empty if you're human: <input autocomplete=\"off\" name=\"_mc4wp_honeypot\" tabindex=\"-1\" type=\"text\" value=\"\"/></label><input name=\"_mc4wp_timestamp\" type=\"hidden\" value=\"1554595447\"/><input name=\"_mc4wp_form_id\" type=\"hidden\" value=\"77281\"/><input name=\"_mc4wp_form_element_id\" type=\"hidden\" value=\"mc4wp-form-1\"/></div><div class=\"mc4wp-response\"></div></form><!-- / MailChimp for WordPress Plugin -->\n</div></div><script type=\"text/javascript\">(function() {function addEventListener(element,event,handler) {\n\tif(element.addEventListener) {\n\t\telement.addEventListener(event,handler, false);\n\t} else if(element.attachEvent){\n\t\telement.attachEvent('on'+event,handler);\n\t}\n}function maybePrefixUrlField() {\n\tif(this.value.trim() !== '' && this.value.indexOf('http') !== 0) {\n\t\tthis.value = \"http://\" + this.value;\n\t}\n}\n\nvar urlFields = document.querySelectorAll('.mc4wp-form input[type=\"url\"]');\nif( urlFields && urlFields.length > 0 ) {\n\tfor( var j=0; j < urlFields.length; j++ ) {\n\t\taddEventListener(urlFields[j],'blur',maybePrefixUrlField);\n\t}\n}/* test if browser supports date fields */\nvar testInput = document.createElement('input');\ntestInput.setAttribute('type', 'date');\nif( testInput.type !== 'date') {\n\n\t/* add placeholder & pattern to all date fields */\n\tvar dateFields = document.querySelectorAll('.mc4wp-form input[type=\"date\"]');\n\tfor(var i=0; i<dateFields.length; i++) {\n\t\tif(!dateFields[i].placeholder) {\n\t\t\tdateFields[i].placeholder = 'YYYY-MM-DD';\n\t\t}\n\t\tif(!dateFields[i].pattern) {\n\t\t\tdateFields[i].pattern = '[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])';\n\t\t}\n\t}\n}\n\n})();</script><script type=\"text/javascript\">\n/* <![CDATA[ */\nvar boxzilla_options = {\"testMode\":\"\",\"boxes\":[{\"id\":82996,\"icon\":\"&times;\",\"content\":\"\",\"css\":{\"background_color\":\"#eeee22\",\"width\":600,\"border_width\":2,\"border_style\":\"double\",\"position\":\"center\"},\"trigger\":{\"method\":\"time_on_page\",\"value\":\"3\"},\"animation\":\"fade\",\"cookie\":{\"triggered\":0,\"dismissed\":336},\"rehide\":true,\"position\":\"center\",\"screenWidthCondition\":{\"condition\":\"larger\",\"value\":500},\"closable\":true,\"post\":{\"id\":82996,\"title\":\"Subscribe to KDnuggets\",\"slug\":\"subscribe-to-kdnuggets\"}}]};\n/* ]]> */\n</script>\n<script src=\"https://www.kdnuggets.com/wp-content/plugins/boxzilla/assets/js/script.min.js?ver=3.2.5\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n/* <![CDATA[ */\nvar boxzilla_stats_config = {\"ajaxurl\":\"https:\\/\\/www.kdnuggets.com\\/wp-admin\\/admin-ajax.php?action=boxzilla_stats_track\"};\n/* ]]> */\n</script>\n<script src=\"https://www.kdnuggets.com/wp-content/plugins/boxzilla-stats/assets/js/tracking.min.js?ver=1.0.4\" type=\"text/javascript\"></script>\n<script src=\"https://www.kdnuggets.com/wp-includes/js/wp-embed.min.js?ver=4.9.10\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n/* <![CDATA[ */\nvar mc4wp_forms_config = [];\n/* ]]> */\n</script>\n<script src=\"https://www.kdnuggets.com/wp-content/plugins/mailchimp-for-wp/assets/js/forms-api.min.js?ver=4.1.14\" type=\"text/javascript\"></script>\n<!--[if lte IE 9]>\n<script type='text/javascript' src='https://www.kdnuggets.com/wp-content/plugins/mailchimp-for-wp/assets/js/third-party/placeholders.min.js?ver=4.1.14'></script>\n<![endif]-->\n<!--/.main_wrapper--></body></html>\n<script src=\"https://s7.addthis.com/js/300/addthis_widget.js#pubid=gpsaddthis\" type=\"text/javascript\"></script>\n\n\n<!-- Dynamic page generated in 0.670 seconds. -->\n<!-- Cached page generated by WP-Super-Cache on 2019-04-06 20:04:07 -->\n<!-- Compression = gzip -->", "title": "Sales Forecasting Using Facebook\u2019s Prophet  ", "content": "\n By  Derrick Mwiti  , Data Analyst.   \n    comments   \n Sales forecasting is one the most common tasks in many sales driven organizations. This activity enables organizations to adequately plan for the future with a degree of confidence. In this tutorial we\u2019ll use\u00a0 Prophet  , a package developed by\u00a0 Facebook  \u00a0to show how one can achieve this. This package is available in both\u00a0 Python  \u00a0and\u00a0 R  . We assume that the reader has basic understanding of handling\u00a0 time series\u00a0  data in Python.  \n \u00a0  \n Plan of\u00a0Attack  \n \u00a0  \n \n Introduction and Installation\n Model Fitting\n Making Future Predictions\n Obtaining the Forecasts\n Plotting the Forecasts\n Plotting the Forecast Components\n Cross Validation\n Obtaining the Performance Metrics\n Visualizing Performance Metrics\n Conclusion\n            \n \u00a0  \n Introduction and Installation  \n \u00a0 \nThere are very many open source forecastings tools, however none of these would be fit to solve all forecasting problems.\u00a0 Prophet  \u00a0works best with hourly, and weekly data that is several months. When working with Prophet yearly data is most prefered. According to Facebook Research:   \n At its core, the Prophet procedure is an\u00a0 additive regression model  \u00a0with four main components:  \n 1. A piecewise linear or logistic growth curve trend. Prophet automatically detects changes in trends by selecting changepoints from the data. \n2. A yearly seasonal component modeled using\u00a0 Fourier series.  \n3. A weekly seasonal component using dummy variables. \n4. A user-provided list of important holidays.      \n Prophet can be installed using pip in Python as shown below. Prophet depends on a Python module called\u00a0 pystan.  \u00a0This module will be installed automatically as we install Prophet.  \n   \n The dataset we\u2019ve used for this tutorial is available\u00a0 here  . Once you download the dataset make sure to delete some unnecessary rows towards the end of the file because they might interfere with the analysis. For this\u00a0 univariate analysis  Prophet expects the dataset to have two columns named as\u00a0 ds  \u00a0and\u00a0 y  .\u00a0 ds  \u00a0is the date column while\u00a0 y  \u00a0is the column that we are forecasting.  \n Let\u2019s get the ball rolling by importing Pandas for data manipulation and Prophet for forecasting. Next we load in our dataset and check its head.  \n   \n   \n \u00a0  \n Model Fitting  \n \u00a0  \nSince we\u2019ve worked with\u00a0 Scikit-learn  \u00a0before,working with Prophet will be a walk in the park for us. This is because the API implementation for Prophet and Scikit-learn are very similar as we\u2019ll see below. We start by creating an instance of the Prophet class and then fit it to our dataset.  \n   \n \u00a0  \n Making Future Predictions  \n \u00a0  \nThe next step is to prepare our model to make future predictions. This is achieved using the\u00a0 Prophet.make_future_dataframe\u00a0  method and passing the number of days we\u2019d like to predict in the future. We use the\u00a0 periods  \u00a0attribute to specify this. This also include the historical dates. We\u2019ll use these historical dates to compare the predictions with the actual values in the\u00a0 ds  \u00a0column.  \n   \n   \n \u00a0  \n Obtaining the Forecasts  \n \u00a0  \nWe use the\u00a0 predict  \u00a0method to make future predictions. This will generate a dataframe with a\u00a0 yhat\u00a0  column that will contain the predictions.  \n   \n If we check the\u00a0 head  \u00a0for our forecast dataframe we\u2019ll notice that it has very many columns. However, we are mainly interested in\u00a0 ds, yhat, yhat_lower\u00a0   and \u00a0 yhat_upper. yhat\u00a0   is our predicted forecast,\u00a0 yhat_lower\u00a0   is the lower bound for our predictions and\u00a0 yhat_upper   \u00a0is the upper bound for our predictions.  \n   \n Let\u2019s proceed to check the tail and head of the forecast\u2019s dataframe.  \n   \n   \n \u00a0  \n Plotting the Forecasts  \n \u00a0  \nProphet has an inbuilt feature that enables us to plot the forecasts we just generated. This is achieved using\u00a0 mode.plot()\u00a0  and passing in our forecasts as the argument. The blue line in the graph represents the predicted values while the black dots represents the data in our dataset.  \n   \n   \n \u00a0  \n Plotting the Forecast Components  \n \u00a0  \nThe\u00a0 plot_components\u00a0  method plots the trend, yearly and weekly seasonality of the time series data.  \n   \n   \n \u00a0  \n Cross Validation  \n \u00a0  \nNext let\u2019s measure the forecast error using the historical data. We\u2019ll do this by comparing the predicted values with the actual values. In order to perform this operation we select cut of points in the history of the data and fit the model with data upto that cut off point. Afterwards we compare the actual values to the predicted values. The\u00a0 cross_validation\u00a0  method allows us to do this in Prophet. This method take the following parameters as explained below:  \n \n horizon\u00a0  the forecast horizon\n initial\u00a0  the size of the initial training period\n period\u00a0  the spacing between cutoff dates\n     \n The output of the\u00a0 cross_validation\u00a0  method is a dataframe containing\u00a0 y  \u00a0the true values and\u00a0 yhat  \u00a0the predicted values. We\u2019ll use this dataframe to compute the prediction errors.  \n   \n   \n \u00a0  \n Obtaining the Performance Metrics  \n \u00a0  \nWe use the\u00a0 performance_metrics  \u00a0utility to compute the Mean Squared Error(MSE), Root Mean Squared Error(RMSE),Mean Absolute Error(MAE), Mean Absolute Percentage Error(MAPE) and the coverage of the the\u00a0 yhat_lower  \u00a0and\u00a0 yhat_upper  \u00a0estimates.  \n   \n   \n \u00a0  \n Visualizing Performance Metrics   \n \u00a0  \nThe performance Metrics can be visualized using the\u00a0 plot_cross_validation_metric  \u00a0utility. Let\u2019s visualize the RMSE below.  \n   \n   \n \u00a0  \n Conclusion  \n \u00a0  \nAs we have seen Prophet is very powerful and effective in time series forecasting. However, as we mentioned earlier there are a few other forecasting tools. Choice of tool is on a case by case basis depending on the nature of the dataset. One can always compare these tools and use the one that gives the best predictions with the least amount of errors. Some of these methods include\u00a0 ARIMA  ,\u00a0 Holt-Winters\u2019 Method  ,\u00a0 Holt\u2019s linear trend  , \u00a0Simple exponential smoothing  \u00a0and\u00a0 Moving Averages  \u00a0among others. You can learn more about Prophet from the\u00a0 official docs  \u00a0or by reading\u00a0 Prophet\u2019s Paper  .  \n \u00a0  \n Bio:  Derrick Mwiti    is a data analyst, a writer, and a mentor. He is driven by delivering great results in every task, and is a mentor at Lapid Leaders Africa.  \n Related:   \n \n Using a Keras Long Short-Term Memory (LSTM) Model to Predict Stock Prices  \n Introduction to Deep Learning with Keras  \n Introduction to PyTorch for Deep Learning  \n     \n   \n  \n     \n  ", "title_html": "<h1 id=\"title\">Sales Forecasting Using Facebook\u2019s Prophet</h1> "}