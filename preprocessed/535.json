{"content": "By Ye Wu & Rick Radewagen, IE Business School. Introduction \u00a0 What have datasets in domains like, fraud detection in banking, real-time bidding in marketing\u00a0or intrusion detection in networks, in common? Data used in these areas often have less than 1% of rare, but \u201cinteresting\u201d events (e.g. fraudsters using credit cards, user clicking advertisement or corrupted server scanning its network). However, most machine learning algorithms do not work very well with imbalanced datasets. The following seven techniques can help you, to train a classifier to detect the abnormal class. \u00a0 1. Use the right evaluation metrics \u00a0 Applying inappropriate evaluation metrics for model generated using imbalanced data can be dangerous. Imagine our training data is the one illustrated in graph above. If accuracy is used to measure the goodness of a model, a model which classifies all testing samples into \u201c0\u201d will have an excellent accuracy (99.8%), but obviously, this model won\u2019t provide any valuable information for us. In this case, other alternative evaluation metrics can be applied such as: Precision/Specificity: how many selected instances are relevant. Recall/Sensitivity: how many relevant instances are selected. F1 score: harmonic mean of precision and recall. MCC: correlation coefficient between the observed and predicted binary classifications. AUC: relation between true-positive rate and false positive rate. \u00a0 2. Resample the training set \u00a0 Apart from using different evaluation criteria, one can also work on getting different dataset. Two approaches to make a balanced dataset out of an imbalanced one are under-sampling and over-sampling. 2.1. Under-sampling Under-sampling balances the dataset by reducing the size of the abundant class. This method is used when quantity of data is sufficient. By keeping all samples in the rare class and randomly selecting an equal number of samples in the abundant class, a balanced new dataset can be retrieved for further modelling. 2.2. Over-sampling On the contrary, oversampling is used when the quantity of data is insufficient. It tries to balance dataset by increasing the size of rare samples. Rather than getting rid of abundant samples, new rare samples are generated by using e.g. repetition, bootstrapping or SMOTE (Synthetic Minority Over-Sampling Technique) [1]. Note that there is no absolute advantage of one resampling method over another. Application of these two methods depends on the use case it applies to and the dataset itself. A combination of over- and under-sampling is often successful as well. \u00a0 3. Use K-fold Cross-Validation in the right way \u00a0 It is noteworthy that cross-validation should be applied properly while using over-sampling method to address imbalance problems. Keep in mind that over-sampling takes observed rare samples and applies bootstrapping to generate new random data based on a distribution function. If cross-validation is applied after over-sampling, basically what we are doing is overfitting our model to a specific artificial bootstrapping result. That is why cross-validation should always be done before over-sampling the data, just as how feature selection should be implemented. Only by resampling the data repeatedly, randomness can be introduced into the dataset to make sure that there won\u2019t be an overfitting problem. \u00a0 4. Ensemble different resampled datasets \u00a0 The easiest way to successfully generalize a model is by using more data. The problem is that out-of-the-box classifiers like logistic regression or random forest tend to generalize by discarding\u00a0the rare class. One easy best practice is building n models that use all the samples of the rare class and n-differing samples of the abundant class. Given that you want to ensemble 10 models, you would keep e.g. the 1.000 cases of the rare class and randomly sample 10.000 cases of the abundant class. Then you just split the 10.000 cases in 10 chunks and train 10 different models. This approach is simple and perfectly horizontally scalable if you have a lot of data, since you can just train and run\u00a0your models on different cluster nodes. Ensemble models also tend to generalize better, which makes this approach easy to handle. \u00a0 5. Resample with different ratios \u00a0 The previous approach can be fine-tuned by playing with the ratio between the rare and the abundant class. The best ratio \u00a0heavily depends on the data and the models that are used. But instead of training all models with the same ratio in the ensemble, it is worth trying to ensemble different ratios. \u00a0So if 10 models are trained, it might make sense to have a model that has a ratio of 1:1 (rare:abundant) and another one with 1:3, or even 2:1. Depending on the model used this can influence the weight that one class gets. \u00a0 6. Cluster the abundant class \u00a0 An elegant approach was proposed by Sergey on Quora [2]. Instead of relying on random samples to cover the variety of the training samples, he suggests clustering the abundant class in r groups, with r being the number of cases in r. For each group, only the medoid (centre of cluster) is kept. The model is then trained with the rare class and the medoids only. \u00a0 7. Design your own models \u00a0 All the previous methods focus on the data and keep the models as a fixed component. But in fact, there is no need to resample the data if the model is suited for imbalanced data. The famous XGBoost is already a good starting point if the classes are not skewed too much, because it internally takes care that the bags it trains on are not imbalanced. But then again, the data is resampled, it is just happening secretly. By designing a cost function that is penalizing wrong classification of the rare class more than wrong classifications of the abundant class, it is possible to design many models that naturally generalize in favour of the rare class. For example, tweaking an SVM to penalize wrong classifications of the rare class by the same ratio that this class is underrepresented. \u00a0 Final Remarks \u00a0 This is not an exclusive list of techniques, but rather a starting point to handle imbalanced data. There is no best approach or model suited for all problems and it is strongly recommended to try different techniques and models to evaluate what works best. Try to be creative and combine different approaches. It is also important, to be aware that in many domains (e.g. fraud detection, real-time-bidding), where imbalanced classes occur, the \u201cmarket-rules\u201d are constantly changing. So, check if past data might have become obsolete. [1] arxiv.org/pdf/1106.1813.pdf [2] www.quora.com/In-classification-how-do-you-handle-an-unbalanced-training-set/answers/1144228?srid=h3G6o Ye Wu is pursuing the Master in Business Analytics & Big Data at the IE Business School. She has a background in Accounting and hands-on experience in Marketing and Sales Forecasting. Rick Radewagen is an aspiring Data Scientist with a background in Computer Science. He is also pursuing the Master in Business Analytics & Big Data at the IE Business School. Related: Learning from Imbalanced Classes Dealing with Unbalanced Classes, SVMs, Random Forests, and Decision Trees in Python Tidying Data in Python", "title_html": "<h1 id=\"title\"><img align=\"right\" alt=\"Silver Blog, Jun 2017\" src=\"/images/top-kdnuggets-blog-2017-jun-silver.png\" width=\"80\"/>7 Techniques to Handle Imbalanced Data</h1> ", "url": "https://www.kdnuggets.com/2017/06/7-techniques-handle-imbalanced-data.html", "tfidf": {"tfidf": {"after": 1.02070207021, "base": 1.14628158845, "natur": 1.5392670157100001, "deal": 2.18346857379, "fact": 1.73375559681, "awar": 4.27693965517, "easiest": 64.8, "too": 1.81585268215, "occur": 1.7453825857499998, "noteworthi": 27.0, "aspir": 11.1881606765, "veri": 1.25880114177, "new": 3.0536641662, "insuffici": 10.911340206199998, "medoid": 3175.2, "apart": 3.1032056294, "what": 3.7603031738399997, "sridhnumgnumo": 1587.6, "much": 1.1942229577299999, "experi": 1.87062566278, "evalu": 34.754816112099995, "than": 3.0983606557499996, "care": 2.49426551453, "dataset": 1936.0975609799998, "intrus": 34.3636363636, "function": 4.99088337, "class": 48.679909345489996, "which": 2.01038369, "mind": 3.5918552036199998, "have": 6.089369046839999, "python": 112.5957446808, "just": 5.34320572148, "kfold": 1587.6, "test": 2.65707112971, "well": 2.1311497416, "done": 2.3302509907499998, "market": 4.73204172876, "previous": 2.85693719632, "she": 2.16, "approach": 14.52895803373, "valuabl": 7.46754468485, "underrepres": 189.0, "suffici": 4.3117870722400005, "classifi": 15.8812937646, "would": 1.0828729281799998, "random": 50.3315217391, "check": 6.50655737705, "finetun": 1587.6, "size": 4.9877474081, "bid": 8.595560368160001, "recommend": 3.9142011834300003, "oversampl": 12700.8, "equal": 2.542193755, "ensembl": 83.73417721499999, "measur": 2.41093394077, "instead": 3.18923262354, "model": 50.1743481696, "run": 1.55692850838, "how": 4.80750984153, "sale": 3.4274611399, "criteria": 11.7426035503, "trueposit": 1587.6, "arxivorgpdfnumpdf": 1587.6, "chunk": 81.0, "favour": 4.57521613833, "simpl": 3.3981164383599998, "keep": 8.16981860284, "resampl": 11113.199999999999, "increas": 1.32024948025, "domain": 18.78816568048, "marketrul": 1587.6, "distribut": 2.7396031061299997, "sure": 7.453521126760001, "correl": 13.1860465116, "interest": 1.60331246213, "play": 1.46390041494, "mani": 4.17707031508, "will": 1.22481098596, "introduct": 2.7808723068799996, "over": 2.05050048434, "event": 1.5356935577500002, "predict": 5.18484650555, "build": 1.6341739578, "creativ": 6.52259654889, "realtim": 429.081081081, "provid": 1.21552714187, "select": 8.09380576088, "undersampl": 6350.4, "but": 6.09794507394, "success": 2.6400598653, "unbalanc": 103.764705882, "need": 1.4372623574099999, "our": 4.71517671518, "classif": 32.268292682920006, "cost": 2.31935719503, "final": 1.34008609775, "inform": 1.5753125620200001, "past": 2.01702452039, "eleg": 20.9169960474, "num": 26.00819104026, "applic": 3.42672134686, "same": 2.23715916296, "kept": 2.94327030033, "best": 6.331405782640001, "exampl": 1.50483412322, "fraud": 32.937759336, "has": 2.0872995004, "given": 1.35426085473, "illustr": 3.6614391143900002, "specif": 1.8719490626099997, "again": 1.50883862384, "advantag": 3.32412060302, "inappropri": 21.6, "follow": 1.04640126549, "suggest": 1.7571665744299998, "famous": 2.28201811125, "further": 1.3618116315, "synthet": 21.3674293405, "out": 1.06016694491, "bootstrap": 793.8000000000001, "good": 3.03963239518, "alway": 2.06745670009, "basic": 2.7301805675, "regress": 51.2129032258, "possibl": 1.4173734488, "number": 2.20285833218, "reduc": 1.98698372966, "fix": 4.4346368715099995, "reli": 4.16146788991, "absolut": 5.3472549680000006, "also": 4.05906040268, "address": 2.86157173756, "start": 2.53347163488, "tri": 7.417825020439999, "train": 19.365698951, "mean": 1.44906900329, "not": 4.06269592476, "seven": 1.93940874664, "accuraci": 25.5241157556, "method": 12.857142857150002, "compon": 4.09491875161, "minor": 2.23071518898, "radewagen": 3175.2, "the": 70.0, "area": 1.3881262568900001, "wrong": 16.43478260871, "becom": 1.12492028626, "less": 1.46904783936, "contrari": 8.042553191489999, "logist": 14.0994671403, "happen": 2.96359902931, "scientist": 4.69426374926, "easi": 10.5875291764, "bank": 2.87400434468, "score": 4.2884927066500005, "metric": 66.7058823528, "handl": 7.845811712380001, "want": 1.99698113208, "problem": 7.06699310036, "danger": 3.42007755278, "sinc": 1.08368600683, "design": 4.37475888675, "anoth": 2.27287043664, "outofthebox": 1587.6, "howev": 1.0945191313299998, "penal": 56.7, "techniqu": 14.917547568720002, "wwwquoracominclassificationhowdoyouhandleanunbalancedtrainingsetanswersnum": 1587.6, "scienc": 2.31969608416, "card": 6.42492917847, "imbalanc": 4536.0, "imbal": 40.917525773200005, "fraudster": 635.04, "suit": 7.8574610245, "realtimebid": 1587.6, "node": 44.3463687151, "featur": 1.52712581762, "such": 1.06151377374, "rid": 23.837837837800002, "tweak": 113.4, "practic": 1.70434782609, "ndiffer": 1587.6, "alreadi": 1.9551724137900002, "influenc": 1.77246846042, "other": 1.00992366412, "appli": 13.7832441036, "itself": 1.74557449148, "algorithm": 27.9507042254, "one": 7.04392470054, "graph": 37.7102137767, "abund": 95.63855421689999, "precisionspecif": 1587.6, "weight": 4.878918254459999, "should": 4.99297620297, "observ": 4.44892812106, "becaus": 1.1495184997499999, "horizont": 11.6137527432, "worth": 5.210370856580001, "get": 5.35687774155, "centr": 2.97080838323, "like": 2.2983713355, "implement": 3.57648118946, "lot": 4.40877534018, "right": 2.8109065155799997, "imagin": 6.598503740650001, "detect": 21.65155131264, "result": 1.14611608432, "analyt": 34.513043478200004, "that": 16.06374502, "bag": 15.8601398601, "varieti": 2.2972073506, "precis": 5.322158900440001, "xgboost": 1587.6, "repeat": 2.8771293947099994, "use": 16.474220118079998, "tidi": 196.0, "introduc": 1.7258397651900002, "click": 34.7396061269, "recal": 5.30614973262, "ani": 1.13383802314, "two": 2.0275862069, "sampl": 86.79362186784, "from": 2.00113442994, "relat": 2.47501753838, "account": 1.94463498285, "abnorm": 29.8983050847, "work": 3.34560269739, "recallsensit": 1587.6, "differ": 11.128904120249999, "instanc": 6.514567090680001, "make": 4.305064063440001, "decis": 2.16, "binari": 32.4, "most": 1.02096463023, "between": 3.1036100612399995, "tree": 4.127925117, "heavili": 3.24132298898, "server": 38.071942446, "balanc": 17.81318373072, "excel": 4.84467500763, "depend": 6.723320158110001, "obvious": 6.44841592201, "credit": 3.04312823462, "secret": 3.11294117647, "all": 6.06880733946, "quora": 1587.6, "school": 4.92024793389, "with": 9.010783880909997, "strong": 1.6439888163999998, "there": 4.16365066876, "are": 10.299059357800001, "remark": 3.8515283842800003, "split": 3.4709226060300002, "better": 2.0065722952500002, "case": 8.90992423536, "ratio": 50.49159472966, "sens": 2.8365195640499996, "background": 8.05479452054, "take": 2.27923336444, "network": 5.18738768176, "cluster": 50.0031496064, "rate": 4.2809761359, "more": 2.0343413634, "and": 24.001511811119997, "list": 1.36321483771, "intern": 1.30355530011, "whi": 3.2566153846200003, "these": 2.14830852504, "discard": 19.1277108434, "combin": 3.39520958084, "posit": 1.37252528746, "forest": 9.79093432008, "general": 4.487280949680001, "focus": 2.01012914662, "befor": 1.10036041031, "retriev": 2.16826003824, "tend": 6.7471313217199995, "artifici": 8.31639601886, "corrupt": 6.3835946924, "crossvalid": 6350.4, "for": 7.00220528007, "then": 3.25973581548, "group": 2.41993750476, "won": 4.63465187564, "can": 10.58635252278, "comput": 3.9277585353800006, "harmon": 20.172808132100002, "set": 1.18707940781, "way": 2.4381478922, "proper": 3.3388012618299996, "onli": 3.0769429549800007, "each": 1.18974820144, "scalabl": 186.776470588, "skew": 71.5135135135, "rare": 38.163461538439996, "master": 6.30250099246, "this": 8.03034901368, "rick": 27.3960310612, "pursu": 8.3076923077, "common": 1.4025974025999999, "big": 5.480151881259999, "while": 1.0441988950299999, "data": 70.90514674614, "note": 1.42449528937, "fals": 6.21613155834, "handson": 1587.6, "perfect": 4.48601299802, "rather": 3.11385701676, "machin": 4.02433460076, "into": 2.03004922958, "relev": 13.877622377620002, "might": 4.312372674180001, "advertis": 5.61187698834, "sergey": 85.3548387097, "abov": 1.90382539873, "scan": 18.8104265403, "constant": 3.6589075823900004, "quantiti": 14.46560364464, "where": 1.06715063521, "altern": 2.1390460792200003, "import": 1.3401992233700002, "coeffici": 36.4965517241, "obsolet": 17.8783783784, "busi": 10.277058518899999, "propos": 1.9902218879299998, "generat": 6.15826221876, "overfit": 3175.2, "svms": 1587.6, "help": 1.39962972759, "exclus": 3.40906162766, "when": 2.0415353951, "chang": 1.1808985421, "often": 2.5890410959, "repetit": 20.4324324324, "point": 2.51980001588, "forecast": 21.897931034499997, "learn": 4.6455010973, "cover": 1.69380134429, "even": 1.16461267606, "user": 7.71053909665, "own": 1.17844418052}, "logtfidf": {"after": 0.020490694648099998, "base": 0.13652330228700002, "natur": 0.431306339292, "deal": 0.780914701253, "fact": 0.5502899207949999, "awar": 1.45323772, "easiest": 4.17130560336, "too": 0.5965551547219999, "occur": 0.556973778473, "noteworthi": 3.295836866, "aspir": 2.41485613674, "veri": 0.230159793238, "new": 0.0531898405533, "insuffici": 2.3898026343, "medoid": 14.739957441820001, "apart": 1.1324356512, "what": 0.677661890481, "sridhnumgnumo": 7.369978720910001, "much": 0.17749572930100002, "experi": 0.626272953933, "evalu": 9.69440121565, "than": 0.0967825866546, "care": 0.9139943029109999, "dataset": 52.6584456664, "intrus": 3.5369989228199996, "function": 1.828931483188, "class": 17.244760368459, "which": 0.01035682769086, "mind": 1.2786688388299998, "have": 0.0887100140472, "python": 8.06131348592, "just": 1.158125736436, "kfold": 7.369978720910001, "test": 0.977224437103, "well": 0.1270288766312, "done": 0.845975983129, "market": 1.7224191678740002, "previous": 0.713205920126, "she": 0.7701082216959999, "approach": 5.1116353020670005, "valuabl": 2.010566255, "underrepres": 5.24174701506, "suffici": 1.4613524521099999, "classifi": 4.99958890545, "would": 0.0796176279647, "random": 13.809049845569998, "check": 1.87281049562, "finetun": 7.369978720910001, "size": 1.8276744121219999, "bid": 2.1512458337, "recommend": 1.36461126863, "oversampl": 58.959829767280006, "equal": 0.933027391343, "ensembl": 14.09104655825, "measur": 0.880014199726, "instead": 0.9332663008300001, "model": 17.698801754664004, "run": 0.442714975539, "how": 1.4147008707900002, "sale": 1.23181979465, "criteria": 2.4632235573, "trueposit": 7.369978720910001, "arxivorgpdfnumpdf": 7.369978720910001, "chunk": 4.394449154669999, "favour": 1.5206539409600002, "simpl": 1.2232212893899999, "keep": 2.8566093786919997, "resampl": 51.58985104637001, "increas": 0.277820718929, "domain": 4.48016001198, "marketrul": 7.369978720910001, "distribut": 1.00781305813, "sure": 2.0086865552, "correl": 2.57915918803, "interest": 0.47207177798199995, "play": 0.38110439064199997, "mani": 0.1732630324884, "will": 0.202786534915, "introduct": 1.02276465794, "over": 0.0498734429914, "event": 0.428982108147, "predict": 1.6457402376899999, "build": 0.491137452091, "creativ": 1.87527254036, "realtim": 6.0616459012599995, "provid": 0.19517784432500002, "select": 2.819218748532, "undersampl": 29.479914883640003, "but": 0.0971542324314, "success": 0.5553088251839999, "unbalanc": 4.64212589251, "need": 0.362740163442, "our": 1.7152784283640001, "classif": 8.35116294516, "cost": 0.84129007618, "final": 0.292733863948, "inform": 0.454453704662, "past": 0.7016234157610001, "eleg": 3.0405620365099995, "num": 0.008189750280322, "applic": 1.23160392849, "same": 0.224119299208, "kept": 1.0795213101999999, "best": 1.836911731788, "exampl": 0.40868267499899996, "fraud": 5.602945038580001, "has": 0.0854478897096, "given": 0.303255810831, "illustr": 1.2978562707799999, "specif": 0.626980167541, "again": 0.411340231612, "advantag": 1.20120515883, "inappropri": 3.0726933146900004, "follow": 0.045356911094199995, "suggest": 0.563702610877, "famous": 0.825060187979, "further": 0.308815895297, "synthet": 3.0618677691900005, "out": 0.0584263909193, "bootstrap": 16.73465775504, "good": 0.837178809814, "alway": 0.726319204572, "basic": 1.00436774895, "regress": 3.9359915164199997, "possibl": 0.348805474891, "number": 0.1932171568372, "reduc": 0.686617775143, "fix": 1.48944573451, "reli": 1.42586787018, "absolut": 1.67658333914, "also": 0.0586286312, "address": 1.05137103247, "start": 0.472886738582, "tri": 2.47036611664, "train": 6.609183128390001, "mean": 0.37092128352, "not": 0.06220965203, "seven": 0.662383156851, "accuraci": 5.0929530812, "method": 4.7223080442050005, "compon": 1.40974687623, "minor": 0.802322246604, "radewagen": 14.739957441820001, "the": 0.0, "area": 0.327954821122, "wrong": 5.102363073059999, "becom": 0.11771217648900001, "less": 0.3846144626, "contrari": 2.08474659391, "logist": 2.6461370052, "happen": 1.08640441802, "scientist": 1.54634128444, "easi": 3.3330592702999997, "bank": 1.0557062993700002, "score": 1.4559353207700003, "metric": 9.305042554679998, "handl": 2.73366533806, "want": 0.6916366062549999, "problem": 2.276562897092, "danger": 1.22966322707, "sinc": 0.0803681994577, "design": 1.131717354066, "anoth": 0.255792723304, "outofthebox": 7.369978720910001, "howev": 0.0903151173475, "penal": 6.689254060340001, "techniqu": 5.26497539228, "wwwquoracominclassificationhowdoyouhandleanunbalancedtrainingsetanswersnum": 7.369978720910001, "scienc": 0.841436178891, "card": 1.8601856079099999, "imbalanc": 50.722874429840004, "imbal": 3.7115584742800003, "fraudster": 6.45368798903, "suit": 2.73663269764, "realtimebid": 7.369978720910001, "node": 3.7920308275, "featur": 0.423387418142, "such": 0.059695977806, "rid": 3.17127414336, "tweak": 4.73092139129, "practic": 0.533182530867, "ndiffer": 7.369978720910001, "alreadi": 0.670478380747, "influenc": 0.572373185428, "other": 0.00987474791976, "appli": 4.990165138871999, "itself": 0.5570837229510001, "algorithm": 3.33044239518, "one": 0.0437874615185, "graph": 3.6299309802199997, "abund": 22.579909325499997, "precisionspecif": 7.369978720910001, "weight": 1.58492352612, "should": 1.5282596302740001, "observ": 1.5990320298640002, "becaus": 0.139343158825, "horizont": 2.4521899771799998, "worth": 1.65065103492, "get": 1.739307017346, "centr": 1.08883409869, "like": 0.27810715309, "implement": 1.27437940907, "lot": 1.4835969502500002, "right": 0.68071970834, "imagin": 1.88684291737, "detect": 6.75513097972, "result": 0.136378908381, "analyt": 5.696380287719999, "that": 0.06361837407424, "bag": 2.76380903459, "varieti": 0.8316941898119999, "precis": 1.67187902939, "xgboost": 7.369978720910001, "repeat": 1.0567930591299999, "use": 0.4673283157056, "tidi": 5.278114659230001, "introduc": 0.5457137524260001, "click": 3.54788042301, "recal": 1.6688664748100002, "ani": 0.125608358366, "two": 0.0273976887164, "sampl": 23.74351786068, "from": 0.001134108337732, "relat": 0.42620060330799997, "account": 0.665074289973, "abnorm": 3.3978017926599997, "work": 0.327103701819, "recallsensit": 7.369978720910001, "differ": 1.910890091808, "instanc": 2.36178715944, "make": 0.29399063129159997, "decis": 0.7701082216959999, "binari": 3.4781584227999995, "most": 0.020747896295599998, "between": 0.10186104349589999, "tree": 1.41777488775, "heavili": 1.17598157639, "server": 3.6394775921, "balanc": 5.974577924199999, "excel": 1.5778801652, "depend": 2.420909445, "obvious": 1.86383450716, "credit": 1.11288601088, "secret": 1.13556799519, "all": 0.06841579258679999, "quora": 7.369978720910001, "school": 1.484239900896, "with": 0.01077742542051, "strong": 0.49712549393600003, "there": 0.160391571702, "are": 0.294674735827, "remark": 1.34847005245, "split": 1.24442043932, "better": 0.6964279406, "case": 2.372437613334, "ratio": 13.83127712666, "sens": 1.04257779501, "background": 2.7862406523799996, "take": 0.261383924394, "network": 1.9061661061039998, "cluster": 10.1031665378, "rate": 1.522067744332, "more": 0.034049863199999995, "and": 0.0015117634095264, "list": 0.309845761506, "intern": 0.265095377816, "whi": 1.18068843047, "these": 0.1430672388016, "discard": 2.95113811311, "combin": 1.058436621502, "posit": 0.316652318608, "forest": 3.1766194152, "general": 0.459810312252, "focus": 0.6981989720559999, "befor": 0.0956377718795, "retriev": 0.773925020223, "tend": 2.43194048924, "artifici": 2.11822899018, "corrupt": 1.8537313701, "crossvalid": 29.479914883640003, "for": 0.0022049327677790003, "then": 0.24910159569269996, "group": 0.381189069594, "won": 1.6808278158, "can": 1.4610698675459999, "comput": 1.36806891594, "harmon": 3.0043355654900004, "set": 0.171496011289, "way": 0.39618301987000004, "proper": 1.2056118389200001, "onli": 0.0759728049873, "each": 0.173741689304, "scalabl": 5.22991255741, "skew": 4.26988643203, "rare": 14.039497136420001, "master": 2.29559871398, "this": 0.03029159242, "rick": 5.23450194112, "pursu": 2.8480693782, "common": 0.338325805271, "big": 2.01597127114, "while": 0.04324998379380001, "data": 25.5532322808, "note": 0.353817568083, "fals": 1.8271477773099998, "handson": 7.369978720910001, "perfect": 1.50096433356, "rather": 0.885429951078, "machin": 1.39235958062, "into": 0.0298257264574, "relev": 3.8742609227999996, "might": 1.5366821530680002, "advertis": 1.7248852425999999, "sergey": 4.44681714019, "abov": 0.643865229816, "scan": 2.93441131931, "constant": 1.2971646281, "quantiti": 3.9572529767800004, "where": 0.0649921387457, "altern": 0.760359972282, "import": 0.292818277066, "coeffici": 3.5972177828099996, "obsolet": 2.88359207091, "busi": 3.602380851775, "propos": 0.6882461339920001, "generat": 2.1575470252080002, "overfit": 14.739957441820001, "svms": 7.369978720910001, "help": 0.336207721344, "exclus": 1.22643707092, "when": 0.0411099777168, "chang": 0.166275625058, "often": 0.516280786702, "repetit": 3.0171234635400004, "point": 0.46206471806599997, "forecast": 3.08639215905, "learn": 1.68550412949, "cover": 0.526975319156, "even": 0.152388564834, "user": 2.04258810688, "own": 0.164195077421}, "logidf": {"after": 0.020490694648099998, "base": 0.13652330228700002, "natur": 0.431306339292, "deal": 0.780914701253, "fact": 0.5502899207949999, "awar": 1.45323772, "easiest": 4.17130560336, "too": 0.5965551547219999, "occur": 0.556973778473, "noteworthi": 3.295836866, "aspir": 2.41485613674, "veri": 0.230159793238, "new": 0.0177299468511, "insuffici": 2.3898026343, "medoid": 7.369978720910001, "apart": 1.1324356512, "what": 0.225887296827, "sridhnumgnumo": 7.369978720910001, "much": 0.17749572930100002, "experi": 0.626272953933, "evalu": 1.9388802431299998, "than": 0.0322608622182, "care": 0.9139943029109999, "dataset": 5.26584456664, "intrus": 3.5369989228199996, "function": 0.914465741594, "class": 0.7497721899330001, "which": 0.00517841384543, "mind": 1.2786688388299998, "have": 0.0147850023412, "python": 4.03065674296, "just": 0.289531434109, "kfold": 7.369978720910001, "test": 0.977224437103, "well": 0.0635144383156, "done": 0.845975983129, "market": 0.8612095839370001, "previous": 0.356602960063, "she": 0.7701082216959999, "approach": 0.7302336145810001, "valuabl": 2.010566255, "underrepres": 5.24174701506, "suffici": 1.4613524521099999, "classifi": 1.6665296351499999, "would": 0.0796176279647, "random": 1.9727214065099998, "check": 1.87281049562, "finetun": 7.369978720910001, "size": 0.9138372060609999, "bid": 2.1512458337, "recommend": 1.36461126863, "oversampl": 7.369978720910001, "equal": 0.933027391343, "ensembl": 2.81820931165, "measur": 0.880014199726, "instead": 0.46663315041500003, "model": 0.7374500731110001, "run": 0.442714975539, "how": 0.47156695693000006, "sale": 1.23181979465, "criteria": 2.4632235573, "trueposit": 7.369978720910001, "arxivorgpdfnumpdf": 7.369978720910001, "chunk": 4.394449154669999, "favour": 1.5206539409600002, "simpl": 1.2232212893899999, "keep": 0.7141523446729999, "resampl": 7.369978720910001, "increas": 0.277820718929, "domain": 2.24008000599, "marketrul": 7.369978720910001, "distribut": 1.00781305813, "sure": 2.0086865552, "correl": 2.57915918803, "interest": 0.47207177798199995, "play": 0.38110439064199997, "mani": 0.0433157581221, "will": 0.202786534915, "introduct": 1.02276465794, "over": 0.0249367214957, "event": 0.428982108147, "predict": 1.6457402376899999, "build": 0.491137452091, "creativ": 1.87527254036, "realtim": 6.0616459012599995, "provid": 0.19517784432500002, "select": 0.704804687133, "undersampl": 7.369978720910001, "but": 0.0161923720719, "success": 0.27765441259199997, "unbalanc": 4.64212589251, "need": 0.362740163442, "our": 0.8576392141820001, "classif": 2.08779073629, "cost": 0.84129007618, "final": 0.292733863948, "inform": 0.454453704662, "past": 0.7016234157610001, "eleg": 3.0405620365099995, "num": 0.00031499039539700004, "applic": 1.23160392849, "same": 0.112059649604, "kept": 1.0795213101999999, "best": 0.459227932947, "exampl": 0.40868267499899996, "fraud": 2.8014725192900003, "has": 0.0427239448548, "given": 0.303255810831, "illustr": 1.2978562707799999, "specif": 0.626980167541, "again": 0.411340231612, "advantag": 1.20120515883, "inappropri": 3.0726933146900004, "follow": 0.045356911094199995, "suggest": 0.563702610877, "famous": 0.825060187979, "further": 0.308815895297, "synthet": 3.0618677691900005, "out": 0.0584263909193, "bootstrap": 5.57821925168, "good": 0.418589404907, "alway": 0.726319204572, "basic": 1.00436774895, "regress": 3.9359915164199997, "possibl": 0.348805474891, "number": 0.0966085784186, "reduc": 0.686617775143, "fix": 1.48944573451, "reli": 1.42586787018, "absolut": 1.67658333914, "also": 0.0146571578, "address": 1.05137103247, "start": 0.236443369291, "tri": 0.61759152916, "train": 0.660918312839, "mean": 0.37092128352, "not": 0.0155524130075, "seven": 0.662383156851, "accuraci": 2.5464765406, "method": 0.944461608841, "compon": 1.40974687623, "minor": 0.802322246604, "radewagen": 7.369978720910001, "the": 0.0, "area": 0.327954821122, "wrong": 1.70078769102, "becom": 0.11771217648900001, "less": 0.3846144626, "contrari": 2.08474659391, "logist": 2.6461370052, "happen": 1.08640441802, "scientist": 1.54634128444, "easi": 1.6665296351499999, "bank": 1.0557062993700002, "score": 1.4559353207700003, "metric": 3.1016808515599994, "handl": 1.36683266903, "want": 0.6916366062549999, "problem": 0.569140724273, "danger": 1.22966322707, "sinc": 0.0803681994577, "design": 0.377239118022, "anoth": 0.127896361652, "outofthebox": 7.369978720910001, "howev": 0.0903151173475, "penal": 3.3446270301700003, "techniqu": 1.31624384807, "wwwquoracominclassificationhowdoyouhandleanunbalancedtrainingsetanswersnum": 7.369978720910001, "scienc": 0.841436178891, "card": 1.8601856079099999, "imbalanc": 6.340359303730001, "imbal": 3.7115584742800003, "fraudster": 6.45368798903, "suit": 1.36831634882, "realtimebid": 7.369978720910001, "node": 3.7920308275, "featur": 0.423387418142, "such": 0.059695977806, "rid": 3.17127414336, "tweak": 4.73092139129, "practic": 0.533182530867, "ndiffer": 7.369978720910001, "alreadi": 0.670478380747, "influenc": 0.572373185428, "other": 0.00987474791976, "appli": 0.8316941898119999, "itself": 0.5570837229510001, "algorithm": 3.33044239518, "one": 0.0062553516455, "graph": 3.6299309802199997, "abund": 2.25799093255, "precisionspecif": 7.369978720910001, "weight": 1.58492352612, "should": 0.509419876758, "observ": 0.7995160149320001, "becaus": 0.139343158825, "horizont": 2.4521899771799998, "worth": 1.65065103492, "get": 0.579769005782, "centr": 1.08883409869, "like": 0.139053576545, "implement": 1.27437940907, "lot": 1.4835969502500002, "right": 0.34035985417, "imagin": 1.88684291737, "detect": 1.68878274493, "result": 0.136378908381, "analyt": 2.8481901438599997, "that": 0.00397614837964, "bag": 2.76380903459, "varieti": 0.8316941898119999, "precis": 1.67187902939, "xgboost": 7.369978720910001, "repeat": 1.0567930591299999, "use": 0.0292080197316, "tidi": 5.278114659230001, "introduc": 0.5457137524260001, "click": 3.54788042301, "recal": 1.6688664748100002, "ani": 0.125608358366, "two": 0.0136988443582, "sampl": 1.9786264883900002, "from": 0.000567054168866, "relat": 0.21310030165399999, "account": 0.665074289973, "abnorm": 3.3978017926599997, "work": 0.109034567273, "recallsensit": 7.369978720910001, "differ": 0.212321121312, "instanc": 1.18089357972, "make": 0.07349765782289999, "decis": 0.7701082216959999, "binari": 3.4781584227999995, "most": 0.020747896295599998, "between": 0.033953681165299995, "tree": 1.41777488775, "heavili": 1.17598157639, "server": 3.6394775921, "balanc": 1.4936444810499998, "excel": 1.5778801652, "depend": 0.806969815, "obvious": 1.86383450716, "credit": 1.11288601088, "secret": 1.13556799519, "all": 0.011402632097799998, "quora": 7.369978720910001, "school": 0.494746633632, "with": 0.00119749171339, "strong": 0.49712549393600003, "there": 0.0400978929255, "are": 0.0294674735827, "remark": 1.34847005245, "split": 1.24442043932, "better": 0.6964279406, "case": 0.395406268889, "ratio": 1.97589673238, "sens": 1.04257779501, "background": 1.3931203261899998, "take": 0.130691962197, "network": 0.9530830530519999, "cluster": 2.52579163445, "rate": 0.761033872166, "more": 0.017024931599999998, "and": 6.29901420636e-05, "list": 0.309845761506, "intern": 0.265095377816, "whi": 1.18068843047, "these": 0.0715336194008, "discard": 2.95113811311, "combin": 0.529218310751, "posit": 0.316652318608, "forest": 1.5883097076, "general": 0.114952578063, "focus": 0.6981989720559999, "befor": 0.0956377718795, "retriev": 0.773925020223, "tend": 1.21597024462, "artifici": 2.11822899018, "corrupt": 1.8537313701, "crossvalid": 7.369978720910001, "for": 0.00031499039539700004, "then": 0.08303386523089999, "group": 0.190594534797, "won": 0.8404139079, "can": 0.162341096394, "comput": 1.36806891594, "harmon": 3.0043355654900004, "set": 0.171496011289, "way": 0.19809150993500002, "proper": 1.2056118389200001, "onli": 0.025324268329099998, "each": 0.173741689304, "scalabl": 5.22991255741, "skew": 4.26988643203, "rare": 1.00282122403, "master": 1.14779935699, "this": 0.0037864490525, "rick": 2.61725097056, "pursu": 1.4240346891, "common": 0.338325805271, "big": 1.00798563557, "while": 0.04324998379380001, "data": 1.2168205848, "note": 0.353817568083, "fals": 1.8271477773099998, "handson": 7.369978720910001, "perfect": 1.50096433356, "rather": 0.442714975539, "machin": 1.39235958062, "into": 0.0149128632287, "relev": 1.9371304613999998, "might": 0.7683410765340001, "advertis": 1.7248852425999999, "sergey": 4.44681714019, "abov": 0.643865229816, "scan": 2.93441131931, "constant": 1.2971646281, "quantiti": 1.9786264883900002, "where": 0.0649921387457, "altern": 0.760359972282, "import": 0.292818277066, "coeffici": 3.5972177828099996, "obsolet": 2.88359207091, "busi": 0.720476170355, "propos": 0.6882461339920001, "generat": 0.719182341736, "overfit": 7.369978720910001, "svms": 7.369978720910001, "help": 0.336207721344, "exclus": 1.22643707092, "when": 0.0205549888584, "chang": 0.166275625058, "often": 0.258140393351, "repetit": 3.0171234635400004, "point": 0.23103235903299998, "forecast": 3.08639215905, "learn": 0.842752064745, "cover": 0.526975319156, "even": 0.152388564834, "user": 2.04258810688, "own": 0.164195077421}, "freq": {"after": 1, "base": 1, "natur": 1, "deal": 1, "fact": 1, "awar": 1, "easiest": 1, "too": 1, "occur": 1, "noteworthi": 1, "aspir": 1, "veri": 1, "new": 3, "insuffici": 1, "medoid": 2, "apart": 1, "what": 3, "sridhnumgnumo": 1, "much": 1, "experi": 1, "evalu": 5, "than": 3, "care": 1, "dataset": 10, "intrus": 1, "function": 2, "class": 23, "which": 2, "mind": 1, "have": 6, "python": 2, "just": 4, "kfold": 1, "test": 1, "well": 2, "done": 1, "market": 2, "previous": 2, "she": 1, "approach": 7, "valuabl": 1, "underrepres": 1, "suffici": 1, "classifi": 3, "would": 1, "random": 7, "check": 1, "finetun": 1, "size": 2, "bid": 1, "recommend": 1, "oversampl": 8, "equal": 1, "ensembl": 5, "measur": 1, "instead": 2, "model": 24, "run": 1, "how": 3, "sale": 1, "criteria": 1, "trueposit": 1, "arxivorgpdfnumpdf": 1, "chunk": 1, "favour": 1, "simpl": 1, "keep": 4, "resampl": 7, "increas": 1, "domain": 2, "marketrul": 1, "distribut": 1, "sure": 1, "correl": 1, "interest": 1, "play": 1, "mani": 4, "will": 1, "introduct": 1, "over": 2, "event": 1, "predict": 1, "build": 1, "creativ": 1, "realtim": 1, "provid": 1, "select": 4, "undersampl": 4, "but": 6, "success": 2, "unbalanc": 1, "need": 1, "our": 2, "classif": 4, "cost": 1, "final": 1, "inform": 1, "past": 1, "eleg": 1, "num": 26, "applic": 1, "same": 2, "kept": 1, "best": 4, "exampl": 1, "fraud": 2, "has": 2, "given": 1, "illustr": 1, "specif": 1, "again": 1, "advantag": 1, "inappropri": 1, "follow": 1, "suggest": 1, "famous": 1, "further": 1, "synthet": 1, "out": 1, "bootstrap": 3, "good": 2, "alway": 1, "basic": 1, "regress": 1, "possibl": 1, "number": 2, "reduc": 1, "fix": 1, "reli": 1, "absolut": 1, "also": 4, "address": 1, "start": 2, "tri": 4, "train": 10, "mean": 1, "not": 4, "seven": 1, "accuraci": 2, "method": 5, "compon": 1, "minor": 1, "radewagen": 2, "the": 70, "area": 1, "wrong": 3, "becom": 1, "less": 1, "contrari": 1, "logist": 1, "happen": 1, "scientist": 1, "easi": 2, "bank": 1, "score": 1, "metric": 3, "handl": 2, "want": 1, "problem": 4, "danger": 1, "sinc": 1, "design": 3, "anoth": 2, "outofthebox": 1, "howev": 1, "penal": 2, "techniqu": 4, "wwwquoracominclassificationhowdoyouhandleanunbalancedtrainingsetanswersnum": 1, "scienc": 1, "card": 1, "imbalanc": 8, "imbal": 1, "fraudster": 1, "suit": 2, "realtimebid": 1, "node": 1, "featur": 1, "such": 1, "rid": 1, "tweak": 1, "practic": 1, "ndiffer": 1, "alreadi": 1, "influenc": 1, "other": 1, "appli": 6, "itself": 1, "algorithm": 1, "one": 7, "graph": 1, "abund": 10, "precisionspecif": 1, "weight": 1, "should": 3, "observ": 2, "becaus": 1, "horizont": 1, "worth": 1, "get": 3, "centr": 1, "like": 2, "implement": 1, "lot": 1, "right": 2, "imagin": 1, "detect": 4, "result": 1, "analyt": 2, "that": 16, "bag": 1, "varieti": 1, "precis": 1, "xgboost": 1, "repeat": 1, "use": 16, "tidi": 1, "introduc": 1, "click": 1, "recal": 1, "ani": 1, "two": 2, "sampl": 12, "from": 2, "relat": 2, "account": 1, "abnorm": 1, "work": 3, "recallsensit": 1, "differ": 9, "instanc": 2, "make": 4, "decis": 1, "binari": 1, "most": 1, "between": 3, "tree": 1, "heavili": 1, "server": 1, "balanc": 4, "excel": 1, "depend": 3, "obvious": 1, "credit": 1, "secret": 1, "all": 6, "quora": 1, "school": 3, "with": 9, "strong": 1, "there": 4, "are": 10, "remark": 1, "split": 1, "better": 1, "case": 6, "ratio": 7, "sens": 1, "background": 2, "take": 2, "network": 2, "cluster": 4, "rate": 2, "more": 2, "and": 24, "list": 1, "intern": 1, "whi": 1, "these": 2, "discard": 1, "combin": 2, "posit": 1, "forest": 2, "general": 4, "focus": 1, "befor": 1, "retriev": 1, "tend": 2, "artifici": 1, "corrupt": 1, "crossvalid": 4, "for": 7, "then": 3, "group": 2, "won": 2, "can": 9, "comput": 1, "harmon": 1, "set": 1, "way": 2, "proper": 1, "onli": 3, "each": 1, "scalabl": 1, "skew": 1, "rare": 14, "master": 2, "this": 8, "rick": 2, "pursu": 2, "common": 1, "big": 2, "while": 1, "data": 21, "note": 1, "fals": 1, "handson": 1, "perfect": 1, "rather": 2, "machin": 1, "into": 2, "relev": 2, "might": 2, "advertis": 1, "sergey": 1, "abov": 1, "scan": 1, "constant": 1, "quantiti": 2, "where": 1, "altern": 1, "import": 1, "coeffici": 1, "obsolet": 1, "busi": 5, "propos": 1, "generat": 3, "overfit": 2, "svms": 1, "help": 1, "exclus": 1, "when": 2, "chang": 1, "often": 2, "repetit": 1, "point": 2, "forecast": 1, "learn": 2, "cover": 1, "even": 1, "user": 1, "own": 1}, "idf": {"after": 1.02070207021, "base": 1.14628158845, "natur": 1.5392670157100001, "deal": 2.18346857379, "fact": 1.73375559681, "awar": 4.27693965517, "easiest": 64.8, "too": 1.81585268215, "occur": 1.7453825857499998, "noteworthi": 27.0, "aspir": 11.1881606765, "veri": 1.25880114177, "new": 1.0178880554, "insuffici": 10.911340206199998, "medoid": 1587.6, "apart": 3.1032056294, "what": 1.25343439128, "sridhnumgnumo": 1587.6, "much": 1.1942229577299999, "experi": 1.87062566278, "evalu": 6.9509632224199995, "than": 1.03278688525, "care": 2.49426551453, "dataset": 193.609756098, "intrus": 34.3636363636, "function": 2.495441685, "class": 2.11651779763, "which": 1.005191845, "mind": 3.5918552036199998, "have": 1.0148948411399998, "python": 56.2978723404, "just": 1.33580143037, "kfold": 1587.6, "test": 2.65707112971, "well": 1.0655748708, "done": 2.3302509907499998, "market": 2.36602086438, "previous": 1.42846859816, "she": 2.16, "approach": 2.07556543339, "valuabl": 7.46754468485, "underrepres": 189.0, "suffici": 4.3117870722400005, "classifi": 5.2937645882, "would": 1.0828729281799998, "random": 7.1902173913, "check": 6.50655737705, "finetun": 1587.6, "size": 2.49387370405, "bid": 8.595560368160001, "recommend": 3.9142011834300003, "oversampl": 1587.6, "equal": 2.542193755, "ensembl": 16.746835443, "measur": 2.41093394077, "instead": 1.59461631177, "model": 2.0905978404, "run": 1.55692850838, "how": 1.60250328051, "sale": 3.4274611399, "criteria": 11.7426035503, "trueposit": 1587.6, "arxivorgpdfnumpdf": 1587.6, "chunk": 81.0, "favour": 4.57521613833, "simpl": 3.3981164383599998, "keep": 2.04245465071, "resampl": 1587.6, "increas": 1.32024948025, "domain": 9.39408284024, "marketrul": 1587.6, "distribut": 2.7396031061299997, "sure": 7.453521126760001, "correl": 13.1860465116, "interest": 1.60331246213, "play": 1.46390041494, "mani": 1.04426757877, "will": 1.22481098596, "introduct": 2.7808723068799996, "over": 1.02525024217, "event": 1.5356935577500002, "predict": 5.18484650555, "build": 1.6341739578, "creativ": 6.52259654889, "realtim": 429.081081081, "provid": 1.21552714187, "select": 2.02345144022, "undersampl": 1587.6, "but": 1.01632417899, "success": 1.32002993265, "unbalanc": 103.764705882, "need": 1.4372623574099999, "our": 2.35758835759, "classif": 8.067073170730001, "cost": 2.31935719503, "final": 1.34008609775, "inform": 1.5753125620200001, "past": 2.01702452039, "eleg": 20.9169960474, "num": 1.00031504001, "applic": 3.42672134686, "same": 1.11857958148, "kept": 2.94327030033, "best": 1.5828514456600002, "exampl": 1.50483412322, "fraud": 16.468879668, "has": 1.0436497502, "given": 1.35426085473, "illustr": 3.6614391143900002, "specif": 1.8719490626099997, "again": 1.50883862384, "advantag": 3.32412060302, "inappropri": 21.6, "follow": 1.04640126549, "suggest": 1.7571665744299998, "famous": 2.28201811125, "further": 1.3618116315, "synthet": 21.3674293405, "out": 1.06016694491, "bootstrap": 264.6, "good": 1.51981619759, "alway": 2.06745670009, "basic": 2.7301805675, "regress": 51.2129032258, "possibl": 1.4173734488, "number": 1.10142916609, "reduc": 1.98698372966, "fix": 4.4346368715099995, "reli": 4.16146788991, "absolut": 5.3472549680000006, "also": 1.01476510067, "address": 2.86157173756, "start": 1.26673581744, "tri": 1.8544562551099997, "train": 1.9365698950999999, "mean": 1.44906900329, "not": 1.01567398119, "seven": 1.93940874664, "accuraci": 12.7620578778, "method": 2.5714285714300003, "compon": 4.09491875161, "minor": 2.23071518898, "radewagen": 1587.6, "the": 1.0, "area": 1.3881262568900001, "wrong": 5.478260869570001, "becom": 1.12492028626, "less": 1.46904783936, "contrari": 8.042553191489999, "logist": 14.0994671403, "happen": 2.96359902931, "scientist": 4.69426374926, "easi": 5.2937645882, "bank": 2.87400434468, "score": 4.2884927066500005, "metric": 22.235294117600002, "handl": 3.9229058561900003, "want": 1.99698113208, "problem": 1.76674827509, "danger": 3.42007755278, "sinc": 1.08368600683, "design": 1.45825296225, "anoth": 1.13643521832, "outofthebox": 1587.6, "howev": 1.0945191313299998, "penal": 28.35, "techniqu": 3.7293868921800004, "wwwquoracominclassificationhowdoyouhandleanunbalancedtrainingsetanswersnum": 1587.6, "scienc": 2.31969608416, "card": 6.42492917847, "imbalanc": 567.0, "imbal": 40.917525773200005, "fraudster": 635.04, "suit": 3.92873051225, "realtimebid": 1587.6, "node": 44.3463687151, "featur": 1.52712581762, "such": 1.06151377374, "rid": 23.837837837800002, "tweak": 113.4, "practic": 1.70434782609, "ndiffer": 1587.6, "alreadi": 1.9551724137900002, "influenc": 1.77246846042, "other": 1.00992366412, "appli": 2.2972073506, "itself": 1.74557449148, "algorithm": 27.9507042254, "one": 1.00627495722, "graph": 37.7102137767, "abund": 9.563855421689999, "precisionspecif": 1587.6, "weight": 4.878918254459999, "should": 1.6643254009900001, "observ": 2.22446406053, "becaus": 1.1495184997499999, "horizont": 11.6137527432, "worth": 5.210370856580001, "get": 1.78562591385, "centr": 2.97080838323, "like": 1.14918566775, "implement": 3.57648118946, "lot": 4.40877534018, "right": 1.4054532577899999, "imagin": 6.598503740650001, "detect": 5.41288782816, "result": 1.14611608432, "analyt": 17.256521739100002, "that": 1.00398406375, "bag": 15.8601398601, "varieti": 2.2972073506, "precis": 5.322158900440001, "xgboost": 1587.6, "repeat": 2.8771293947099994, "use": 1.0296387573799999, "tidi": 196.0, "introduc": 1.7258397651900002, "click": 34.7396061269, "recal": 5.30614973262, "ani": 1.13383802314, "two": 1.01379310345, "sampl": 7.23280182232, "from": 1.00056721497, "relat": 1.23750876919, "account": 1.94463498285, "abnorm": 29.8983050847, "work": 1.11520089913, "recallsensit": 1587.6, "differ": 1.23654490225, "instanc": 3.2572835453400004, "make": 1.0762660158600001, "decis": 2.16, "binari": 32.4, "most": 1.02096463023, "between": 1.03453668708, "tree": 4.127925117, "heavili": 3.24132298898, "server": 38.071942446, "balanc": 4.45329593268, "excel": 4.84467500763, "depend": 2.2411067193700003, "obvious": 6.44841592201, "credit": 3.04312823462, "secret": 3.11294117647, "all": 1.01146788991, "quora": 1587.6, "school": 1.64008264463, "with": 1.0011982089899998, "strong": 1.6439888163999998, "there": 1.04091266719, "are": 1.02990593578, "remark": 3.8515283842800003, "split": 3.4709226060300002, "better": 2.0065722952500002, "case": 1.48498737256, "ratio": 7.21308496138, "sens": 2.8365195640499996, "background": 4.02739726027, "take": 1.13961668222, "network": 2.59369384088, "cluster": 12.5007874016, "rate": 2.14048806795, "more": 1.0171706817, "and": 1.00006299213, "list": 1.36321483771, "intern": 1.30355530011, "whi": 3.2566153846200003, "these": 1.07415426252, "discard": 19.1277108434, "combin": 1.69760479042, "posit": 1.37252528746, "forest": 4.89546716004, "general": 1.1218202374200001, "focus": 2.01012914662, "befor": 1.10036041031, "retriev": 2.16826003824, "tend": 3.3735656608599998, "artifici": 8.31639601886, "corrupt": 6.3835946924, "crossvalid": 1587.6, "for": 1.00031504001, "then": 1.08657860516, "group": 1.20996875238, "won": 2.31732593782, "can": 1.17626139142, "comput": 3.9277585353800006, "harmon": 20.172808132100002, "set": 1.18707940781, "way": 1.2190739461, "proper": 3.3388012618299996, "onli": 1.0256476516600002, "each": 1.18974820144, "scalabl": 186.776470588, "skew": 71.5135135135, "rare": 2.7259615384599996, "master": 3.15125049623, "this": 1.00379362671, "rick": 13.6980155306, "pursu": 4.15384615385, "common": 1.4025974025999999, "big": 2.7400759406299997, "while": 1.0441988950299999, "data": 3.37643555934, "note": 1.42449528937, "fals": 6.21613155834, "handson": 1587.6, "perfect": 4.48601299802, "rather": 1.55692850838, "machin": 4.02433460076, "into": 1.01502461479, "relev": 6.938811188810001, "might": 2.1561863370900003, "advertis": 5.61187698834, "sergey": 85.3548387097, "abov": 1.90382539873, "scan": 18.8104265403, "constant": 3.6589075823900004, "quantiti": 7.23280182232, "where": 1.06715063521, "altern": 2.1390460792200003, "import": 1.3401992233700002, "coeffici": 36.4965517241, "obsolet": 17.8783783784, "busi": 2.05541170378, "propos": 1.9902218879299998, "generat": 2.05275407292, "overfit": 1587.6, "svms": 1587.6, "help": 1.39962972759, "exclus": 3.40906162766, "when": 1.02076769755, "chang": 1.1808985421, "often": 1.29452054795, "repetit": 20.4324324324, "point": 1.25990000794, "forecast": 21.897931034499997, "learn": 2.32275054865, "cover": 1.69380134429, "even": 1.16461267606, "user": 7.71053909665, "own": 1.17844418052}}, "html": "<!DOCTYPE html>\n\n<html lang=\"en-US\" xmlns=\"http://www.w3.org/1999/xhtml\">\n<head profile=\"http://gmpg.org/xfn/11\">\n<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/>\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\"/>\n<title>  7 Techniques to Handle Imbalanced Data</title>\n<link href=\"/wp-content/themes/kdn17/images/favicon.ico\" rel=\"shortcut icon\"/>\n<link href=\"/wp-content/themes/kdn17/style.css\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\"/>\n<script src=\"/wp-content/themes/kdn17/js/jquery-1.9.1.min.js\" type=\"text/javascript\"></script>\n<script src=\"/aps/kda_all.js\" type=\"text/javascript\"></script>\n<link href=\"/feed/\" rel=\"alternate\" title=\"KDnuggets: Analytics, Big Data, Data Mining and Data Science Feed\" type=\"application/rss+xml\"/>\n<link href=\"//s.w.org\" rel=\"dns-prefetch\"/>\n<link href=\"https://www.kdnuggets.com/feed\" rel=\"alternate\" title=\"KDnuggets \u00bb Feed\" type=\"application/rss+xml\"/>\n<link href=\"https://www.kdnuggets.com/comments/feed\" rel=\"alternate\" title=\"KDnuggets \u00bb Comments Feed\" type=\"application/rss+xml\"/>\n<link href=\"https://www.kdnuggets.com/2017/06/7-techniques-handle-imbalanced-data.html/feed\" rel=\"alternate\" title=\"KDnuggets \u00bb 7 Techniques to Handle Imbalanced Data Comments Feed\" type=\"application/rss+xml\"/>\n<link href=\"https://www.kdnuggets.com/wp-json/\" rel=\"https://api.w.org/\"/>\n<link href=\"https://www.kdnuggets.com/xmlrpc.php?rsd\" rel=\"EditURI\" title=\"RSD\" type=\"application/rsd+xml\"/>\n<link href=\"https://www.kdnuggets.com/wp-includes/wlwmanifest.xml\" rel=\"wlwmanifest\" type=\"application/wlwmanifest+xml\"/>\n<link href=\"https://www.kdnuggets.com/2017/05/top-tweets-may24-30.html\" rel=\"prev\" title=\"Top KDnuggets tweets, May 24-30: #DataScience for Beginners; 10 Free Must-Read Books for #MachineLearning and #DataScience\"/>\n<link href=\"https://www.kdnuggets.com/2017/06/kaspersky-artificial-intelligence-bubble-future-cybersecurity.html\" rel=\"next\" title=\"The Artificial \u2018Artificial Intelligence\u2019 Bubble and the Future of Cybersecurity\"/>\n<meta content=\"WordPress 4.9.10\" name=\"generator\">\n<link href=\"https://www.kdnuggets.com/2017/06/7-techniques-handle-imbalanced-data.html\" rel=\"canonical\"/>\n<link href=\"https://www.kdnuggets.com/?p=67343\" rel=\"shortlink\"/>\n<link href=\"https://www.kdnuggets.com/2017/06/7-techniques-handle-imbalanced-data.html\" rel=\"canonical\"/>\n<!-- BEGIN ExactMetrics v5.3.7 Universal Analytics - https://exactmetrics.com/ -->\n<script>\n(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n\t(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n\tm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');\n  ga('create', 'UA-361129-1', 'auto');\n  ga('send', 'pageview');\n</script>\n<!-- END ExactMetrics Universal Analytics -->\n</meta></head>\n<body class=\"post-template-default single single-post postid-67343 single-format-standard\">\n<div class=\"main_wrapper\"><!-- publ: 1-Jun, 2017  -->\n<div id=\"wrapper\">\n<div id=\"header\">\n<div id=\"header_log\">\n<div class=\"logo\">\n<a href=\"/\"></a>\n</div>\n<h1>KDnuggets</h1>\n<div class=\"text-container\">\n            \u00a0\u00a0<a href=\"/news/subscribe.html\" target=\"_blank\"><b>Subscribe to KDnuggets News</b></a> \u00a0|\n <a href=\"https://twitter.com/kdnuggets\" target=\"_blank\"><img alt=\"Twitter\" height=\"48\" src=\"/images/tw_c48.png\" style=\"vertical-align: bottom\" width=\"48\"/></a> \u00a0\u00a0\n <a href=\"https://www.facebook.com/kdnuggets\" target=\"_blank\"><img alt=\"Facebook\" height=\"48\" src=\"/images/fb_c48.png\" style=\"vertical-align: bottom\" width=\"48\"/></a> \u00a0\u00a0\n<a href=\"https://www.linkedin.com/groups/54257/\" target=\"_blank\"><img alt=\"LinkedIn\" height=\"48\" src=\"/images/in_c48.png\" style=\"vertical-align: bottom\" width=\"48\"/></a> \n\u00a0|\u00a0 <a href=\"/contact.html\"><b>Contact</b></a>\n</div>\n</div>\n<div class=\"search\">\n<form action=\"/\" id=\"searchform\" method=\"get\">\n<input id=\"s\" name=\"s\" placeholder=\"search KDnuggets\" type=\"text\" value=\"\"/>\n<input type=\"submit\" value=\"Search\"/></form>\n</div>\n<div href=\"#\" id=\"pull\">\n<img class=\"menu\" src=\"/images/menu-30.png\">\n<div class=\"logo\">\n<a href=\"/\"></a>\n</div>\n<img class=\"search-icon\" src=\"/images/search-icon.png\">\n</img></img></div>\n<div id=\"pull-menu\">\n<div class=\"navigation\"><ul class=\"menu\" id=\"menu-menu\"><li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-1070\" id=\"menu-item-1070\"><a href=\"/software/index.html\" title=\"Data Science Software\">SOFTWARE</a></li>\n<li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-13756\" id=\"menu-item-13756\"><a href=\"/news/index.html\" title=\"News\">News/Blog</a></li>\n<li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-46286\" id=\"menu-item-46286\"><a href=\"/news/top-stories.html\">Top stories</a></li>\n<li class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-42152\" id=\"menu-item-42152\"><a href=\"https://www.kdnuggets.com/opinions/index.html\" title=\"Opinions\">Opinions</a></li>\n<li class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-46415\" id=\"menu-item-46415\"><a href=\"https://www.kdnuggets.com/tutorials/index.html\">Tutorials</a></li>\n<li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-13364\" id=\"menu-item-13364\"><a href=\"/jobs/index.html\" title=\"Jobs in Analytics, Data Science\">JOBS</a></li>\n<li class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-63505\" id=\"menu-item-63505\"><a href=\"https://www.kdnuggets.com/companies/index.html\">Companies</a></li>\n<li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-13366\" id=\"menu-item-13366\"><a href=\"/courses/index.html\">Courses</a></li>\n<li class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-1499\" id=\"menu-item-1499\"><a href=\"https://www.kdnuggets.com/datasets/index.html\">Datasets</a></li>\n<li class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-14286\" id=\"menu-item-14286\"><a href=\"https://www.kdnuggets.com/education/index.html\" title=\"Education in Analytics, Big Data, Data Science\">EDUCATION</a></li>\n<li class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-51558\" id=\"menu-item-51558\"><a href=\"https://www.kdnuggets.com/education/analytics-data-mining-certificates.html\" title=\"Certificates in Analytics, Big Data, Data Science\">Certificates</a></li>\n<li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-14752\" id=\"menu-item-14752\"><a href=\"/meetings/index.html\">Meetings</a></li>\n<li class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-13721\" id=\"menu-item-13721\"><a href=\"/webcasts/index.html\" title=\"Webcasts and Webinars\">Webinars</a></li>\n</ul></div></div>\n</div> <!--#header end-->\n<div id=\"spacer\">\n         \u00a0\n      </div>\n<div id=\"content_wrapper\">\n<div id=\"ad_wrapper\">\n<script type=\"text/javascript\">\n\tjQuery(function() {\n   \t    var pull        = $('#pull');\n            menu        = $('#header .navigation ul');\n            menuImage = $('#header img.menu');\n            mobileMenu        = $('#pull-menu-mobile');\n            search = $('img.search-icon');\n            searchBar = $('div.search');\n            searchClick = false;\n            search.on('click', function() {\n                  searchBar.slideToggle();\n                  searchClick = true;\n            });  \n     \t    $(menuImage).on('click', function(e) {\n\t        //e.preventDefault();\n                if (!searchClick) {\n                  menu.slideToggle();\n                }\n                searchClick = false;\n\t    });\n           /* pullMobile.on('click', function(e) {\n              e.preventDefault();\n                if (!searchClick) {\n                  mobileMenu.slideToggle();\n                }\n                searchClick = false;\n\t    });*/\n            \n\t});\n\tkpath = '/'; kda_top(); kda_sid_init(); kda_sid_n=3;\n\t</script>\n</div> <div class=\"breadcumb\">\n<br/>\n<a href=\"/\">KDnuggets Home</a> \u00bb <a href=\"/news/index.html\">News</a> \u00bb <a href=\"/2017/index.html\">2017</a> \u00bb <a href=\"https://www.kdnuggets.com/2017/06/index.html\">Jun</a> \u00bb <a href=\"https://www.kdnuggets.com/2017/06/tutorials.html\">Tutorials, Overviews</a> \u00bb 7 Techniques to Handle Imbalanced Data (\u00a0<a href=\"/2017/n22.html\">17:n22</a>\u00a0)    </div>\n<div class=\"single\" id=\"content\">\n<div id=\"post-header\">\n<h1 id=\"title\"><img align=\"right\" alt=\"Silver Blog, Jun 2017\" src=\"/images/top-kdnuggets-blog-2017-jun-silver.png\" width=\"80\"/>7 Techniques to Handle Imbalanced Data</h1>\n<div class=\"pagi\">\n<div class=\"pagi-left\">\n<a href=\"https://www.kdnuggets.com/2017/05/top-tweets-may24-30.html\" rel=\"prev\"><img height=\"10\" src=\"/images/prv.gif\" width=\"8\"> <strong>Previous post</strong></img></a></div>\n<div class=\"pagi-right\">\n<a href=\"https://www.kdnuggets.com/2017/06/kaspersky-artificial-intelligence-bubble-future-cybersecurity.html\" rel=\"next\"><strong>Next post</strong> <img height=\"10\" src=\"/images/nxt.gif\" width=\"8\"/></a></div>\n<br/>\u00a0<br/>\u00a0\n    <span class=\"http-likes\" style=\"float: left; font-size:14px\">http likes 368</span> <div class=\"addthis_native_toolbox\"></div>\n</div>\n<div class=\"tag-data\">Tags: <a href=\"https://www.kdnuggets.com/tag/balancing-classes\" rel=\"tag\">Balancing Classes</a>, <a href=\"https://www.kdnuggets.com/tag/data-preparation\" rel=\"tag\">Data Preparation</a>, <a href=\"https://www.kdnuggets.com/tag/data-science\" rel=\"tag\">Data Science</a>, <a href=\"https://www.kdnuggets.com/tag/unbalanced\" rel=\"tag\">Unbalanced</a></div>\n<br/>\n<p class=\"excerpt\">\n     This blog post introduces seven techniques that are commonly applied in domains like intrusion detection or real-time bidding, because the datasets are often extremely imbalanced. \n  </p>\n</div>\n<div id=\"post-header-ad\">\n<script type=\"text/javascript\">kda_sid_write(1); kda_sid_n=2;</script>\n</div>\n<hr class=\"grey-line\"/><br/>\n<div class=\"post\" id=\"post-\">\n<p><b>By Ye Wu &amp; Rick Radewagen, IE Business School.</b></p>\n<h3>Introduction</h3>\n<p>\u00a0<br>\nWhat have datasets in domains like, fraud detection in banking, real-time bidding in marketing\u00a0or intrusion detection in networks, in common?</br></p>\n<p>Data used in these areas often have less than 1% of rare, but \u201cinteresting\u201d events (e.g. fraudsters using credit cards, user clicking advertisement or corrupted server scanning its network). However, most machine learning algorithms do not work very well with imbalanced datasets. The following seven techniques can help you, to train a classifier to detect the abnormal class.</p>\n<p><img alt=\"Imbalanced data image\" class=\"aligncenter\" src=\"/wp-content/uploads/imbalanced-data-1.png\" width=\"85%\"/></p>\n<p>\u00a0</p>\n<h3>1. Use the right evaluation metrics </h3>\n<p>\u00a0<br>\nApplying inappropriate evaluation metrics for model generated using imbalanced data can be dangerous. Imagine our training data is the one illustrated in graph above. If accuracy is used to measure the goodness of a model, a model which classifies all testing samples into \u201c0\u201d will have an excellent accuracy (99.8%), but obviously, this model won\u2019t provide any valuable information for us.</br></p>\n<p>In this case, other alternative evaluation metrics can be applied such as:</p>\n<ul>\n<li>Precision/Specificity: how many selected instances are relevant.\n<li>Recall/Sensitivity: how many relevant instances are selected.\n<li>F1 score: harmonic mean of precision and recall.\n<li>MCC: correlation coefficient between the observed and predicted binary classifications.\n<li>AUC: relation between true-positive rate and false positive rate.\n</li></li></li></li></li></ul>\n<p>\u00a0</p>\n<h3>2. Resample the training set</h3>\n<p>\u00a0<br>\nApart from using different evaluation criteria, one can also work on getting different dataset. Two approaches to make a balanced dataset out of an imbalanced one are under-sampling and over-sampling.</br></p>\n<p><strong>2.1. Under-sampling</strong></p>\n<p>Under-sampling balances the dataset by reducing the size of the abundant class. This method is used when quantity of data is sufficient. By keeping all samples in the rare class and randomly selecting an equal number of samples in the abundant class, a balanced new dataset can be retrieved for further modelling.</p>\n<p><strong>2.2. Over-sampling</strong></p>\n<p>On the contrary, oversampling is used when the quantity of data is insufficient. It tries to balance dataset by increasing the size of rare samples. Rather than getting rid of abundant samples, new rare samples are generated by using e.g. repetition, bootstrapping or SMOTE (Synthetic Minority Over-Sampling Technique) [1].</p>\n<p>Note that there is no absolute advantage of one resampling method over another. Application of these two methods depends on the use case it applies to and the dataset itself. A combination of over- and under-sampling is often successful as well.  </p>\n<p>\u00a0</p>\n<h3>3. Use K-fold Cross-Validation in the right way</h3>\n<p>\u00a0<br>\nIt is noteworthy that cross-validation should be applied properly while using over-sampling method to address imbalance problems.</br></p>\n<p>Keep in mind that over-sampling takes observed rare samples and applies bootstrapping to generate new random data based on a distribution function. If cross-validation is applied after over-sampling, basically what we are doing is overfitting our model to a specific artificial bootstrapping result. That is why cross-validation should always be done before over-sampling the data, just as how feature selection should be implemented. Only by resampling the data repeatedly, randomness can be introduced into the dataset to make sure that there won\u2019t be an overfitting problem. </p>\n<p>\u00a0</p>\n<h3>4. Ensemble different resampled datasets</h3>\n<p>\u00a0<br/>\nThe easiest way to successfully generalize a model is by using more data. The problem is that out-of-the-box classifiers like logistic regression or random forest tend to generalize by discarding\u00a0the rare class. One easy best practice is building n models that use all the samples of the rare class and n-differing samples of the abundant class. Given that you want to ensemble 10 models, you would keep e.g. the 1.000 cases of the rare class and randomly sample 10.000 cases of the abundant class. Then you just split the 10.000 cases in 10 chunks and train 10 different models.</p>\n<p><img alt=\"Imbalanced data image\" class=\"aligncenter\" src=\"/wp-content/uploads/imbalanced-data-2.png\" width=\"85%\"/></p>\n<p>This approach is simple and perfectly horizontally scalable if you have a lot of data, since you can just train and run\u00a0your models on different cluster nodes. Ensemble models also tend to generalize better, which makes this approach easy to handle. </p>\n<p>\u00a0</p>\n<h3>5. Resample with different ratios</h3>\n<p>\u00a0<br/>\nThe previous approach can be fine-tuned by playing with the ratio between the rare and the abundant class. The best ratio \u00a0heavily depends on the data and the models that are used. But instead of training all models with the same ratio in the ensemble, it is worth trying to ensemble different ratios. \u00a0So if 10 models are trained, it might make sense to have a model that has a ratio of 1:1 (rare:abundant) and another one with 1:3, or even 2:1. Depending on the model used this can influence the weight that one class gets.</p>\n<p><img alt=\"Imbalanced data image\" class=\"aligncenter\" src=\"/wp-content/uploads/imbalanced-data-3.png\" width=\"50%\"/></p>\n<p>\u00a0</p>\n<h3>6. Cluster the abundant class</h3>\n<p>\u00a0<br/>\nAn elegant approach was proposed by Sergey on Quora [2]. Instead of relying on random samples to cover the variety of the training samples, he suggests clustering the abundant class in r groups, with r being the number of cases in r. For each group, only the medoid (centre of cluster) is kept. The model is then trained with the rare class and the medoids only. </p>\n<p>\u00a0</p>\n<h3>7. Design your own models</h3>\n<p>\u00a0<br/>\nAll the previous methods focus on the data and keep the models as a fixed component. But in fact, there is no need to resample the data if the model is suited for imbalanced data. The famous XGBoost is already a good starting point if the classes are not skewed too much, because it internally takes care that the bags it trains on are not imbalanced. But then again, the data is resampled, it is just happening secretly. </p>\n<p>By designing a cost function that is penalizing wrong classification of the rare class more than wrong classifications of the abundant class, it is possible to design many models that naturally generalize in favour of the rare class. For example, tweaking an SVM to penalize wrong classifications of the rare class by the same ratio that this class is underrepresented. </p>\n<p><img alt=\"Imbalanced data image\" class=\"aligncenter\" src=\"/wp-content/uploads/imbalanced-data-4.png\" width=\"60%\"/></p>\n<p>\u00a0</p>\n<h3>Final Remarks</h3>\n<p>\u00a0<br/>\nThis is not an exclusive list of techniques, but rather a starting point to handle imbalanced data. There is no best approach or model suited for all problems and it is strongly recommended to try different techniques and models to evaluate what works best. Try to be creative and combine different approaches. It is also important, to be aware that in many domains (e.g. fraud detection, real-time-bidding), where imbalanced classes occur, the \u201cmarket-rules\u201d are constantly changing. So, check if past data might have become obsolete.</p>\n<p>[1] <a href=\"https://arxiv.org/pdf/1106.1813.pdf\" target=\"_blank\">arxiv.org/pdf/1106.1813.pdf</a></p>\n<p>[2] <a href=\"https://www.quora.com/In-classification-how-do-you-handle-an-unbalanced-training-set/answers/1144228?srid=h3G6o\" target=\"_blank\">www.quora.com/In-classification-how-do-you-handle-an-unbalanced-training-set/answers/1144228?srid=h3G6o</a></p>\n<p><a href=\"https://www.linkedin.com/in/ye-wu-424350b6/\" target=\"_blank\"><strong>Ye Wu</strong></a> is pursuing the Master in Business Analytics &amp; Big Data at the IE Business School. She has a background in Accounting and hands-on experience in Marketing and Sales Forecasting. </p>\n<p><a href=\"https://www.linkedin.com/in/rick-radewagen-90864784/\" target=\"_blank\"><strong>Rick Radewagen</strong></a> is an aspiring Data Scientist with a background in Computer Science. He is also pursuing the Master in Business Analytics &amp; Big Data at the IE Business School.</p>\n<p><b>Related:</b></p>\n<ul class=\"three_ul\">\n<li><a href=\"/2016/08/learning-from-imbalanced-classes.html\">Learning from Imbalanced Classes</a>\n<li><a href=\"/2016/04/unbalanced-classes-svm-random-forests-python.html\">Dealing with Unbalanced Classes, SVMs, Random Forests, and Decision Trees in Python</a>\n<li><a href=\"/2017/01/tidying-data-python.html\">Tidying Data in Python</a>\n</li></li></li></ul>\n</div>\n<div class=\"page-link\"></div>\n<div class=\"pagi\">\n<hr class=\"grey-line\"/>\n<div class=\"pagi-left\">\n<a href=\"https://www.kdnuggets.com/2017/05/top-tweets-may24-30.html\" rel=\"prev\"><img height=\"10\" src=\"/images/prv.gif\" width=\"8\"/> <strong>Previous post</strong></a></div>\n<div class=\"pagi-right\">\n<a href=\"https://www.kdnuggets.com/2017/06/kaspersky-artificial-intelligence-bubble-future-cybersecurity.html\" rel=\"next\"><strong>Next post</strong> <img height=\"10\" src=\"/images/nxt.gif\" width=\"8\"/></a></div>\n<br/><br/>\n<div>\n<hr class=\"grey-line\"/><br/>\n<h2>Top Stories Past 30 Days</h2>\n<table align=\"center\" cellpadding=\"3\" cellspacing=\"10\" class=\"latn\" width=\"100%\">\n<tr>\n<td valign=\"top\" width=\"50%\">\n<table cellpadding=\"3\" cellspacing=\"2\">\n<tr><th><b>Most Popular</b></th></tr>\n<tr><td>\n<ol class=\"three_ol\"><li> <a href=\"/2019/04/top-10-coding-mistakes-data-scientists.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-mp-1-mistakes');\"><b>Top 10 Coding Mistakes Made by Data Scientists</b></a>\n<li> <a href=\"/2019/04/recognize-good-data-scientist-job-from-bad.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-mp-2-recognize');\"><b>How to Recognize a Good Data Scientist Job From a Bad One</b></a>\n<li> <a href=\"/2018/05/simplilearn-9-must-have-skills-data-scientist.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-mp-3-simplilearn');\"><b>9 Must-have skills you need to become a Data Scientist, updated</b></a>\n<li> <a href=\"/2019/04/introduction-time-series-forecasting-simple-neural-networks-lstm.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-mp-4-ts-intro');\"><b>An Introduction on Time Series Forecasting with Simple Neural Networks &amp; LSTM</b></a>\n<li> <a href=\"/2019/03/another-10-free-must-read-books-for-machine-learning-and-data-science.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-mp-5-another-10-books');\"><b>Another 10 Free Must-Read Books for Machine Learning and Data Science</b></a>\n<li> <a href=\"/2019/04/data-visualization-python-matplotlib-seaborn.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-mp-6-plt-sea-viz');\"><b>Data Visualization in Python: Matplotlib vs Seaborn</b></a>\n<li> <a href=\"/2019/04/best-data-visualization-techniques.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-mp-7-best-data-viz');\"><b>Best Data Visualization Techniques for small and large data</b></a>\n</li></li></li></li></li></li></li></ol>\n</td></tr>\n</table>\n</td> <td valign=\"top\">\n<table cellpadding=\"3\" cellspacing=\"2\">\n<tr><th><b>Most Shared</b></th></tr>\n<tr><td><ol class=\"three_ol\">\n<li> <a href=\"/2019/04/another-10-free-must-see-courses-machine-learning-data-science.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-ms-1-another-10-courses');\"><b>Another 10 Free Must-See Courses for Machine Learning and Data Science</b></a>\n<li> <a href=\"/2019/04/top-10-coding-mistakes-data-scientists.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-ms-2-mistakes');\"><b>Top 10 Coding Mistakes Made by Data Scientists</b></a>\n<li> <a href=\"/2019/03/r-vs-python-data-visualization.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-ms-3-r-py-viz');\"><b>R vs Python for Data Visualization</b></a>\n<li> <a href=\"/2019/03/deep-learning-toolset-overview.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-ms-4-dl-toolset');\"><b>The Deep Learning Toolset \u2014 An Overview</b></a>\n<li> <a href=\"/2019/04/data-visualization-python-matplotlib-seaborn.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-ms-5-plt-sea-viz');\"><b>Data Visualization in Python: Matplotlib vs Seaborn</b></a>\n<li> <a href=\"/2019/04/introduction-time-series-forecasting-simple-neural-networks-lstm.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-ms-6-ts-intro');\"><b>An Introduction on Time Series Forecasting with Simple Neural Networks &amp; LSTM</b></a>\n<li> <a href=\"/2019/04/recognize-good-data-scientist-job-from-bad.html\" onclick=\"ga('send','pageview','/x/pbc/2019/04-23-ms-7-recognize');\"><b>How to Recognize a Good Data Scientist Job From a Bad One</b></a>\n</li></li></li></li></li></li></li></ol>\n</td></tr>\n</table>\n</td>\n</tr>\n</table>\n</div>\n</div>\n<!--#content end--></div>\n<div id=\"sidebar\">\n<div class=\"latn\">\n<h3><b><a href=\"/news/index.html\">Latest News</a></b></h3>\n<ul style=\"font-size:14px; margin-top:5px\">\n<li> <a href=\"https://www.kdnuggets.com/2019/04/datarobot-delivering-trusted-ai-microsoft.html\">Delivering Trusted AI with DataRobot and Microsoft</a><li> <a href=\"https://www.kdnuggets.com/2019/04/formulated-ai-data-production-landscape.html\">AI and the data production landscape</a><li> <a href=\"https://www.kdnuggets.com/2019/04/most-desired-skill-data-science.html\">The most desired skill in data science</a><li> <a href=\"https://www.kdnuggets.com/2019/04/projects-include-data-science-portfolio.html\">Projects to Include in a Data Science Portfolio</a><li> <a href=\"https://www.kdnuggets.com/2019/04/rework-meet-worlds-leading-ai-deep-learning-experts.html\">Meet the World\u2019s Leading AI &amp; Deep Learning ...</a><li> <a href=\"https://www.kdnuggets.com/2019/04/problem-data-science-job-postings.html\">The problem with data science job postings</a></li></li></li></li></li></li></ul>\n</div>\n<div>\n<script type=\"text/javascript\">kda_sid_write(kda_sid_n);</script>\n</div>\n<br/><script src=\"/aps/sbm.js\" type=\"text/javascript\"></script>\n</div>\n</div><div class=\"breadcrumbs_bottom\">\n<div class=\"breadcumb\">\n<br>\n<a href=\"/\">KDnuggets Home</a> \u00bb <a href=\"/news/index.html\">News</a> \u00bb <a href=\"/2017/index.html\">2017</a> \u00bb <a href=\"https://www.kdnuggets.com/2017/06/index.html\">Jun</a> \u00bb <a href=\"https://www.kdnuggets.com/2017/06/tutorials.html\">Tutorials, Overviews</a> \u00bb 7 Techniques to Handle Imbalanced Data (\u00a0<a href=\"/2017/n22.html\">17:n22</a>\u00a0)    </br></div>\n</div>\n<!--#content_wrapper end--></div>\n<br>\n<div id=\"footer\">\n<br/>\u00a9 2019 KDnuggets. <a href=\"/about/index.html\">About KDnuggets</a>. \u00a0<a href=\"/news/privacy-policy.html\">Privacy policy</a>. <a href=\"/terms-of-service.html\">Terms of Service</a><br/>\u00a0\n<div class=\"kd_bottom\">\n<div class=\"footer-container\">\n<div class=\"footer-news\">\n<a href=\"/news/subscribe.html\" onclick=\"_gaq.push(['_trackPageview','/x/bot/sub']);\" target=\"_blank\"><b>Subscribe to KDnuggets News</b></a>\n</div>\n<div class=\"footer-sm\">\n<a href=\"https://twitter.com/kdnuggets\" onclick=\"_gaq.push(['_trackPageview','/x/bot/twt']);\" target=\"_blank\"><img height=\"32\" src=\"/images/tw_c48.png\" width=\"32\"/></a>\n<a href=\"https://facebook.com/kdnuggets\" onclick=\"_gaq.push(['_trackPageview','/x/bot/fb']);\" target=\"_blank\"><img alt=\"Facebook\" height=\"32\" src=\"/images/fb_c48.png\" width=\"32\"/></a>\n<a href=\"https://www.linkedin.com/groups/54257\" onclick=\"_gaq.push(['_trackPageview','/x/bot/in']);\" target=\"_blank\"><img alt=\"LinkedIn\" height=\"32\" src=\"/images/in_c48.png\" width=\"32\"/></a>\n</div>\n</div>\n<div class=\"close-footer\">X</div>\n</div>\n<script type=\"text/javascript\">\n  jQuery('.close-footer').click(\n      function(){       \n         jQuery('.kd_bottom').hide();\n      }\n   );\n</script> </div>\n<div class=\"clear\"><!--blank--></div>\n</br></div>\n<div style=\"display: none;\"><div id=\"boxzilla-box-82996-content\"><script type=\"text/javascript\">(function() {\n\tif (!window.mc4wp) {\n\t\twindow.mc4wp = {\n\t\t\tlisteners: [],\n\t\t\tforms    : {\n\t\t\t\ton: function (event, callback) {\n\t\t\t\t\twindow.mc4wp.listeners.push({\n\t\t\t\t\t\tevent   : event,\n\t\t\t\t\t\tcallback: callback\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n})();\n</script><!-- MailChimp for WordPress v4.1.14 - https://wordpress.org/plugins/mailchimp-for-wp/ --><form class=\"mc4wp-form mc4wp-form-77281\" data-id=\"77281\" data-name=\"Subscribe to KDnuggets News\" id=\"mc4wp-form-1\" method=\"post\"><div class=\"mc4wp-form-fields\"><div class=\"header-container\">\n<img align=\"left\" src=\"/wp-content/uploads/envelope.png\"><a href=\"/news/subscribe.html\">Get KDnuggets, a leading newsletter on AI, \r\n  Data Science, and Machine Learning</a>\n</img></div>\n<div class=\"form-fields\">\n<div class=\"field-container\"><label>Email:</label><input maxlength=\"60\" name=\"EMAIL\" placeholder=\"Your email\" required=\"\" size=\"30\" type=\"email\"/></div>\n<div class=\"field-container submit-container\"><div class=\"form-button\" onclick=\"document.getElementById('mc4wp-form-1').submit()\">Sign Up</div></div>\n</div>\n<label style=\"display: none !important;\">Leave this field empty if you're human: <input autocomplete=\"off\" name=\"_mc4wp_honeypot\" tabindex=\"-1\" type=\"text\" value=\"\"/></label><input name=\"_mc4wp_timestamp\" type=\"hidden\" value=\"1556327535\"/><input name=\"_mc4wp_form_id\" type=\"hidden\" value=\"77281\"/><input name=\"_mc4wp_form_element_id\" type=\"hidden\" value=\"mc4wp-form-1\"/></div><div class=\"mc4wp-response\"></div></form><!-- / MailChimp for WordPress Plugin -->\n</div></div><script type=\"text/javascript\">(function() {function addEventListener(element,event,handler) {\n\tif(element.addEventListener) {\n\t\telement.addEventListener(event,handler, false);\n\t} else if(element.attachEvent){\n\t\telement.attachEvent('on'+event,handler);\n\t}\n}function maybePrefixUrlField() {\n\tif(this.value.trim() !== '' && this.value.indexOf('http') !== 0) {\n\t\tthis.value = \"http://\" + this.value;\n\t}\n}\n\nvar urlFields = document.querySelectorAll('.mc4wp-form input[type=\"url\"]');\nif( urlFields && urlFields.length > 0 ) {\n\tfor( var j=0; j < urlFields.length; j++ ) {\n\t\taddEventListener(urlFields[j],'blur',maybePrefixUrlField);\n\t}\n}/* test if browser supports date fields */\nvar testInput = document.createElement('input');\ntestInput.setAttribute('type', 'date');\nif( testInput.type !== 'date') {\n\n\t/* add placeholder & pattern to all date fields */\n\tvar dateFields = document.querySelectorAll('.mc4wp-form input[type=\"date\"]');\n\tfor(var i=0; i<dateFields.length; i++) {\n\t\tif(!dateFields[i].placeholder) {\n\t\t\tdateFields[i].placeholder = 'YYYY-MM-DD';\n\t\t}\n\t\tif(!dateFields[i].pattern) {\n\t\t\tdateFields[i].pattern = '[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])';\n\t\t}\n\t}\n}\n\n})();</script><script type=\"text/javascript\">\n/* <![CDATA[ */\nvar boxzilla_options = {\"testMode\":\"\",\"boxes\":[{\"id\":82996,\"icon\":\"&times;\",\"content\":\"\",\"css\":{\"background_color\":\"#eeee22\",\"width\":600,\"border_width\":2,\"border_style\":\"double\",\"position\":\"center\"},\"trigger\":{\"method\":\"time_on_page\",\"value\":\"3\"},\"animation\":\"fade\",\"cookie\":{\"triggered\":0,\"dismissed\":336},\"rehide\":true,\"position\":\"center\",\"screenWidthCondition\":{\"condition\":\"larger\",\"value\":500},\"closable\":true,\"post\":{\"id\":82996,\"title\":\"Subscribe to KDnuggets\",\"slug\":\"subscribe-to-kdnuggets\"}}]};\n/* ]]> */\n</script>\n<script src=\"https://www.kdnuggets.com/wp-content/plugins/boxzilla/assets/js/script.min.js?ver=3.2.5\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n/* <![CDATA[ */\nvar boxzilla_stats_config = {\"ajaxurl\":\"https:\\/\\/www.kdnuggets.com\\/wp-admin\\/admin-ajax.php?action=boxzilla_stats_track\"};\n/* ]]> */\n</script>\n<script src=\"https://www.kdnuggets.com/wp-content/plugins/boxzilla-stats/assets/js/tracking.min.js?ver=1.0.4\" type=\"text/javascript\"></script>\n<script src=\"https://www.kdnuggets.com/wp-includes/js/wp-embed.min.js?ver=4.9.10\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n/* <![CDATA[ */\nvar mc4wp_forms_config = [];\n/* ]]> */\n</script>\n<script src=\"https://www.kdnuggets.com/wp-content/plugins/mailchimp-for-wp/assets/js/forms-api.min.js?ver=4.1.14\" type=\"text/javascript\"></script>\n<!--[if lte IE 9]>\n<script type='text/javascript' src='https://www.kdnuggets.com/wp-content/plugins/mailchimp-for-wp/assets/js/third-party/placeholders.min.js?ver=4.1.14'></script>\n<![endif]-->\n<!--/.main_wrapper--></body></html>\n<script src=\"https://s7.addthis.com/js/300/addthis_widget.js#pubid=gpsaddthis\" type=\"text/javascript\"></script>\n\n\n<!-- Dynamic page generated in 0.791 seconds. -->\n<!-- Cached page generated by WP-Super-Cache on 2019-04-26 21:12:15 -->\n<!-- Compression = gzip -->", "content_tokenized": ["rick", "radewagen", "busi", "school", "introduct", "what", "have", "dataset", "domain", "like", "fraud", "detect", "bank", "realtim", "bid", "market", "intrus", "detect", "network", "common", "data", "use", "these", "area", "often", "have", "less", "than", "num", "rare", "but", "interest", "event", "fraudster", "use", "credit", "card", "user", "click", "advertis", "corrupt", "server", "scan", "network", "howev", "most", "machin", "learn", "algorithm", "not", "work", "veri", "well", "with", "imbalanc", "dataset", "the", "follow", "seven", "techniqu", "can", "help", "train", "classifi", "detect", "the", "abnorm", "class", "num", "use", "the", "right", "evalu", "metric", "appli", "inappropri", "evalu", "metric", "for", "model", "generat", "use", "imbalanc", "data", "can", "danger", "imagin", "our", "train", "data", "the", "one", "illustr", "graph", "abov", "accuraci", "use", "measur", "the", "good", "model", "model", "which", "classifi", "all", "test", "sampl", "into", "num", "will", "have", "excel", "accuraci", "num", "but", "obvious", "this", "model", "won", "provid", "ani", "valuabl", "inform", "for", "this", "case", "other", "altern", "evalu", "metric", "can", "appli", "such", "precisionspecif", "how", "mani", "select", "instanc", "are", "relev", "recallsensit", "how", "mani", "relev", "instanc", "are", "select", "score", "harmon", "mean", "precis", "and", "recal", "correl", "coeffici", "between", "the", "observ", "and", "predict", "binari", "classif", "relat", "between", "trueposit", "rate", "and", "fals", "posit", "rate", "num", "resampl", "the", "train", "set", "apart", "from", "use", "differ", "evalu", "criteria", "one", "can", "also", "work", "get", "differ", "dataset", "two", "approach", "make", "balanc", "dataset", "out", "imbalanc", "one", "are", "undersampl", "and", "oversampl", "num", "undersampl", "undersampl", "balanc", "the", "dataset", "reduc", "the", "size", "the", "abund", "class", "this", "method", "use", "when", "quantiti", "data", "suffici", "keep", "all", "sampl", "the", "rare", "class", "and", "random", "select", "equal", "number", "sampl", "the", "abund", "class", "balanc", "new", "dataset", "can", "retriev", "for", "further", "model", "num", "oversampl", "the", "contrari", "oversampl", "use", "when", "the", "quantiti", "data", "insuffici", "tri", "balanc", "dataset", "increas", "the", "size", "rare", "sampl", "rather", "than", "get", "rid", "abund", "sampl", "new", "rare", "sampl", "are", "generat", "use", "repetit", "bootstrap", "synthet", "minor", "oversampl", "techniqu", "num", "note", "that", "there", "absolut", "advantag", "one", "resampl", "method", "over", "anoth", "applic", "these", "two", "method", "depend", "the", "use", "case", "appli", "and", "the", "dataset", "itself", "combin", "over", "and", "undersampl", "often", "success", "well", "num", "use", "kfold", "crossvalid", "the", "right", "way", "noteworthi", "that", "crossvalid", "should", "appli", "proper", "while", "use", "oversampl", "method", "address", "imbal", "problem", "keep", "mind", "that", "oversampl", "take", "observ", "rare", "sampl", "and", "appli", "bootstrap", "generat", "new", "random", "data", "base", "distribut", "function", "crossvalid", "appli", "after", "oversampl", "basic", "what", "are", "overfit", "our", "model", "specif", "artifici", "bootstrap", "result", "that", "whi", "crossvalid", "should", "alway", "done", "befor", "oversampl", "the", "data", "just", "how", "featur", "select", "should", "implement", "onli", "resampl", "the", "data", "repeat", "random", "can", "introduc", "into", "the", "dataset", "make", "sure", "that", "there", "won", "overfit", "problem", "num", "ensembl", "differ", "resampl", "dataset", "the", "easiest", "way", "success", "general", "model", "use", "more", "data", "the", "problem", "that", "outofthebox", "classifi", "like", "logist", "regress", "random", "forest", "tend", "general", "discard", "the", "rare", "class", "one", "easi", "best", "practic", "build", "model", "that", "use", "all", "the", "sampl", "the", "rare", "class", "and", "ndiffer", "sampl", "the", "abund", "class", "given", "that", "want", "ensembl", "num", "model", "would", "keep", "the", "num", "case", "the", "rare", "class", "and", "random", "sampl", "num", "case", "the", "abund", "class", "then", "just", "split", "the", "num", "case", "num", "chunk", "and", "train", "num", "differ", "model", "this", "approach", "simpl", "and", "perfect", "horizont", "scalabl", "have", "lot", "data", "sinc", "can", "just", "train", "and", "run", "model", "differ", "cluster", "node", "ensembl", "model", "also", "tend", "general", "better", "which", "make", "this", "approach", "easi", "handl", "num", "resampl", "with", "differ", "ratio", "the", "previous", "approach", "can", "finetun", "play", "with", "the", "ratio", "between", "the", "rare", "and", "the", "abund", "class", "the", "best", "ratio", "heavili", "depend", "the", "data", "and", "the", "model", "that", "are", "use", "but", "instead", "train", "all", "model", "with", "the", "same", "ratio", "the", "ensembl", "worth", "tri", "ensembl", "differ", "ratio", "num", "model", "are", "train", "might", "make", "sens", "have", "model", "that", "has", "ratio", "num", "rare", "abund", "and", "anoth", "one", "with", "num", "even", "num", "depend", "the", "model", "use", "this", "can", "influenc", "the", "weight", "that", "one", "class", "get", "num", "cluster", "the", "abund", "class", "eleg", "approach", "propos", "sergey", "quora", "num", "instead", "reli", "random", "sampl", "cover", "the", "varieti", "the", "train", "sampl", "suggest", "cluster", "the", "abund", "class", "group", "with", "the", "number", "case", "for", "each", "group", "onli", "the", "medoid", "centr", "cluster", "kept", "the", "model", "then", "train", "with", "the", "rare", "class", "and", "the", "medoid", "onli", "num", "design", "own", "model", "all", "the", "previous", "method", "focus", "the", "data", "and", "keep", "the", "model", "fix", "compon", "but", "fact", "there", "need", "resampl", "the", "data", "the", "model", "suit", "for", "imbalanc", "data", "the", "famous", "xgboost", "alreadi", "good", "start", "point", "the", "class", "are", "not", "skew", "too", "much", "becaus", "intern", "take", "care", "that", "the", "bag", "train", "are", "not", "imbalanc", "but", "then", "again", "the", "data", "resampl", "just", "happen", "secret", "design", "cost", "function", "that", "penal", "wrong", "classif", "the", "rare", "class", "more", "than", "wrong", "classif", "the", "abund", "class", "possibl", "design", "mani", "model", "that", "natur", "general", "favour", "the", "rare", "class", "for", "exampl", "tweak", "penal", "wrong", "classif", "the", "rare", "class", "the", "same", "ratio", "that", "this", "class", "underrepres", "final", "remark", "this", "not", "exclus", "list", "techniqu", "but", "rather", "start", "point", "handl", "imbalanc", "data", "there", "best", "approach", "model", "suit", "for", "all", "problem", "and", "strong", "recommend", "tri", "differ", "techniqu", "and", "model", "evalu", "what", "work", "best", "tri", "creativ", "and", "combin", "differ", "approach", "also", "import", "awar", "that", "mani", "domain", "fraud", "detect", "realtimebid", "where", "imbalanc", "class", "occur", "the", "marketrul", "are", "constant", "chang", "check", "past", "data", "might", "have", "becom", "obsolet", "num", "arxivorgpdfnumpdf", "num", "wwwquoracominclassificationhowdoyouhandleanunbalancedtrainingsetanswersnum", "sridhnumgnumo", "pursu", "the", "master", "busi", "analyt", "big", "data", "the", "busi", "school", "she", "has", "background", "account", "and", "handson", "experi", "market", "and", "sale", "forecast", "rick", "radewagen", "aspir", "data", "scientist", "with", "background", "comput", "scienc", "also", "pursu", "the", "master", "busi", "analyt", "big", "data", "the", "busi", "school", "relat", "learn", "from", "imbalanc", "class", "deal", "with", "unbalanc", "class", "svms", "random", "forest", "and", "decis", "tree", "python", "tidi", "data", "python"], "timestamp_scraper": 1556363405.765525, "title": "7 Techniques to Handle Imbalanced Data", "read_time": 345.0, "content_html": "<div class=\"post\" id=\"post-\">\n<p><b>By Ye Wu &amp; Rick Radewagen, IE Business School.</b></p>\n<h3>Introduction</h3>\n<p>\u00a0<br>\nWhat have datasets in domains like, fraud detection in banking, real-time bidding in marketing\u00a0or intrusion detection in networks, in common?</br></p>\n<p>Data used in these areas often have less than 1% of rare, but \u201cinteresting\u201d events (e.g. fraudsters using credit cards, user clicking advertisement or corrupted server scanning its network). However, most machine learning algorithms do not work very well with imbalanced datasets. The following seven techniques can help you, to train a classifier to detect the abnormal class.</p>\n<p><img alt=\"Imbalanced data image\" class=\"aligncenter\" src=\"/wp-content/uploads/imbalanced-data-1.png\" width=\"85%\"/></p>\n<p>\u00a0</p>\n<h3>1. Use the right evaluation metrics </h3>\n<p>\u00a0<br>\nApplying inappropriate evaluation metrics for model generated using imbalanced data can be dangerous. Imagine our training data is the one illustrated in graph above. If accuracy is used to measure the goodness of a model, a model which classifies all testing samples into \u201c0\u201d will have an excellent accuracy (99.8%), but obviously, this model won\u2019t provide any valuable information for us.</br></p>\n<p>In this case, other alternative evaluation metrics can be applied such as:</p>\n<ul>\n<li>Precision/Specificity: how many selected instances are relevant.\n<li>Recall/Sensitivity: how many relevant instances are selected.\n<li>F1 score: harmonic mean of precision and recall.\n<li>MCC: correlation coefficient between the observed and predicted binary classifications.\n<li>AUC: relation between true-positive rate and false positive rate.\n</li></li></li></li></li></ul>\n<p>\u00a0</p>\n<h3>2. Resample the training set</h3>\n<p>\u00a0<br>\nApart from using different evaluation criteria, one can also work on getting different dataset. Two approaches to make a balanced dataset out of an imbalanced one are under-sampling and over-sampling.</br></p>\n<p><strong>2.1. Under-sampling</strong></p>\n<p>Under-sampling balances the dataset by reducing the size of the abundant class. This method is used when quantity of data is sufficient. By keeping all samples in the rare class and randomly selecting an equal number of samples in the abundant class, a balanced new dataset can be retrieved for further modelling.</p>\n<p><strong>2.2. Over-sampling</strong></p>\n<p>On the contrary, oversampling is used when the quantity of data is insufficient. It tries to balance dataset by increasing the size of rare samples. Rather than getting rid of abundant samples, new rare samples are generated by using e.g. repetition, bootstrapping or SMOTE (Synthetic Minority Over-Sampling Technique) [1].</p>\n<p>Note that there is no absolute advantage of one resampling method over another. Application of these two methods depends on the use case it applies to and the dataset itself. A combination of over- and under-sampling is often successful as well.  </p>\n<p>\u00a0</p>\n<h3>3. Use K-fold Cross-Validation in the right way</h3>\n<p>\u00a0<br>\nIt is noteworthy that cross-validation should be applied properly while using over-sampling method to address imbalance problems.</br></p>\n<p>Keep in mind that over-sampling takes observed rare samples and applies bootstrapping to generate new random data based on a distribution function. If cross-validation is applied after over-sampling, basically what we are doing is overfitting our model to a specific artificial bootstrapping result. That is why cross-validation should always be done before over-sampling the data, just as how feature selection should be implemented. Only by resampling the data repeatedly, randomness can be introduced into the dataset to make sure that there won\u2019t be an overfitting problem. </p>\n<p>\u00a0</p>\n<h3>4. Ensemble different resampled datasets</h3>\n<p>\u00a0<br/>\nThe easiest way to successfully generalize a model is by using more data. The problem is that out-of-the-box classifiers like logistic regression or random forest tend to generalize by discarding\u00a0the rare class. One easy best practice is building n models that use all the samples of the rare class and n-differing samples of the abundant class. Given that you want to ensemble 10 models, you would keep e.g. the 1.000 cases of the rare class and randomly sample 10.000 cases of the abundant class. Then you just split the 10.000 cases in 10 chunks and train 10 different models.</p>\n<p><img alt=\"Imbalanced data image\" class=\"aligncenter\" src=\"/wp-content/uploads/imbalanced-data-2.png\" width=\"85%\"/></p>\n<p>This approach is simple and perfectly horizontally scalable if you have a lot of data, since you can just train and run\u00a0your models on different cluster nodes. Ensemble models also tend to generalize better, which makes this approach easy to handle. </p>\n<p>\u00a0</p>\n<h3>5. Resample with different ratios</h3>\n<p>\u00a0<br/>\nThe previous approach can be fine-tuned by playing with the ratio between the rare and the abundant class. The best ratio \u00a0heavily depends on the data and the models that are used. But instead of training all models with the same ratio in the ensemble, it is worth trying to ensemble different ratios. \u00a0So if 10 models are trained, it might make sense to have a model that has a ratio of 1:1 (rare:abundant) and another one with 1:3, or even 2:1. Depending on the model used this can influence the weight that one class gets.</p>\n<p><img alt=\"Imbalanced data image\" class=\"aligncenter\" src=\"/wp-content/uploads/imbalanced-data-3.png\" width=\"50%\"/></p>\n<p>\u00a0</p>\n<h3>6. Cluster the abundant class</h3>\n<p>\u00a0<br/>\nAn elegant approach was proposed by Sergey on Quora [2]. Instead of relying on random samples to cover the variety of the training samples, he suggests clustering the abundant class in r groups, with r being the number of cases in r. For each group, only the medoid (centre of cluster) is kept. The model is then trained with the rare class and the medoids only. </p>\n<p>\u00a0</p>\n<h3>7. Design your own models</h3>\n<p>\u00a0<br/>\nAll the previous methods focus on the data and keep the models as a fixed component. But in fact, there is no need to resample the data if the model is suited for imbalanced data. The famous XGBoost is already a good starting point if the classes are not skewed too much, because it internally takes care that the bags it trains on are not imbalanced. But then again, the data is resampled, it is just happening secretly. </p>\n<p>By designing a cost function that is penalizing wrong classification of the rare class more than wrong classifications of the abundant class, it is possible to design many models that naturally generalize in favour of the rare class. For example, tweaking an SVM to penalize wrong classifications of the rare class by the same ratio that this class is underrepresented. </p>\n<p><img alt=\"Imbalanced data image\" class=\"aligncenter\" src=\"/wp-content/uploads/imbalanced-data-4.png\" width=\"60%\"/></p>\n<p>\u00a0</p>\n<h3>Final Remarks</h3>\n<p>\u00a0<br/>\nThis is not an exclusive list of techniques, but rather a starting point to handle imbalanced data. There is no best approach or model suited for all problems and it is strongly recommended to try different techniques and models to evaluate what works best. Try to be creative and combine different approaches. It is also important, to be aware that in many domains (e.g. fraud detection, real-time-bidding), where imbalanced classes occur, the \u201cmarket-rules\u201d are constantly changing. So, check if past data might have become obsolete.</p>\n<p>[1] <a href=\"https://arxiv.org/pdf/1106.1813.pdf\" target=\"_blank\">arxiv.org/pdf/1106.1813.pdf</a></p>\n<p>[2] <a href=\"https://www.quora.com/In-classification-how-do-you-handle-an-unbalanced-training-set/answers/1144228?srid=h3G6o\" target=\"_blank\">www.quora.com/In-classification-how-do-you-handle-an-unbalanced-training-set/answers/1144228?srid=h3G6o</a></p>\n<p><a href=\"https://www.linkedin.com/in/ye-wu-424350b6/\" target=\"_blank\"><strong>Ye Wu</strong></a> is pursuing the Master in Business Analytics &amp; Big Data at the IE Business School. She has a background in Accounting and hands-on experience in Marketing and Sales Forecasting. </p>\n<p><a href=\"https://www.linkedin.com/in/rick-radewagen-90864784/\" target=\"_blank\"><strong>Rick Radewagen</strong></a> is an aspiring Data Scientist with a background in Computer Science. He is also pursuing the Master in Business Analytics &amp; Big Data at the IE Business School.</p>\n<p><b>Related:</b></p>\n<ul class=\"three_ul\">\n<li><a href=\"/2016/08/learning-from-imbalanced-classes.html\">Learning from Imbalanced Classes</a>\n<li><a href=\"/2016/04/unbalanced-classes-svm-random-forests-python.html\">Dealing with Unbalanced Classes, SVMs, Random Forests, and Decision Trees in Python</a>\n<li><a href=\"/2017/01/tidying-data-python.html\">Tidying Data in Python</a>\n</li></li></li></ul>\n</div> ", "website": "kdnuggets"}