{"content": "Serverless observability without Breaking the\u00a0Bank Yan Cui Blocked Unblock Follow Following Apr 23 To run a serverless application in production reliably, you need to be able to debug issues quickly. You need to have good observability, and having structured logs is a big part of that. They allow you to capture useful contextual information with each log message. But observability comes with a cost. The Problem CloudWatch Logs charges $0.50 for per GB of data ingested, and $0.03 per GB per month for storage. As such, it\u2019s common for companies to spend more on CloudWatch Logs than Lambda invocations in their production environment. Best practices such as using structured logs further exasperate the cost associated with logging. Furthermore, with AWS Lambda, it\u2019s no longer possible to rely on agents to collect and publish observability data such as custom metrics and traces. Instead, you have to either: publish data synchronously as part of a function invocation publish data asynchronously through CloudWatch Logs Publishing data synchronously adds latency to your invocation. When it comes to APIs this extra latency becomes user-facing and negatively impacts your user experience. Which is why it\u2019s generally recommended that you collect observability data for APIs asynchronously. However, collecting data through CloudWatch Logs further adds to its cost. In this post, we\u2019ll see how we can use sampling to address this cost concern, and check out the built-in sampling support in Thundra. Sampling to the\u00a0rescue If the primary reason why we needed observability in the first place is to help us debug issues in production. And if most requests are processed successfully, then it stands to reason that we should: Collect data for all erroneous or poor performing invocations. Because they represent invocations that require our attention. Collect data for a small percentage of successful invocations. So that we always have some representation of what a \u201cgood\u201d invocation looks like. In the most naive approach, we can also sample data from a percentage of all invocations irrespective of their outcome or performance. That way, we can reduce the cost of logging while still maintaining the same distribution of good and bad invocations. With a sufficient number of invocations, you only need a small percentage of them to have representative data for every scenario. Indeed, the industry average is to sample 1% of all requests. The likes of Google would sample at 0.01% because their scale is so big that even 0.01% of requests would give you good representation for every scenario. Intelligent sampling with\u00a0Thundra Thundra supports both synchronous and asynchronous modes of collecting data. But collecting data asynchronously requires you to send a lot of data to CloudWatch Logs. By default, Thundra records at least seven pieces of data for every invocation (see below). That is a total of 16KB of observability data for every invocation! It undoubtedly is a cost concern when running at scale. So I\u2019m really glad that Thundra recently announced sampling support. Sampling metrics For metrics, you can use the count aware sampler to do simple percentage-based sampling. What\u2019s more interesting though, is the time aware sampler . It allows you to sample metrics based on a configured frequency. Percentage-based sampling works well when you have stable, predictable traffic. All the way throughout the day, you will have metrics for a percentage of invocations. But it doesn\u2019t work well for functions that run in bursts. If a function runs infrequently and we only collect metrics on 1% of its invocations, then there will be large gaps in time where we don\u2019t have any metrics at all. Conversely, if this function sees a sudden burst of activities, we will collect lots of metrics during that burst. However, since all the metrics relate to the same burst of activities, they are bound to be similar too. Which means their signal-to-noise ratio is low. The time-aware sampler solves this because when the function runs infrequently, it\u2019ll simply record metrics for every invocation. When the function sees a burst of activities, it\u2019ll also not record too many metrics either. Take the following function as an example, it\u2019ll record metrics every five seconds. You can see from its logs that invocations that are less than 5s since the last sampled metric would not record metrics. Sampling traces For traces, you can enable sampling based on the duration of invocations as well as whether they ended in an error state. For example, the following configuration would sample trace data only when the duration of an invocation is over 500ms. That is, \u201cshow me the breakdown of where invocation time was spent if the function is slow\u201d. Again, if you look at the logs for this function. You will see an entry with type \u201cSpan\u201d only when the invocation duration was over 500ms. Similarly, the following configuration would sample traces only when the invocation errors. As discussed earlier, both of these sampling options are great for improving the signal to noise ratio. Since detailed traces are most useful when something has gone wrong. Either the invocation was slow and we need to investigate where the performance issue is. Or the invocation erred and we need to find out where did the error occur. However, I would still like traces to be sample even when everything is working normally. That way, I can have a sample of healthy invocations that I can use as a reference. Besides the sampling methods we discussed here, you can also write custom samplers for both metrics and traces. You can also configure samplers through environment variables too. For more information on the sampling support, check out the official documentation page . Summary In this post, we explained the problem that you can sometimes spend more on observing your production system than the system itself. Sampling is a common solution for addressing this cost concern while still giving you the observability you need. We then looked at the new tracing support that was recently added to Thundra. You can sample metrics and traces using a number of built-in samplers: These samplers can help reduce the cost of observing your production system significantly. But there\u2019s still room for further improvement as we discussed some ways Thundra can cut down on the cost of observability even further. Originally published at  .", "title_html": "<h1 class=\"graf graf--h3 graf--leading graf--title\" id=\"1518\" name=\"1518\">Serverless observability without Breaking the\u00a0Bank</h1> ", "url": "https://medium.com/predict/serverless-observability-without-breaking-the-bank-eee84f0b5ee1", "tfidf": {"tfidf": {"base": 2.2925631769, "occur": 1.7453825857499998, "can": 16.46765947988, "googl": 11.388809182200001, "awar": 8.55387931034, "then": 3.25973581548, "too": 5.44755804645, "erron": 23.9096385542, "post": 4.47652615254, "here": 2.42307692308, "five": 1.37740760021, "data": 57.39940450878, "durat": 31.5208471212, "apr": 32.2682926829, "averag": 2.60390355913, "extra": 5.33826496301, "would": 6.497237569079999, "what": 2.50686878256, "nois": 11.6907216495, "experi": 1.87062566278, "than": 3.0983606557499996, "the": 46.0, "function": 22.458975165, "way": 4.8762957844, "log": 164.0930232564, "sudden": 5.78993435449, "well": 3.1967246123999997, "product": 8.113246116100001, "whether": 2.20683903253, "unblock": 635.04, "percentag": 24.33103448276, "lambda": 182.4827586206, "gap": 7.302667893280001, "approach": 2.07556543339, "dure": 1.0503473370799998, "frequenc": 8.8102108768, "represent": 11.85660941, "mode": 7.391061452510001, "check": 13.0131147541, "announc": 2.02940048575, "recommend": 3.9142011834300003, "burst": 79.9395770395, "where": 4.26860254084, "environ": 6.87123999134, "bound": 5.40735694823, "least": 1.6165359943000002, "spent": 3.00795755968, "room": 3.07674418605, "irrespect": 54.5567010309, "run": 7.7846425419, "how": 1.60250328051, "enabl": 3.5421686747, "quick": 2.205, "them": 1.09876115994, "request": 9.27155927583, "maintain": 1.77306231852, "whi": 6.513230769240001, "bad": 3.3944836433599996, "explain": 2.60049140049, "distribut": 2.7396031061299997, "end": 1.10680423871, "messag": 4.96745932416, "interest": 1.60331246213, "abl": 1.8208510150200001, "mani": 1.04426757877, "will": 4.89924394384, "associ": 1.3263157894700002, "over": 2.05050048434, "signal": 5.12459651388, "realli": 4.7476076555, "second": 1.1130898128, "rescu": 6.3656776263, "trace": 44.408391608399995, "new": 1.0178880554, "below": 2.25607503197, "perform": 4.59419311275, "but": 4.06529671596, "throughout": 1.5217099587799998, "userfac": 635.04, "invoc": 2352.0, "our": 2.35758835759, "serverless": 1270.08, "longer": 2.02319357716, "cost": 20.87421475527, "attent": 2.81040892193, "inform": 3.1506251240400003, "yan": 78.2068965517, "record": 7.1167294244, "naiv": 50.2405063291, "applic": 3.42672134686, "best": 1.5828514456600002, "healthi": 12.520504731900001, "signaltonois": 635.04, "has": 1.0436497502, "have": 9.134053570259999, "either": 4.749027819329999, "besid": 5.1362018764199995, "take": 1.13961668222, "use": 7.207471301659999, "follow": 5.23200632745, "default": 21.1398135819, "synchron": 78.0786885246, "further": 5.447246526, "configur": 46.01739130439999, "out": 3.18050083473, "glad": 34.3636363636, "per": 5.879274163679999, "good": 6.07926479036, "alway": 2.06745670009, "possibl": 1.4173734488, "time": 3.03382381044, "publish": 6.84428349715, "number": 2.20285833218, "break": 2.42863698944, "issu": 4.31765025837, "reli": 4.16146788991, "also": 4.05906040268, "count": 3.48157894737, "seven": 1.93940874664, "everyth": 4.81967213115, "mean": 1.44906900329, "not": 2.03134796238, "cui": 288.654545455, "exampl": 3.00966824644, "infrequ": 71.5135135136, "signific": 1.4529147982100001, "scenario": 30.7972841902, "becom": 1.12492028626, "less": 1.46904783936, "solut": 4.7278141751, "stand": 2.0845588235299997, "like": 3.44755700325, "they": 4.12069301148, "metric": 355.76470588160004, "captur": 2.88026124819, "though": 1.36076112111, "problem": 3.53349655018, "sinc": 3.2510580204900004, "system": 4.16219522853, "howev": 3.2835573939899994, "last": 1.2117234010100002, "allow": 2.5432118542200004, "piec": 3.24132298898, "outcom": 7.48867924528, "gone": 5.22408687068, "work": 3.34560269739, "numm": 37.7550535078, "span": 6.17262830482, "which": 2.01038369, "furthermor": 5.50294627383, "such": 3.18454132122, "activ": 4.39210623387, "exasper": 134.542372881, "simpl": 3.3981164383599998, "day": 1.18371607516, "refer": 1.30024570025, "itself": 1.74557449148, "show": 1.26703910615, "bank": 2.87400434468, "impact": 2.97526236882, "custom": 7.269230769239999, "see": 7.63452753066, "entri": 3.9909502262400003, "observ": 24.46910466583, "becaus": 3.4485554992499994, "timeawar": 635.04, "still": 4.746543089919999, "intellig": 4.19334389857, "small": 2.7189587258, "without": 1.29547123623, "lot": 8.81755068036, "some": 2.08073394496, "practic": 1.70434782609, "collect": 14.76989869752, "both": 3.15647160183, "agent": 4.25858369099, "part": 2.08661365578, "document": 2.5409731114, "that": 18.0717131475, "recent": 3.0881151527, "ratio": 14.42616992276, "reliabl": 6.681818181819999, "ani": 1.13383802314, "sampl": 173.58724373568, "should": 1.6643254009900001, "and": 14.000881889819999, "api": 168.89361702120001, "process": 1.69524826482, "relat": 1.23750876919, "down": 1.35889754344, "similar": 2.75028150714, "concern": 5.655860349120001, "detail": 2.26186066391, "num": 8.00252032008, "variabl": 8.747107438019999, "same": 2.23715916296, "most": 3.06289389069, "low": 2.13072070863, "everi": 8.87505823164, "stabl": 6.70156184044, "add": 9.22486926206, "for": 22.00693088022, "predict": 5.18484650555, "breakdown": 15.0483412322, "builtin": 1270.08, "need": 10.06083650187, "all": 6.06880733946, "slow": 8.09586945436, "with": 7.008387462929998, "reason": 3.44680851064, "someth": 3.28152128979, "there": 2.08182533438, "are": 5.1495296789000005, "simpli": 2.5192002538900002, "poor": 2.42196796339, "solv": 7.26923076923, "compani": 1.5523613963, "structur": 4.1161524500999995, "month": 1.5079787234, "normal": 2.61075481006, "debug": 360.818181818, "look": 5.725895647979999, "undoubt": 27.0459965928, "option": 4.04896710023, "summari": 7.80147420147, "more": 4.0686827268, "improv": 4.08753861998, "spend": 8.31857479696, "discuss": 6.59028642591, "asynchron": 661.5, "these": 2.14830852504, "traffic": 5.95052473763, "negat": 3.75852272727, "latenc": 348.92307692400004, "general": 1.1218202374200001, "percentagebas": 1270.08, "cloudwatch": 3175.2, "again": 1.50883862384, "state": 1.0477133240899998, "cut": 2.4663663197099996, "storag": 8.623574144489998, "sampler": 1058.3999999999999, "wrong": 5.478260869570001, "even": 3.49383802818, "convers": 3.3486606201200004, "give": 2.7306501548, "total": 1.5460122699399999, "onli": 5.128238258300001, "each": 1.18974820144, "their": 4.0619163362, "place": 1.1004366812200002, "great": 1.26592775696, "ingest": 42.449197861, "industri": 2.02319357716, "this": 8.03034901368, "error": 18.123287671230003, "investig": 3.11721971333, "primari": 2.2373167981999997, "common": 2.8051948051999998, "big": 5.480151881259999, "type": 2.0281042411900003, "block": 3.20274359492, "reduc": 3.97396745932, "address": 5.72314347512, "thundra": 4445.28, "method": 2.5714285714300003, "scale": 7.493981590739999, "support": 6.342788653600001, "charg": 2.3653158522099997, "repres": 2.93945565636, "sometim": 1.7126213592200001, "come": 2.65662650602, "origin": 1.13724928367, "offici": 1.40483143085, "through": 3.21224792607, "send": 3.75053153792, "requir": 3.05689804564, "from": 2.00113442994, "contextu": 76.6956521739, "first": 1.00761614623, "earlier": 1.86776470588, "page": 2.03669018602, "while": 2.0883977900599997, "help": 2.79925945518, "write": 2.0575427682700003, "larg": 1.18574949585, "find": 1.7294117647099998, "suffici": 4.3117870722400005, "instead": 1.59461631177, "inde": 4.43092380687, "when": 10.2076769755, "user": 7.71053909665, "success": 2.6400598653}, "logtfidf": {"base": 0.27304660457400004, "occur": 0.556973778473, "can": 2.272775349516, "googl": 2.43263122258, "awar": 2.90647544, "then": 0.24910159569269996, "too": 1.7896654641659997, "erron": 3.17428166443, "post": 1.6114003054019999, "here": 0.8850381883700001, "five": 0.320203181906, "data": 20.6859499416, "durat": 7.056110554889999, "apr": 3.47408509741, "averag": 0.957011687995, "extra": 1.67490068688, "would": 0.47770576778819995, "what": 0.451774593654, "nois": 2.45879550578, "experi": 0.626272953933, "than": 0.0967825866546, "the": 0.0, "function": 8.230191674345999, "way": 0.7923660397400001, "log": 31.386321986520002, "sudden": 1.75612095378, "well": 0.1905433149468, "product": 2.4203006826799998, "whether": 0.791561189647, "unblock": 6.45368798903, "percentag": 7.221833254360001, "lambda": 9.027017029380001, "gap": 1.98823974622, "approach": 0.7302336145810001, "dure": 0.0491209066894, "frequenc": 2.1759113757299997, "represent": 3.5594765752999997, "mode": 2.00027135827, "check": 3.74562099124, "announc": 0.707740422218, "recommend": 1.36461126863, "burst": 13.8591657493, "where": 0.2599685549828, "environ": 2.4683948060599996, "bound": 1.68776042417, "least": 0.480285584745, "spent": 1.10126129684, "room": 1.12387195543, "irrespect": 3.9992405467300003, "run": 2.213574877695, "how": 0.47156695693000006, "enabl": 1.26473915954, "quick": 0.790727508899, "them": 0.0941833269093, "request": 3.3850178503199997, "maintain": 0.572708175102, "whi": 2.36137686094, "bad": 1.2221516561799999, "explain": 0.955700427358, "distribut": 1.00781305813, "end": 0.101476798618, "messag": 1.6029085070200002, "interest": 0.47207177798199995, "abl": 0.599303982475, "mani": 0.0433157581221, "will": 0.81114613966, "associ": 0.28240501535100004, "over": 0.0498734429914, "signal": 1.6340517929299998, "realli": 1.5576408397, "second": 0.10713976337999999, "rescu": 1.8509206876599997, "trace": 14.908433587700001, "new": 0.0177299468511, "below": 0.813626591936, "perform": 1.27854255174, "but": 0.0647694882876, "throughout": 0.41983467543499997, "userfac": 6.45368798903, "invoc": 110.03921948808, "our": 0.8576392141820001, "serverless": 12.90737597806, "longer": 0.7046772417749999, "cost": 7.57161068562, "attent": 1.03332999658, "inform": 0.908907409324, "yan": 4.35935783486, "record": 1.7650517847649998, "naiv": 3.9168216003199996, "applic": 1.23160392849, "best": 0.459227932947, "healthi": 2.5273676789099997, "signaltonois": 6.45368798903, "has": 0.0427239448548, "have": 0.1330650210708, "either": 1.377982916445, "besid": 1.63631387177, "take": 0.130691962197, "use": 0.2044561381212, "follow": 0.22678455547099996, "default": 3.0511581621399997, "synchron": 9.77731457022, "further": 1.235263581188, "configur": 9.770900142999999, "out": 0.1752791727579, "glad": 3.5369989228199996, "per": 2.018463072216, "good": 1.674357619628, "alway": 0.726319204572, "possibl": 0.348805474891, "time": 0.0336345565878, "publish": 1.569879327335, "number": 0.1932171568372, "break": 0.88733019029, "issu": 1.092297131802, "reli": 1.42586787018, "also": 0.0586286312, "count": 1.24748591139, "seven": 0.662383156851, "everyth": 1.57270590317, "mean": 0.37092128352, "not": 0.031104826015, "cui": 5.66523062867, "exampl": 0.8173653499979999, "infrequ": 7.153478502939999, "signific": 0.373571744332, "scenario": 5.46855865978, "becom": 0.11771217648900001, "less": 0.3846144626, "solut": 1.55346297627, "stand": 0.7345572374320001, "like": 0.417160729635, "they": 0.1189079790704, "metric": 49.62689362495999, "captur": 1.0578810012100002, "though": 0.308044191079, "problem": 1.138281448546, "sinc": 0.2411045983731, "system": 0.982291036755, "howev": 0.27094535204250003, "last": 0.19204364461100001, "allow": 0.48056122237800003, "piec": 1.17598157639, "outcom": 2.01339244624, "gone": 1.65328002099, "work": 0.327103701819, "numm": 5.87594430786, "span": 1.82012472855, "which": 0.01035682769086, "furthermor": 1.70528363496, "such": 0.179087933418, "activ": 1.143589809852, "exasper": 4.90187918944, "simpl": 1.2232212893899999, "day": 0.16865870631700003, "refer": 0.262553246798, "itself": 0.5570837229510001, "show": 0.236682766013, "bank": 1.0557062993700002, "impact": 1.09033222631, "custom": 2.5810065929599997, "see": 1.445529512952, "entri": 1.38402935449, "observ": 8.794676164252001, "becaus": 0.418029476475, "timeawar": 6.45368798903, "still": 0.6844888857160001, "intellig": 1.43349848213, "small": 0.614203610118, "without": 0.258874517941, "lot": 2.9671939005000003, "some": 0.079147018129, "practic": 0.533182530867, "collect": 4.45829994468, "both": 0.1525276001679, "agent": 1.4489366381, "part": 0.08479062196560001, "document": 0.932547122383, "that": 0.07157067083351999, "recent": 0.868827482576, "ratio": 3.95179346476, "reliabl": 1.89939013342, "ani": 0.125608358366, "sampl": 47.48703572136, "should": 0.509419876758, "and": 0.0008818619888904, "api": 8.87224370214, "process": 0.527829199025, "relat": 0.21310030165399999, "down": 0.306673741186, "similar": 0.637112184228, "concern": 1.902239846619, "detail": 0.816187777173, "num": 0.0025199231631760004, "variabl": 2.1687230672, "same": 0.224119299208, "most": 0.06224368888679999, "low": 0.7564602833490001, "everi": 2.348912564526, "stabl": 1.90234060974, "add": 3.05751167426, "for": 0.006929788698734001, "predict": 1.6457402376899999, "breakdown": 2.7112677679900004, "builtin": 12.90737597806, "need": 2.539181144094, "all": 0.06841579258679999, "slow": 2.7964136143, "with": 0.00838244199373, "reason": 1.088603105924, "someth": 1.18830712273, "there": 0.080195785851, "are": 0.1473373679135, "simpli": 0.923941491586, "poor": 0.8845804177050001, "solv": 1.9836504770400003, "compani": 0.439777253097, "structur": 1.4435433502700001, "month": 0.410770160338, "normal": 0.959639378783, "debug": 10.39045399884, "look": 1.9391600808, "undoubt": 3.29753899407, "option": 1.39846181161, "summari": 2.0543127160299997, "more": 0.06809972639999999, "improv": 1.4295916078639999, "spend": 2.85068752232, "discuss": 2.3609535678599998, "asynchron": 20.43286248976, "these": 0.1430672388016, "traffic": 1.7834794068700002, "negat": 1.32402598852, "latenc": 10.32340861478, "general": 0.114952578063, "percentagebas": 12.90737597806, "cloudwatch": 32.26843994515, "again": 0.411340231612, "state": 0.0466100027668, "cut": 0.90274594185, "storag": 2.1544996326700003, "sampler": 35.13022424625, "wrong": 1.70078769102, "even": 0.45716569450200006, "convers": 1.2085604509999999, "give": 0.622785104448, "total": 0.43567888670500005, "onli": 0.12662134164549999, "each": 0.173741689304, "their": 0.061442020490800005, "place": 0.0957070839572, "great": 0.235805258079, "ingest": 3.74830801649, "industri": 0.7046772417749999, "this": 0.03029159242, "error": 5.395756302900001, "investig": 1.13694148702, "primari": 0.805277289914, "common": 0.676651610542, "big": 2.01597127114, "type": 0.707101485387, "block": 1.16400781588, "reduc": 1.373235550286, "address": 2.10274206494, "thundra": 45.175815923209996, "method": 0.944461608841, "scale": 2.64190612656, "support": 1.1894030501850001, "charg": 0.860911565756, "repres": 0.7701544655, "sometim": 0.538025155343, "come": 0.5678198130600001, "origin": 0.128612437587, "offici": 0.339917317543, "through": 0.20507607565469999, "send": 1.32189757338, "requir": 0.84850702135, "from": 0.001134108337732, "contextu": 4.33984502064, "first": 0.0075872898121599995, "earlier": 0.624742371425, "page": 0.711326032411, "while": 0.08649996758760002, "help": 0.672415442688, "write": 0.721512439877, "larg": 0.17037506060600002, "find": 0.547781330288, "suffici": 1.4613524521099999, "instead": 0.46663315041500003, "inde": 1.4886080966, "when": 0.205549888584, "user": 2.04258810688, "success": 0.5553088251839999}, "logidf": {"base": 0.13652330228700002, "occur": 0.556973778473, "can": 0.162341096394, "googl": 2.43263122258, "awar": 1.45323772, "then": 0.08303386523089999, "too": 0.5965551547219999, "erron": 3.17428166443, "post": 0.8057001527009999, "here": 0.8850381883700001, "five": 0.320203181906, "data": 1.2168205848, "durat": 2.35203685163, "apr": 3.47408509741, "averag": 0.957011687995, "extra": 1.67490068688, "would": 0.0796176279647, "what": 0.225887296827, "nois": 2.45879550578, "experi": 0.626272953933, "than": 0.0322608622182, "the": 0.0, "function": 0.914465741594, "way": 0.19809150993500002, "log": 2.61552683221, "sudden": 1.75612095378, "well": 0.0635144383156, "product": 0.484060136536, "whether": 0.791561189647, "unblock": 6.45368798903, "percentag": 1.8054583135900002, "lambda": 4.513508514690001, "gap": 1.98823974622, "approach": 0.7302336145810001, "dure": 0.0491209066894, "frequenc": 2.1759113757299997, "represent": 1.7797382876499999, "mode": 2.00027135827, "check": 1.87281049562, "announc": 0.707740422218, "recommend": 1.36461126863, "burst": 2.77183314986, "where": 0.0649921387457, "environ": 1.2341974030299998, "bound": 1.68776042417, "least": 0.480285584745, "spent": 1.10126129684, "room": 1.12387195543, "irrespect": 3.9992405467300003, "run": 0.442714975539, "how": 0.47156695693000006, "enabl": 1.26473915954, "quick": 0.790727508899, "them": 0.0941833269093, "request": 1.12833928344, "maintain": 0.572708175102, "whi": 1.18068843047, "bad": 1.2221516561799999, "explain": 0.955700427358, "distribut": 1.00781305813, "end": 0.101476798618, "messag": 1.6029085070200002, "interest": 0.47207177798199995, "abl": 0.599303982475, "mani": 0.0433157581221, "will": 0.202786534915, "associ": 0.28240501535100004, "over": 0.0249367214957, "signal": 1.6340517929299998, "realli": 1.5576408397, "second": 0.10713976337999999, "rescu": 1.8509206876599997, "trace": 1.49084335877, "new": 0.0177299468511, "below": 0.813626591936, "perform": 0.42618085058, "but": 0.0161923720719, "throughout": 0.41983467543499997, "userfac": 6.45368798903, "invoc": 4.584967478669999, "our": 0.8576392141820001, "serverless": 6.45368798903, "longer": 0.7046772417749999, "cost": 0.84129007618, "attent": 1.03332999658, "inform": 0.454453704662, "yan": 4.35935783486, "record": 0.353010356953, "naiv": 3.9168216003199996, "applic": 1.23160392849, "best": 0.459227932947, "healthi": 2.5273676789099997, "signaltonois": 6.45368798903, "has": 0.0427239448548, "have": 0.0147850023412, "either": 0.459327638815, "besid": 1.63631387177, "take": 0.130691962197, "use": 0.0292080197316, "follow": 0.045356911094199995, "default": 3.0511581621399997, "synchron": 3.25910485674, "further": 0.308815895297, "configur": 2.4427250357499997, "out": 0.0584263909193, "glad": 3.5369989228199996, "per": 0.672821024072, "good": 0.418589404907, "alway": 0.726319204572, "possibl": 0.348805474891, "time": 0.0112115188626, "publish": 0.313975865467, "number": 0.0966085784186, "break": 0.88733019029, "issu": 0.364099043934, "reli": 1.42586787018, "also": 0.0146571578, "count": 1.24748591139, "seven": 0.662383156851, "everyth": 1.57270590317, "mean": 0.37092128352, "not": 0.0155524130075, "cui": 5.66523062867, "exampl": 0.40868267499899996, "infrequ": 3.5767392514699994, "signific": 0.373571744332, "scenario": 2.73427932989, "becom": 0.11771217648900001, "less": 0.3846144626, "solut": 1.55346297627, "stand": 0.7345572374320001, "like": 0.139053576545, "they": 0.0297269947676, "metric": 3.1016808515599994, "captur": 1.0578810012100002, "though": 0.308044191079, "problem": 0.569140724273, "sinc": 0.0803681994577, "system": 0.327430345585, "howev": 0.0903151173475, "last": 0.19204364461100001, "allow": 0.24028061118900002, "piec": 1.17598157639, "outcom": 2.01339244624, "gone": 1.65328002099, "work": 0.109034567273, "numm": 2.93797215393, "span": 1.82012472855, "which": 0.00517841384543, "furthermor": 1.70528363496, "such": 0.059695977806, "activ": 0.381196603284, "exasper": 4.90187918944, "simpl": 1.2232212893899999, "day": 0.16865870631700003, "refer": 0.262553246798, "itself": 0.5570837229510001, "show": 0.236682766013, "bank": 1.0557062993700002, "impact": 1.09033222631, "custom": 1.2905032964799998, "see": 0.240921585492, "entri": 1.38402935449, "observ": 0.7995160149320001, "becaus": 0.139343158825, "timeawar": 6.45368798903, "still": 0.17112222142900002, "intellig": 1.43349848213, "small": 0.307101805059, "without": 0.258874517941, "lot": 1.4835969502500002, "some": 0.0395735090645, "practic": 0.533182530867, "collect": 0.49536666052, "both": 0.050842533389300004, "agent": 1.4489366381, "part": 0.04239531098280001, "document": 0.932547122383, "that": 0.00397614837964, "recent": 0.434413741288, "ratio": 1.97589673238, "reliabl": 1.89939013342, "ani": 0.125608358366, "sampl": 1.9786264883900002, "should": 0.509419876758, "and": 6.29901420636e-05, "api": 4.43612185107, "process": 0.527829199025, "relat": 0.21310030165399999, "down": 0.306673741186, "similar": 0.318556092114, "concern": 0.634079948873, "detail": 0.816187777173, "num": 0.00031499039539700004, "variabl": 2.1687230672, "same": 0.112059649604, "most": 0.020747896295599998, "low": 0.7564602833490001, "everi": 0.391485427421, "stabl": 1.90234060974, "add": 1.52875583713, "for": 0.00031499039539700004, "predict": 1.6457402376899999, "breakdown": 2.7112677679900004, "builtin": 6.45368798903, "need": 0.362740163442, "all": 0.011402632097799998, "slow": 1.39820680715, "with": 0.00119749171339, "reason": 0.544301552962, "someth": 1.18830712273, "there": 0.0400978929255, "are": 0.0294674735827, "simpli": 0.923941491586, "poor": 0.8845804177050001, "solv": 1.9836504770400003, "compani": 0.439777253097, "structur": 0.7217716751350001, "month": 0.410770160338, "normal": 0.959639378783, "debug": 5.19522699942, "look": 0.6463866936, "undoubt": 3.29753899407, "option": 1.39846181161, "summari": 2.0543127160299997, "more": 0.017024931599999998, "improv": 0.7147958039319999, "spend": 1.42534376116, "discuss": 0.78698452262, "asynchron": 5.10821562244, "these": 0.0715336194008, "traffic": 1.7834794068700002, "negat": 1.32402598852, "latenc": 5.16170430739, "general": 0.114952578063, "percentagebas": 6.45368798903, "cloudwatch": 6.45368798903, "again": 0.411340231612, "state": 0.0466100027668, "cut": 0.90274594185, "storag": 2.1544996326700003, "sampler": 5.01860346375, "wrong": 1.70078769102, "even": 0.152388564834, "convers": 1.2085604509999999, "give": 0.311392552224, "total": 0.43567888670500005, "onli": 0.025324268329099998, "each": 0.173741689304, "their": 0.015360505122700001, "place": 0.0957070839572, "great": 0.235805258079, "ingest": 3.74830801649, "industri": 0.7046772417749999, "this": 0.0037864490525, "error": 1.7985854343, "investig": 1.13694148702, "primari": 0.805277289914, "common": 0.338325805271, "big": 1.00798563557, "type": 0.707101485387, "block": 1.16400781588, "reduc": 0.686617775143, "address": 1.05137103247, "thundra": 6.45368798903, "method": 0.944461608841, "scale": 1.32095306328, "support": 0.237880610037, "charg": 0.860911565756, "repres": 0.38507723275, "sometim": 0.538025155343, "come": 0.28390990653000003, "origin": 0.128612437587, "offici": 0.339917317543, "through": 0.0683586918849, "send": 1.32189757338, "requir": 0.424253510675, "from": 0.000567054168866, "contextu": 4.33984502064, "first": 0.0075872898121599995, "earlier": 0.624742371425, "page": 0.711326032411, "while": 0.04324998379380001, "help": 0.336207721344, "write": 0.721512439877, "larg": 0.17037506060600002, "find": 0.547781330288, "suffici": 1.4613524521099999, "instead": 0.46663315041500003, "inde": 1.4886080966, "when": 0.0205549888584, "user": 2.04258810688, "success": 0.27765441259199997}, "freq": {"base": 2, "occur": 1, "can": 14, "googl": 1, "awar": 2, "then": 3, "too": 3, "erron": 1, "post": 2, "here": 1, "five": 1, "data": 17, "durat": 3, "apr": 1, "averag": 1, "extra": 1, "would": 6, "what": 2, "nois": 1, "experi": 1, "than": 3, "the": 46, "function": 9, "way": 4, "log": 12, "sudden": 1, "well": 3, "product": 5, "whether": 1, "unblock": 1, "percentag": 4, "lambda": 2, "gap": 1, "approach": 1, "dure": 1, "frequenc": 1, "represent": 2, "mode": 1, "check": 2, "announc": 1, "recommend": 1, "burst": 5, "where": 4, "environ": 2, "bound": 1, "least": 1, "spent": 1, "room": 1, "irrespect": 1, "run": 5, "how": 1, "enabl": 1, "quick": 1, "them": 1, "request": 3, "maintain": 1, "whi": 2, "bad": 1, "explain": 1, "distribut": 1, "end": 1, "messag": 1, "interest": 1, "abl": 1, "mani": 1, "will": 4, "associ": 1, "over": 2, "signal": 1, "realli": 1, "second": 1, "rescu": 1, "trace": 10, "new": 1, "below": 1, "perform": 3, "but": 4, "throughout": 1, "userfac": 1, "invoc": 24, "our": 1, "serverless": 2, "longer": 1, "cost": 9, "attent": 1, "inform": 2, "yan": 1, "record": 5, "naiv": 1, "applic": 1, "best": 1, "healthi": 1, "signaltonois": 1, "has": 1, "have": 9, "either": 3, "besid": 1, "take": 1, "use": 7, "follow": 5, "default": 1, "synchron": 3, "further": 4, "configur": 4, "out": 3, "glad": 1, "per": 3, "good": 4, "alway": 1, "possibl": 1, "time": 3, "publish": 5, "number": 2, "break": 1, "issu": 3, "reli": 1, "also": 4, "count": 1, "seven": 1, "everyth": 1, "mean": 1, "not": 2, "cui": 1, "exampl": 2, "infrequ": 2, "signific": 1, "scenario": 2, "becom": 1, "less": 1, "solut": 1, "stand": 1, "like": 3, "they": 4, "metric": 16, "captur": 1, "though": 1, "problem": 2, "sinc": 3, "system": 3, "howev": 3, "last": 1, "allow": 2, "piec": 1, "outcom": 1, "gone": 1, "work": 3, "numm": 2, "span": 1, "which": 2, "furthermor": 1, "such": 3, "activ": 3, "exasper": 1, "simpl": 1, "day": 1, "refer": 1, "itself": 1, "show": 1, "bank": 1, "impact": 1, "custom": 2, "see": 6, "entri": 1, "observ": 11, "becaus": 3, "timeawar": 1, "still": 4, "intellig": 1, "small": 2, "without": 1, "lot": 2, "some": 2, "practic": 1, "collect": 9, "both": 3, "agent": 1, "part": 2, "document": 1, "that": 18, "recent": 2, "ratio": 2, "reliabl": 1, "ani": 1, "sampl": 24, "should": 1, "and": 14, "api": 2, "process": 1, "relat": 1, "down": 1, "similar": 2, "concern": 3, "detail": 1, "num": 8, "variabl": 1, "same": 2, "most": 3, "low": 1, "everi": 6, "stabl": 1, "add": 2, "for": 22, "predict": 1, "breakdown": 1, "builtin": 2, "need": 7, "all": 6, "slow": 2, "with": 7, "reason": 2, "someth": 1, "there": 2, "are": 5, "simpli": 1, "poor": 1, "solv": 1, "compani": 1, "structur": 2, "month": 1, "normal": 1, "debug": 2, "look": 3, "undoubt": 1, "option": 1, "summari": 1, "more": 4, "improv": 2, "spend": 2, "discuss": 3, "asynchron": 4, "these": 2, "traffic": 1, "negat": 1, "latenc": 2, "general": 1, "percentagebas": 2, "cloudwatch": 5, "again": 1, "state": 1, "cut": 1, "storag": 1, "sampler": 7, "wrong": 1, "even": 3, "convers": 1, "give": 2, "total": 1, "onli": 5, "each": 1, "their": 4, "place": 1, "great": 1, "ingest": 1, "industri": 1, "this": 8, "error": 3, "investig": 1, "primari": 1, "common": 2, "big": 2, "type": 1, "block": 1, "reduc": 2, "address": 2, "thundra": 7, "method": 1, "scale": 2, "support": 5, "charg": 1, "repres": 2, "sometim": 1, "come": 2, "origin": 1, "offici": 1, "through": 3, "send": 1, "requir": 2, "from": 2, "contextu": 1, "first": 1, "earlier": 1, "page": 1, "while": 2, "help": 2, "write": 1, "larg": 1, "find": 1, "suffici": 1, "instead": 1, "inde": 1, "when": 10, "user": 1, "success": 2}, "idf": {"base": 1.14628158845, "occur": 1.7453825857499998, "can": 1.17626139142, "googl": 11.388809182200001, "awar": 4.27693965517, "then": 1.08657860516, "too": 1.81585268215, "erron": 23.9096385542, "post": 2.23826307627, "here": 2.42307692308, "five": 1.37740760021, "data": 3.37643555934, "durat": 10.5069490404, "apr": 32.2682926829, "averag": 2.60390355913, "extra": 5.33826496301, "would": 1.0828729281799998, "what": 1.25343439128, "nois": 11.6907216495, "experi": 1.87062566278, "than": 1.03278688525, "the": 1.0, "function": 2.495441685, "way": 1.2190739461, "log": 13.6744186047, "sudden": 5.78993435449, "well": 1.0655748708, "product": 1.62264922322, "whether": 2.20683903253, "unblock": 635.04, "percentag": 6.08275862069, "lambda": 91.2413793103, "gap": 7.302667893280001, "approach": 2.07556543339, "dure": 1.0503473370799998, "frequenc": 8.8102108768, "represent": 5.928304705, "mode": 7.391061452510001, "check": 6.50655737705, "announc": 2.02940048575, "recommend": 3.9142011834300003, "burst": 15.9879154079, "where": 1.06715063521, "environ": 3.43561999567, "bound": 5.40735694823, "least": 1.6165359943000002, "spent": 3.00795755968, "room": 3.07674418605, "irrespect": 54.5567010309, "run": 1.55692850838, "how": 1.60250328051, "enabl": 3.5421686747, "quick": 2.205, "them": 1.09876115994, "request": 3.09051975861, "maintain": 1.77306231852, "whi": 3.2566153846200003, "bad": 3.3944836433599996, "explain": 2.60049140049, "distribut": 2.7396031061299997, "end": 1.10680423871, "messag": 4.96745932416, "interest": 1.60331246213, "abl": 1.8208510150200001, "mani": 1.04426757877, "will": 1.22481098596, "associ": 1.3263157894700002, "over": 1.02525024217, "signal": 5.12459651388, "realli": 4.7476076555, "second": 1.1130898128, "rescu": 6.3656776263, "trace": 4.4408391608399995, "new": 1.0178880554, "below": 2.25607503197, "perform": 1.5313977042500002, "but": 1.01632417899, "throughout": 1.5217099587799998, "userfac": 635.04, "invoc": 98.0, "our": 2.35758835759, "serverless": 635.04, "longer": 2.02319357716, "cost": 2.31935719503, "attent": 2.81040892193, "inform": 1.5753125620200001, "yan": 78.2068965517, "record": 1.42334588488, "naiv": 50.2405063291, "applic": 3.42672134686, "best": 1.5828514456600002, "healthi": 12.520504731900001, "signaltonois": 635.04, "has": 1.0436497502, "have": 1.0148948411399998, "either": 1.5830092731099998, "besid": 5.1362018764199995, "take": 1.13961668222, "use": 1.0296387573799999, "follow": 1.04640126549, "default": 21.1398135819, "synchron": 26.0262295082, "further": 1.3618116315, "configur": 11.504347826099998, "out": 1.06016694491, "glad": 34.3636363636, "per": 1.9597580545599997, "good": 1.51981619759, "alway": 2.06745670009, "possibl": 1.4173734488, "time": 1.01127460348, "publish": 1.36885669943, "number": 1.10142916609, "break": 2.42863698944, "issu": 1.43921675279, "reli": 4.16146788991, "also": 1.01476510067, "count": 3.48157894737, "seven": 1.93940874664, "everyth": 4.81967213115, "mean": 1.44906900329, "not": 1.01567398119, "cui": 288.654545455, "exampl": 1.50483412322, "infrequ": 35.7567567568, "signific": 1.4529147982100001, "scenario": 15.3986420951, "becom": 1.12492028626, "less": 1.46904783936, "solut": 4.7278141751, "stand": 2.0845588235299997, "like": 1.14918566775, "they": 1.03017325287, "metric": 22.235294117600002, "captur": 2.88026124819, "though": 1.36076112111, "problem": 1.76674827509, "sinc": 1.08368600683, "system": 1.38739840951, "howev": 1.0945191313299998, "last": 1.2117234010100002, "allow": 1.2716059271100002, "piec": 3.24132298898, "outcom": 7.48867924528, "gone": 5.22408687068, "work": 1.11520089913, "numm": 18.8775267539, "span": 6.17262830482, "which": 1.005191845, "furthermor": 5.50294627383, "such": 1.06151377374, "activ": 1.46403541129, "exasper": 134.542372881, "simpl": 3.3981164383599998, "day": 1.18371607516, "refer": 1.30024570025, "itself": 1.74557449148, "show": 1.26703910615, "bank": 2.87400434468, "impact": 2.97526236882, "custom": 3.6346153846199996, "see": 1.27242125511, "entri": 3.9909502262400003, "observ": 2.22446406053, "becaus": 1.1495184997499999, "timeawar": 635.04, "still": 1.1866357724799999, "intellig": 4.19334389857, "small": 1.3594793629, "without": 1.29547123623, "lot": 4.40877534018, "some": 1.04036697248, "practic": 1.70434782609, "collect": 1.64109985528, "both": 1.05215720061, "agent": 4.25858369099, "part": 1.04330682789, "document": 2.5409731114, "that": 1.00398406375, "recent": 1.54405757635, "ratio": 7.21308496138, "reliabl": 6.681818181819999, "ani": 1.13383802314, "sampl": 7.23280182232, "should": 1.6643254009900001, "and": 1.00006299213, "api": 84.44680851060001, "process": 1.69524826482, "relat": 1.23750876919, "down": 1.35889754344, "similar": 1.37514075357, "concern": 1.8852867830400002, "detail": 2.26186066391, "num": 1.00031504001, "variabl": 8.747107438019999, "same": 1.11857958148, "most": 1.02096463023, "low": 2.13072070863, "everi": 1.47917637194, "stabl": 6.70156184044, "add": 4.61243463103, "for": 1.00031504001, "predict": 5.18484650555, "breakdown": 15.0483412322, "builtin": 635.04, "need": 1.4372623574099999, "all": 1.01146788991, "slow": 4.04793472718, "with": 1.0011982089899998, "reason": 1.72340425532, "someth": 3.28152128979, "there": 1.04091266719, "are": 1.02990593578, "simpli": 2.5192002538900002, "poor": 2.42196796339, "solv": 7.26923076923, "compani": 1.5523613963, "structur": 2.0580762250499998, "month": 1.5079787234, "normal": 2.61075481006, "debug": 180.409090909, "look": 1.9086318826599997, "undoubt": 27.0459965928, "option": 4.04896710023, "summari": 7.80147420147, "more": 1.0171706817, "improv": 2.04376930999, "spend": 4.15928739848, "discuss": 2.19676214197, "asynchron": 165.375, "these": 1.07415426252, "traffic": 5.95052473763, "negat": 3.75852272727, "latenc": 174.46153846200002, "general": 1.1218202374200001, "percentagebas": 635.04, "cloudwatch": 635.04, "again": 1.50883862384, "state": 1.0477133240899998, "cut": 2.4663663197099996, "storag": 8.623574144489998, "sampler": 151.2, "wrong": 5.478260869570001, "even": 1.16461267606, "convers": 3.3486606201200004, "give": 1.3653250774, "total": 1.5460122699399999, "onli": 1.0256476516600002, "each": 1.18974820144, "their": 1.01547908405, "place": 1.1004366812200002, "great": 1.26592775696, "ingest": 42.449197861, "industri": 2.02319357716, "this": 1.00379362671, "error": 6.04109589041, "investig": 3.11721971333, "primari": 2.2373167981999997, "common": 1.4025974025999999, "big": 2.7400759406299997, "type": 2.0281042411900003, "block": 3.20274359492, "reduc": 1.98698372966, "address": 2.86157173756, "thundra": 635.04, "method": 2.5714285714300003, "scale": 3.7469907953699995, "support": 1.2685577307200002, "charg": 2.3653158522099997, "repres": 1.46972782818, "sometim": 1.7126213592200001, "come": 1.32831325301, "origin": 1.13724928367, "offici": 1.40483143085, "through": 1.07074930869, "send": 3.75053153792, "requir": 1.52844902282, "from": 1.00056721497, "contextu": 76.6956521739, "first": 1.00761614623, "earlier": 1.86776470588, "page": 2.03669018602, "while": 1.0441988950299999, "help": 1.39962972759, "write": 2.0575427682700003, "larg": 1.18574949585, "find": 1.7294117647099998, "suffici": 4.3117870722400005, "instead": 1.59461631177, "inde": 4.43092380687, "when": 1.02076769755, "user": 7.71053909665, "success": 1.32002993265}}, "html": "<!DOCTYPE html>\n<html xmlns:cc=\"http://creativecommons.org/ns#\"><head prefix=\"og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#\"><meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/><meta content=\"width=device-width, initial-scale=1.0, viewport-fit=contain\" name=\"viewport\"/><title>Serverless observability without Breaking the Bank \u2013 Predict \u2013 Medium</title><link href=\"https://blog.thundra.io/observability-without-breaking-the-bank\" rel=\"canonical\"/><meta content=\"Serverless observability without Breaking the Bank \u2013 Predict \u2013 Medium\" name=\"title\"/><meta content=\"origin\" name=\"referrer\"/><meta content=\"To run a serverless application in production reliably, you need to be able to debug issues quickly. You need to have good observability, and having structured logs is a big part of that. They allow\u2026\" name=\"description\"/><meta content=\"#000000\" name=\"theme-color\"/><meta content=\"Serverless observability without Breaking the Bank\" property=\"og:title\"/><meta content=\"Serverless observability without Breaking the Bank\" property=\"twitter:title\"/><meta content=\"https://medium.com/predict/serverless-observability-without-breaking-the-bank-eee84f0b5ee1\" property=\"og:url\"/><meta content=\"https://cdn-images-1.medium.com/max/1200/0*pIKFPZ-lpjJi-g-3.png\" property=\"og:image\"/><meta content=\"542599432471018\" property=\"fb:app_id\"/><meta content=\"To run a serverless application in production reliably, you need to be able to debug issues quickly. You need to have good observability\u2026\" property=\"og:description\"/><meta content=\"To run a serverless application in production reliably, you need to be able to debug issues quickly. You need to have good observability\u2026\" name=\"twitter:description\"/><meta content=\"https://cdn-images-1.medium.com/max/1200/0*pIKFPZ-lpjJi-g-3.png\" name=\"twitter:image:src\"/><link href=\"https://medium.com/@theburningmonk\" rel=\"author\"/><meta content=\"Yan Cui\" name=\"author\"/><meta content=\"article\" property=\"og:type\"/><meta content=\"summary_large_image\" name=\"twitter:card\"/><meta content=\"https://www.facebook.com/medium\" property=\"article:publisher\"/><meta content=\"https://medium.com/@theburningmonk\" property=\"article:author\"/><meta content=\"index, follow\" name=\"robots\"/><meta content=\"2019-04-23T15:33:57.594Z\" property=\"article:published_time\"/><meta content=\"@theburningmonk\" name=\"twitter:creator\"/><meta content=\"@Medium\" name=\"twitter:site\"/><meta content=\"Medium\" property=\"og:site_name\"/><meta name=\"twitter:label1\" value=\"Reading time\"/><meta name=\"twitter:data1\" value=\"6 min read\"/><meta content=\"Medium\" name=\"twitter:app:name:iphone\"/><meta content=\"828256236\" name=\"twitter:app:id:iphone\"/><meta content=\"medium://p/eee84f0b5ee1\" name=\"twitter:app:url:iphone\"/><meta content=\"Medium\" property=\"al:ios:app_name\"/><meta content=\"828256236\" property=\"al:ios:app_store_id\"/><meta content=\"com.medium.reader\" property=\"al:android:package\"/><meta content=\"Medium\" property=\"al:android:app_name\"/><meta content=\"medium://p/eee84f0b5ee1\" property=\"al:ios:url\"/><meta content=\"medium://p/eee84f0b5ee1\" property=\"al:android:url\"/><meta content=\"https://medium.com/predict/serverless-observability-without-breaking-the-bank-eee84f0b5ee1\" property=\"al:web:url\"/><link href=\"/osd.xml\" rel=\"search\" title=\"Medium\" type=\"application/opensearchdescription+xml\"><link href=\"android-app://com.medium.reader/https/medium.com/p/eee84f0b5ee1\" rel=\"alternate\"><script type=\"application/ld+json\">{\"@context\":\"http://schema.org\",\"@type\":\"NewsArticle\",\"image\":{\"@type\":\"ImageObject\",\"width\":1200,\"height\":675,\"url\":\"https://cdn-images-1.medium.com/max/2400/0*pIKFPZ-lpjJi-g-3.png\"},\"url\":\"https://blog.thundra.io/observability-without-breaking-the-bank\",\"dateCreated\":\"2019-04-23T15:33:57.594Z\",\"datePublished\":\"2019-04-23T15:33:57.594Z\",\"dateModified\":\"2019-04-23T18:13:46.609Z\",\"headline\":\"Serverless observability without Breaking the Bank\",\"name\":\"Serverless observability without Breaking the Bank\",\"articleId\":\"eee84f0b5ee1\",\"thumbnailUrl\":\"https://cdn-images-1.medium.com/max/2400/0*pIKFPZ-lpjJi-g-3.png\",\"keywords\":[\"Tag:AWS\",\"Tag:AWS Lambda\",\"Tag:Serverless\",\"Tag:Cloud\",\"Tag:Cloud Computing\",\"Publication:predict\",\"LockedPostSource:1\",\"Elevated:false\",\"LayerCake:4\"],\"author\":{\"@type\":\"Person\",\"name\":\"Yan Cui\",\"url\":\"https://medium.com/@theburningmonk\"},\"creator\":[\"Yan Cui\"],\"publisher\":{\"@type\":\"Organization\",\"name\":\"Predict\",\"url\":\"https://medium.com/predict\",\"logo\":{\"@type\":\"ImageObject\",\"width\":308,\"height\":60,\"url\":\"https://cdn-images-1.medium.com/max/616/1*OMF3fSqH8t4xBJ9-6oZDZw.png\"}},\"mainEntityOfPage\":\"https://blog.thundra.io/observability-without-breaking-the-bank\"}</script><meta content=\"https://medium.com/predict/serverless-observability-without-breaking-the-bank-eee84f0b5ee1\" name=\"parsely-link\"/><link class=\"js-glyph-\" href=\"https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css\" id=\"glyph-8\" rel=\"stylesheet\" type=\"text/css\"/><link href=\"https://cdn-static-1.medium.com/_/fp/css/main-branding-base.sMRbh_65n82B91860QdvTg.css\" rel=\"stylesheet\"/><script>!function(n,e){var t,o,i,c=[],f={passive:!0,capture:!0},r=new Date,a=\"pointerup\",u=\"pointercancel\";function p(n,c){t||(t=c,o=n,i=new Date,w(e),s())}function s(){o>=0&&o<i-r&&(c.forEach(function(n){n(o,t)}),c=[])}function l(t){if(t.cancelable){var o=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;\"pointerdown\"==t.type?function(t,o){function i(){p(t,o),r()}function c(){r()}function r(){e(a,i,f),e(u,c,f)}n(a,i,f),n(u,c,f)}(o,t):p(o,t)}}function w(n){[\"click\",\"mousedown\",\"keydown\",\"touchstart\",\"pointerdown\"].forEach(function(e){n(e,l,f)})}w(n),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){c.push(n),s()}}(addEventListener,removeEventListener);</script><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener(\"error\", _onerror, true); else if (document.attachEvent) document.attachEvent(\"onerror\", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName(\"script\")[0], s = d.createElement(\"script\"); s.type = \"text/javascript\"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName(\"script\")[0], s = d.createElement(\"link\"); s.rel = \"stylesheet\"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = \"/_/stat?event=pixel.load&origin=\" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga(\"create\", \"UA-24232453-2\", \"auto\", {\"allowLinker\": true, \"legacyCookieDomain\": window.location.hostname}); ga(\"send\", \"pageview\");</script><script async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><!--[if lt IE 9]><script charset=\"UTF-8\" src=\"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js\"></script><![endif]--><link class=\"js-favicon\" href=\"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico\" rel=\"icon\"/><link href=\"https://cdn-images-1.medium.com/fit/c/304/304/1*tqCurXdzmPFYiuXrXD9Vuw.png\" rel=\"apple-touch-icon\" sizes=\"152x152\"/><link href=\"https://cdn-images-1.medium.com/fit/c/240/240/1*tqCurXdzmPFYiuXrXD9Vuw.png\" rel=\"apple-touch-icon\" sizes=\"120x120\"/><link href=\"https://cdn-images-1.medium.com/fit/c/152/152/1*tqCurXdzmPFYiuXrXD9Vuw.png\" rel=\"apple-touch-icon\" sizes=\"76x76\"/><link href=\"https://cdn-images-1.medium.com/fit/c/120/120/1*tqCurXdzmPFYiuXrXD9Vuw.png\" rel=\"apple-touch-icon\" sizes=\"60x60\"/><link color=\"#171717\" href=\"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg\" rel=\"mask-icon\"/></link></link></head><body class=\"postShowScreen browser-chrome os-windows is-withMagicUnderlines v-glyph v-glyph--m2 is-noJs\" itemscope=\"\"><script>document.body.className = document.body.className.replace(/(^|\\s)is-noJs(\\s|$)/, \"$1is-js$2\")</script><div class=\"site-main\" id=\"container\"><div class=\"butterBar butterBar--error\"></div><div class=\"surface\"><div class=\"screenContent\" id=\"prerendered\"><canvas class=\"canvas-renderer\"></canvas><div class=\"container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer\"></div><div class=\"metabar u-clearfix u-boxShadow4px12pxBlackLightest u-fixed u-backgroundTransparentWhiteDarkest u-xs-sizeFullViewportWidth js-metabar\"><div class=\"branch-journeys-top\"></div><div class=\"js-metabarMiddle metabar-inner u-marginAuto u-maxWidth1032 u-flexCenter u-justifyContentSpaceBetween u-height65 u-xs-height56 u-paddingHorizontal20\"><div class=\"metabar-block u-flex1 u-flexCenter\"><div class=\"u-xs-hide js-metabarLogoLeft\"><a class=\"siteNav-logo u-fillTransparentBlackDarker u-flex0 u-flexCenter u-paddingTop0\" data-log-event=\"home\" href=\"https://medium.com/\"><span class=\"svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-flex0 u-flexCenter u-paddingTop0\"><svg class=\"svgIcon-use\" height=\"45\" width=\"45\"><path d=\"M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z\"></path></svg></span><span class=\"u-textScreenReader\">Homepage</span></a></div><div class=\"u-xs-show js-metabarLogoLeft\"><a class=\"siteNav-logo u-fillTransparentBlackDarker u-flex0 u-flexCenter u-paddingTop0\" data-log-event=\"home\" href=\"https://medium.com/\"><span class=\"svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-flex0 u-flexCenter u-paddingTop0\"><svg class=\"svgIcon-use\" height=\"45\" width=\"45\"><path d=\"M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z\"></path></svg></span><span class=\"u-textScreenReader\">Homepage</span></a></div><div class=\"u-flexCenter u-height65 u-xs-height56\"><span class=\"u-inlineBlock u-height28 u-xs-height24 u-verticalAlignTop u-marginRight20 u-marginLeft15 u-borderRightLighter\"></span></div><div class=\"u-flexCenter u-height65 u-xs-height56 u-marginRight18\"><div class=\"u-xs-show\"><a aria-label=\"Go to Predict\" class=\"link u-baseColor--link avatar avatar--roundedRectangle\" data-action-source=\"avatar-lo_qLnTxMBcnCtF-661161fab0d0\" href=\"https://medium.com/predict?source=avatar-lo_qLnTxMBcnCtF-661161fab0d0\" title=\"Go to Predict\"><img alt=\"Predict\" class=\"avatar-image avatar-image--icon\" src=\"https://cdn-images-1.medium.com/fit/c/64/64/1*tqCurXdzmPFYiuXrXD9Vuw.png\"/></a></div><div class=\"u-xs-hide\"><a class=\"u-flexCenter js-collectionLogoOrName\" href=\"https://medium.com/predict?source=logo-lo_qLnTxMBcnCtF---661161fab0d0\"><span class=\"u-noWrapWithEllipsis u-maxWidth1032 u-uiTextBold u-fontSize26 u-textColorDarker\">Predict</span></a></div></div></div><div class=\"metabar-block u-flex0 u-flexCenter\"><div class=\"u-flexCenter u-height65 u-xs-height56\"><div class=\"buttonSet buttonSet--wide u-lineHeightInherit\"><a class=\"button button--primary button--chromeless u-accentColor--buttonNormal is-inSiteNavBar u-xs-hide js-signInButton\" data-action=\"sign-in-prompt\" data-action-source=\"--------------------------nav_reg\" data-redirect=\"https://medium.com/predict/serverless-observability-without-breaking-the-bank-eee84f0b5ee1\" href=\"https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2Fpredict%2Fserverless-observability-without-breaking-the-bank-eee84f0b5ee1&amp;source=--------------------------nav_reg&amp;operation=login\">Sign in</a><a class=\"button button--primary button--withChrome u-accentColor--buttonNormal is-inSiteNavBar js-signUpButton\" data-action=\"sign-up-prompt\" data-action-source=\"--------------------------nav_reg\" data-redirect=\"https://medium.com/predict/serverless-observability-without-breaking-the-bank-eee84f0b5ee1\" href=\"https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2Fpredict%2Fserverless-observability-without-breaking-the-bank-eee84f0b5ee1&amp;source=--------------------------nav_reg&amp;operation=register\">Get started</a></div></div></div></div></div><div class=\"metabar metabar--spacer js-metabarSpacer u-height65 u-xs-height56\"></div><main role=\"main\"><article class=\"u-minHeight100vhOffset65 u-overflowHidden postArticle postArticle--full is-withAccentColors u-marginBottom40\" lang=\"en\"><div class=\"postArticle-content js-postField js-notesSource js-trackPostScrolls\" data-collection-id=\"661161fab0d0\" data-post-id=\"eee84f0b5ee1\" data-source=\"post_page\" data-tracking-context=\"postPage\"><section class=\"section section--body section--first\" name=\"dcc3\"><div class=\"section-divider\"><hr class=\"section-divider\"/></div><div class=\"section-content\"><div class=\"section-inner sectionLayout--insetColumn\"><h1 class=\"graf graf--h3 graf--leading graf--title\" id=\"1518\" name=\"1518\">Serverless observability without Breaking the\u00a0Bank</h1><div class=\"uiScale uiScale-ui--regular uiScale-caption--regular u-flexCenter u-marginVertical24 u-fontSize15 js-postMetaLockup\"><div class=\"u-flex0\"><a class=\"link u-baseColor--link avatar\" data-action=\"show-user-card\" data-action-source=\"post_header_lockup\" data-action-type=\"hover\" data-action-value=\"d00f1e6b06a2\" data-user-id=\"d00f1e6b06a2\" dir=\"auto\" href=\"https://medium.com/@theburningmonk?source=post_header_lockup\"><div class=\"u-relative u-inlineBlock u-flex0\"><img alt=\"Go to the profile of Yan Cui\" class=\"avatar-image u-size50x50\" src=\"https://cdn-images-1.medium.com/fit/c/100/100/1*7emMqp-VkGhDNtk50Lg79Q.jpeg\"/><div class=\"avatar-halo u-absolute u-textColorGreenNormal svgIcon\" style=\"width: calc(100% + 10px); height: calc(100% + 10px); top:-5px; left:-5px\"><svg viewbox=\"0 0 70 70\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M5.53538374,19.9430227 C11.180401,8.78497536 22.6271155,1.6 35.3571429,1.6 C48.0871702,1.6 59.5338847,8.78497536 65.178902,19.9430227 L66.2496695,19.401306 C60.4023065,7.84329843 48.5440457,0.4 35.3571429,0.4 C22.17024,0.4 10.3119792,7.84329843 4.46461626,19.401306 L5.53538374,19.9430227 Z\"></path><path d=\"M65.178902,49.9077131 C59.5338847,61.0657604 48.0871702,68.2507358 35.3571429,68.2507358 C22.6271155,68.2507358 11.180401,61.0657604 5.53538374,49.9077131 L4.46461626,50.4494298 C10.3119792,62.0074373 22.17024,69.4507358 35.3571429,69.4507358 C48.5440457,69.4507358 60.4023065,62.0074373 66.2496695,50.4494298 L65.178902,49.9077131 Z\"></path></svg></div></div></a></div><div class=\"u-flex1 u-paddingLeft15 u-overflowHidden\"><div class=\"u-paddingBottom3\"><a class=\"ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker\" data-action=\"show-user-card\" data-action-type=\"hover\" data-action-value=\"d00f1e6b06a2\" data-user-id=\"d00f1e6b06a2\" dir=\"auto\" href=\"https://medium.com/@theburningmonk\">Yan Cui</a><span class=\"followState js-followState\" data-user-id=\"d00f1e6b06a2\"><button class=\"button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide\" data-action=\"sign-up-prompt\" data-action-source=\"post_header_lockup\" data-redirect=\"https://medium.com/predict/serverless-observability-without-breaking-the-bank-eee84f0b5ee1\" data-requires-token=\"true\" data-sign-in-action=\"toggle-block-user\"><span class=\"button-label button-defaultState\">Blocked</span><span class=\"button-label button-hoverState\">Unblock</span></button><button class=\"button button--primary button--smallest button--dark u-noUserSelect button--withChrome u-accentColor--buttonDark button--follow js-followButton u-marginLeft10 u-xs-hide\" data-action=\"sign-up-prompt\" data-action-source=\"post_header_lockup-d00f1e6b06a2-------------------------follow_byline\" data-redirect=\"https://medium.com/_/subscribe/user/d00f1e6b06a2\" data-requires-token=\"true\" data-sign-in-action=\"toggle-subscribe-user\"><span class=\"button-label button-defaultState js-buttonLabel\">Follow</span><span class=\"button-label button-activeState\">Following</span></button></span></div><div class=\"ui-caption u-noWrapWithEllipsis js-testPostMetaInlineSupplemental\"><time datetime=\"2019-04-23T15:33:57.594Z\">Apr 23</time><span class=\"middotDivider u-fontSize12\"></span><span class=\"readingTime\" title=\"6 min read\"></span><span class=\"u-paddingLeft4\"><span class=\"svgIcon svgIcon--star svgIcon--15px\"><svg class=\"svgIcon-use\" height=\"15\" width=\"15\"><path d=\"M7.438 2.324c.034-.099.09-.099.123 0l1.2 3.53a.29.29 0 0 0 .26.19h3.884c.11 0 .127.049.038.111L9.8 8.327a.271.271 0 0 0-.099.291l1.2 3.53c.034.1-.011.131-.098.069l-3.142-2.18a.303.303 0 0 0-.32 0l-3.145 2.182c-.087.06-.132.03-.099-.068l1.2-3.53a.271.271 0 0 0-.098-.292L2.056 6.146c-.087-.06-.071-.112.038-.112h3.884a.29.29 0 0 0 .26-.19l1.2-3.52z\"></path></svg></span></span></div></div></div><figure class=\"graf graf--figure graf-after--h3\" id=\"ae88\" name=\"ae88\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 394px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 56.3%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*pIKFPZ-lpjJi-g-3.png\" data-height=\"675\" data-image-id=\"0*pIKFPZ-lpjJi-g-3.png\" data-is-featured=\"true\" data-width=\"1200\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*pIKFPZ-lpjJi-g-3.png?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*pIKFPZ-lpjJi-g-3.png\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*pIKFPZ-lpjJi-g-3.png\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"62b0\" name=\"62b0\">To run a serverless application in production reliably, you need to be able to debug issues quickly. You need to have good observability, and having structured logs is a big part of that. They allow you to capture useful contextual information with each log message.</p><p class=\"graf graf--p graf-after--p\" id=\"0f49\" name=\"0f49\">But observability comes with a cost.</p><h3 class=\"graf graf--h3 graf-after--p\" id=\"b325\" name=\"b325\">The Problem</h3><p class=\"graf graf--p graf-after--h3\" id=\"06c6\" name=\"06c6\">CloudWatch Logs charges $0.50 for per GB of data ingested, and $0.03 per GB per month for storage. As such, it\u2019s common for companies to spend more on CloudWatch Logs than Lambda invocations in their production environment. Best practices such as using structured logs further exasperate the cost associated with logging.</p><figure class=\"graf graf--figure graf-after--p\" id=\"0be1\" name=\"0be1\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 342px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 48.8%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*ZrkWuVBPF0JgeA8I\" data-height=\"420\" data-image-id=\"0*ZrkWuVBPF0JgeA8I\" data-width=\"860\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*ZrkWuVBPF0JgeA8I?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*ZrkWuVBPF0JgeA8I\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*ZrkWuVBPF0JgeA8I\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"1357\" name=\"1357\">Furthermore, with AWS Lambda, it\u2019s no longer possible to rely on agents to collect and publish observability data such as custom metrics and traces. Instead, you have to either:</p><ul class=\"postList\"><li class=\"graf graf--li graf-after--p\" id=\"db0f\" name=\"db0f\">publish data synchronously as part of a function invocation</li><li class=\"graf graf--li graf-after--li\" id=\"ad3e\" name=\"ad3e\">publish data asynchronously through CloudWatch Logs</li></ul><p class=\"graf graf--p graf-after--li\" id=\"df50\" name=\"df50\">Publishing data synchronously adds latency to your invocation. When it comes to APIs this extra latency becomes user-facing and negatively impacts your user experience. Which is why it\u2019s generally recommended that you collect observability data for APIs asynchronously. However, collecting data through CloudWatch Logs further adds to its cost.</p><p class=\"graf graf--p graf-after--p\" id=\"fdd6\" name=\"fdd6\">In this post, we\u2019ll see how we can use sampling to address this cost concern, and check out the built-in sampling support in Thundra.</p><h3 class=\"graf graf--h3 graf-after--p\" id=\"cd78\" name=\"cd78\">Sampling to the\u00a0rescue</h3><p class=\"graf graf--p graf-after--h3\" id=\"80ae\" name=\"80ae\">If the primary reason why we needed observability in the first place is to help us debug issues in production. And if most requests are processed successfully, then it stands to reason that we should:</p><ul class=\"postList\"><li class=\"graf graf--li graf-after--p\" id=\"0356\" name=\"0356\">Collect data for all erroneous or poor performing invocations. Because they represent invocations that require our attention.</li><li class=\"graf graf--li graf-after--li\" id=\"8ccf\" name=\"8ccf\">Collect data for a small percentage of successful invocations. So that we always have some representation of what a \u201cgood\u201d invocation looks like.</li></ul><p class=\"graf graf--p graf-after--li\" id=\"c37a\" name=\"c37a\">In the most naive approach, we can also sample data from a percentage of all invocations irrespective of their outcome or performance. That way, we can reduce the cost of logging while still maintaining the same distribution of good and bad invocations.</p><p class=\"graf graf--p graf-after--p\" id=\"b775\" name=\"b775\">With a sufficient number of invocations, you only need a small percentage of them to have representative data for every scenario. Indeed, the industry average is to sample 1% of all requests. The likes of Google would sample at 0.01% because their scale is so big that even 0.01% of requests would give you good representation for every scenario.</p><h4 class=\"graf graf--h4 graf-after--p\" id=\"140b\" name=\"140b\">Intelligent sampling with\u00a0Thundra</h4><p class=\"graf graf--p graf-after--h4\" id=\"1346\" name=\"1346\">Thundra supports both synchronous and asynchronous modes of collecting data. But collecting data asynchronously requires you to send a lot of data to CloudWatch Logs. By default, Thundra records at least seven pieces of data for every invocation (see below).</p><figure class=\"graf graf--figure graf-after--p\" id=\"f442\" name=\"f442\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 118px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 16.900000000000002%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*SE87_NhU2-ar8lXQ.png\" data-height=\"338\" data-image-id=\"0*SE87_NhU2-ar8lXQ.png\" data-width=\"1999\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*SE87_NhU2-ar8lXQ.png?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*SE87_NhU2-ar8lXQ.png\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*SE87_NhU2-ar8lXQ.png\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"9941\" name=\"9941\">That is a total of 16KB of observability data for every invocation! It undoubtedly is a cost concern when running at scale. So I\u2019m really glad that Thundra recently announced sampling support.</p><h4 class=\"graf graf--h4 graf-after--p\" id=\"12e8\" name=\"12e8\">Sampling metrics</h4><p class=\"graf graf--p graf-after--h4\" id=\"faa6\" name=\"faa6\">For metrics, you can use the <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://docs.thundra.io/docs/node-sampling-support#section-count-aware-sampler\" href=\"https://docs.thundra.io/docs/node-sampling-support#section-count-aware-sampler\" rel=\"nofollow noopener nofollow noopener\" target=\"_blank\">count aware sampler</a> to do simple percentage-based sampling. What\u2019s more interesting though, is the <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://docs.thundra.io/docs/node-sampling-support#section-time-aware-sampler\" href=\"https://docs.thundra.io/docs/node-sampling-support#section-time-aware-sampler\" rel=\"nofollow noopener nofollow noopener\" target=\"_blank\">time aware sampler</a>. It allows you to sample metrics based on a configured frequency.</p><p class=\"graf graf--p graf-after--p\" id=\"7a0e\" name=\"7a0e\">Percentage-based sampling works well when you have stable, predictable traffic. All the way throughout the day, you will have metrics for a percentage of invocations.</p><figure class=\"graf graf--figure graf-after--p\" id=\"a13f\" name=\"a13f\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 263px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 37.6%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*La0NZ8C8Pf0ZTLW0\" data-height=\"286\" data-image-id=\"0*La0NZ8C8Pf0ZTLW0\" data-width=\"761\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*La0NZ8C8Pf0ZTLW0?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*La0NZ8C8Pf0ZTLW0\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*La0NZ8C8Pf0ZTLW0\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"9c01\" name=\"9c01\">But it doesn\u2019t work well for functions that run in bursts. If a function runs infrequently and we only collect metrics on 1% of its invocations, then there will be large gaps in time where we don\u2019t have any metrics at all. Conversely, if this function sees a sudden burst of activities, we will collect lots of metrics during that burst. However, since all the metrics relate to the same burst of activities, they are bound to be similar too. Which means their signal-to-noise ratio is low.</p><figure class=\"graf graf--figure graf-after--p\" id=\"43d8\" name=\"43d8\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 350px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 50.1%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*kZTOoQfLAY3yfsVv\" data-height=\"463\" data-image-id=\"0*kZTOoQfLAY3yfsVv\" data-width=\"925\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*kZTOoQfLAY3yfsVv?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*kZTOoQfLAY3yfsVv\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*kZTOoQfLAY3yfsVv\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"bcb3\" name=\"bcb3\">The time-aware sampler solves this because when the function runs infrequently, it\u2019ll simply record metrics for every invocation. When the function sees a burst of activities, it\u2019ll also not record too many metrics either.</p><figure class=\"graf graf--figure graf-after--p\" id=\"f03a\" name=\"f03a\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 264px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 37.7%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*wHDMEoSIWDJDcWO-\" data-height=\"290\" data-image-id=\"0*wHDMEoSIWDJDcWO-\" data-width=\"769\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*wHDMEoSIWDJDcWO-?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*wHDMEoSIWDJDcWO-\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*wHDMEoSIWDJDcWO-\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"fa21\" name=\"fa21\">Take the following function as an example, it\u2019ll record metrics every five seconds.</p><figure class=\"graf graf--figure graf-after--p\" id=\"1851\" name=\"1851\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 585px; max-height: 475px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 81.2%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-height=\"475\" data-image-id=\"0*RqFktdd4awktJkro\" data-width=\"585\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*RqFktdd4awktJkro?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*RqFktdd4awktJkro\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*RqFktdd4awktJkro\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"c6a3\" name=\"c6a3\">You can see from its logs that invocations that are less than 5s since the last sampled metric would not record metrics.</p><figure class=\"graf graf--figure graf-after--p\" id=\"090f\" name=\"090f\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 354px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 50.5%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*DyOokVN3p-gb4gdy\" data-height=\"417\" data-image-id=\"0*DyOokVN3p-gb4gdy\" data-width=\"825\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*DyOokVN3p-gb4gdy?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*DyOokVN3p-gb4gdy\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*DyOokVN3p-gb4gdy\"/></noscript></div></div></figure><h4 class=\"graf graf--h4 graf-after--figure\" id=\"3bf3\" name=\"3bf3\">Sampling traces</h4><p class=\"graf graf--p graf-after--h4\" id=\"44ba\" name=\"44ba\">For traces, you can enable sampling based on the duration of invocations as well as whether they ended in an error state.</p><p class=\"graf graf--p graf-after--p\" id=\"82eb\" name=\"82eb\">For example, the following configuration would sample trace data only when the duration of an invocation is over 500ms. That is, \u201cshow me the breakdown of where invocation time was spent if the function is slow\u201d.</p><figure class=\"graf graf--figure graf-after--p\" id=\"0707\" name=\"0707\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 587px; max-height: 260px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 44.3%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-height=\"260\" data-image-id=\"0*ECa6T3T6BcTyCcGX\" data-width=\"587\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*ECa6T3T6BcTyCcGX?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*ECa6T3T6BcTyCcGX\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*ECa6T3T6BcTyCcGX\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"f437\" name=\"f437\">Again, if you look at the logs for this function. You will see an entry with type \u201cSpan\u201d only when the invocation duration was over 500ms.</p><figure class=\"graf graf--figure graf-after--p\" id=\"6bed\" name=\"6bed\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 257px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 36.7%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*Abz1VWw7eaboY5PK\" data-height=\"324\" data-image-id=\"0*Abz1VWw7eaboY5PK\" data-width=\"884\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*Abz1VWw7eaboY5PK?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*Abz1VWw7eaboY5PK\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*Abz1VWw7eaboY5PK\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"fce6\" name=\"fce6\">Similarly, the following configuration would sample traces only when the invocation errors.</p><figure class=\"graf graf--figure graf-after--p\" id=\"a1e0\" name=\"a1e0\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 577px; max-height: 215px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 37.3%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-height=\"215\" data-image-id=\"0*wHDusfjxhxtff1Ke\" data-width=\"577\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*wHDusfjxhxtff1Ke?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*wHDusfjxhxtff1Ke\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*wHDusfjxhxtff1Ke\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"b41c\" name=\"b41c\">As discussed earlier, both of these sampling options are great for improving the signal to noise ratio. Since detailed traces are most useful when something has gone wrong. Either the invocation was slow and we need to investigate where the performance issue is. Or the invocation erred and we need to find out where did the error occur.</p><p class=\"graf graf--p graf-after--p\" id=\"6a91\" name=\"6a91\">However, I would still like traces to be sample even when everything is working normally. That way, I can have a sample of healthy invocations that I can use as a reference.</p><p class=\"graf graf--p graf-after--p\" id=\"6a4c\" name=\"6a4c\">Besides the sampling methods we discussed here, you can also write <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://docs.thundra.io/docs/node-sampling-support#section-custom-sampler\" href=\"https://docs.thundra.io/docs/node-sampling-support#section-custom-sampler\" rel=\"nofollow noopener nofollow noopener\" target=\"_blank\">custom samplers</a> for both metrics and traces. You can also configure samplers through environment variables too. For more information on the sampling support, check out the official <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://docs.thundra.io/docs/node-sampling-support\" href=\"https://docs.thundra.io/docs/node-sampling-support\" rel=\"nofollow noopener nofollow noopener\" target=\"_blank\">documentation page</a>.</p><h3 class=\"graf graf--h3 graf-after--p\" id=\"bdf3\" name=\"bdf3\">Summary</h3><p class=\"graf graf--p graf-after--h3\" id=\"0863\" name=\"0863\">In this post, we explained the problem that you can sometimes spend more on observing your production system than the system itself. Sampling is a common solution for addressing this cost concern while still giving you the observability you need.</p><p class=\"graf graf--p graf-after--p\" id=\"e541\" name=\"e541\">We then looked at the new tracing support that was recently added to Thundra. You can sample metrics and traces using a number of built-in samplers:</p><p class=\"graf graf--p graf-after--p graf--trailing\" id=\"91c8\" name=\"91c8\">These samplers can help reduce the cost of observing your production system significantly. But there\u2019s still room for further improvement as we discussed some ways Thundra can cut down on the cost of observability even further.</p></div></div></section><section class=\"section section--body section--last\" name=\"d9ea\"><div class=\"section-divider\"><hr class=\"section-divider\"/></div><div class=\"section-content\"><div class=\"section-inner sectionLayout--insetColumn\"><p class=\"graf graf--p graf--leading graf--trailing\" id=\"81bd\" name=\"81bd\"><em class=\"markup--em markup--p-em\">Originally published at </em><a class=\"markup--anchor markup--p-anchor\" data-href=\"https://blog.thundra.io/observability-without-breaking-the-bank\" href=\"https://blog.thundra.io/observability-without-breaking-the-bank\" rel=\"nofollow noopener\" target=\"_blank\"><em class=\"markup--em markup--p-em\">https://blog.thundra.io</em></a><em class=\"markup--em markup--p-em\">.</em></p></div></div></section></div><footer class=\"u-paddingTop10\"><div class=\"container u-maxWidth740\"><div class=\"row\"><div class=\"col u-size12of12\"><div class=\"postMetaInline postMetaInline--acknowledgments u-paddingTop5 u-paddingBottom20 js-postMetaAcknowledgments\"></div></div></div><div class=\"row\"><div class=\"col u-size12of12 js-postTags\"><div class=\"u-paddingBottom10\"><ul class=\"tags tags--postTags tags--borderless\"><li><a class=\"link u-baseColor--link\" data-action-source=\"post\" href=\"https://medium.com/tag/aws?source=post\">AWS</a></li><li><a class=\"link u-baseColor--link\" data-action-source=\"post\" href=\"https://medium.com/tag/aws-lambda?source=post\">AWS Lambda</a></li><li><a class=\"link u-baseColor--link\" data-action-source=\"post\" href=\"https://medium.com/tag/serverless?source=post\">Serverless</a></li><li><a class=\"link u-baseColor--link\" data-action-source=\"post\" href=\"https://medium.com/tag/cloud?source=post\">Cloud</a></li><li><a class=\"link u-baseColor--link\" data-action-source=\"post\" href=\"https://medium.com/tag/cloud-computing?source=post\">Cloud Computing</a></li></ul></div></div></div><div class=\"postActions js-postActionsFooter\"><div class=\"u-flexCenter\"><div class=\"u-flex1\"><div class=\"multirecommend js-actionMultirecommend u-flexCenter\" data-clap-string-plural=\"claps\" data-clap-string-singular=\"clap\" data-has-recommend-list=\"true\" data-is-circle=\"true\" data-is-icon-29px=\"true\" data-post-id=\"eee84f0b5ee1\" data-source=\"post_actions_footer-----eee84f0b5ee1---------------------clap_footer\"><div class=\"u-relative u-foreground\"><button aria-label=\"Clap\" class=\"button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal clap-onboardingcollection\" data-action=\"sign-up-prompt\" data-action-source=\"post_actions_footer-----eee84f0b5ee1---------------------clap_footer\" data-redirect=\"https://medium.com/_/vote/p/eee84f0b5ee1\" data-requires-token=\"true\" data-sign-in-action=\"multivote\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0\"><svg class=\"svgIcon-use\" height=\"33\" width=\"33\"><path d=\"M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z\" fill-rule=\"evenodd\"></path></svg></span></span><span class=\"button-activeState\"><span class=\"svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0\"><svg class=\"svgIcon-use\" height=\"33\" width=\"33\"><g fill-rule=\"evenodd\"><path d=\"M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z\"></path><path d=\"M13.285.48l-1.916.881 2.37 2.837z\"></path><path d=\"M21.719 1.361L19.79.501l-.44 3.697z\"></path><path d=\"M16.502 3.298L15.481 0h2.043z\"></path></g></svg></span></span></button><div class=\"clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Springu-backgroundGrayLighter js-clapUndo\" style=\"top: 14px; padding: 2px;\"><button class=\"button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight\" data-action=\"multivote-undo\" data-action-value=\"eee84f0b5ee1\"><span class=\"svgIcon svgIcon--removeThin svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61\" fill-rule=\"evenodd\"></path></svg></span></button></div></div><span class=\"u-relative u-background js-actionMultirecommendCount u-marginLeft16\"><button class=\"button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-textColorDarker\" data-action=\"show-recommends\" data-action-value=\"eee84f0b5ee1\">94 claps</button><span class=\"u-xs-hide\"></span></span></div></div><div class=\"buttonSet u-flex0\"><a aria-label=\"Share on Twitter\" class=\"button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless u-xs-hide u-marginRight12\" data-action-source=\"post_actions_footer\" href=\"https://medium.com/p/eee84f0b5ee1/share/twitter\" target=\"_blank\" title=\"Share on Twitter\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--twitterFilled svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z\"></path></svg></span></span></a><a aria-label=\"Share on Facebook\" class=\"button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless u-xs-hide u-marginRight12\" data-action-source=\"post_actions_footer\" href=\"https://medium.com/p/eee84f0b5ee1/share/facebook\" target=\"_blank\" title=\"Share on Facebook\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--facebookSquare svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79\"></path></svg></span></span></a><button aria-label=\"Share this story on Twitter or Facebook\" class=\"button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show u-marginRight10\" data-action=\"show-share-popover\" data-action-source=\"post_actions_footer\" title=\"Share this story on Twitter or Facebook\"><span class=\"svgIcon svgIcon--share svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706\" fill-rule=\"evenodd\"></path></svg></span></button><button class=\"button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon\" data-action=\"show-membership-respond-warning\" data-action-source=\"post_actions_footer\"><span class=\"svgIcon svgIcon--response svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z\"></path></svg></span></button><button aria-label=\"Bookmark this story to read later\" class=\"button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton\" data-action=\"sign-up-prompt\" data-action-source=\"post_actions_footer\" data-redirect=\"https://medium.com/_/bookmark/p/eee84f0b5ee1\" data-requires-token=\"true\" data-sign-in-action=\"add-to-bookmarks\" title=\"Bookmark this story to read later\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--bookmark svgIcon--29px u-marginRight4\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z\" fill-rule=\"evenodd\"></path></svg></span></span><span class=\"button-activeState\"><span class=\"svgIcon svgIcon--bookmarkFilled svgIcon--29px u-marginRight4\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z\" fill-rule=\"evenodd\"></path></svg></span></span></button><button aria-label=\"More actions\" class=\"button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon js-moreActionsButton\" data-action=\"more-actions\" title=\"More actions\"><span class=\"svgIcon svgIcon--more svgIcon--25px\"><svg class=\"svgIcon-use\" height=\"25\" viewbox=\"-480.5 272.5 21 21\" width=\"25\"><path d=\"M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z\"></path></svg></span></button></div></div></div></div><div class=\"u-maxWidth740 u-paddingTop20 u-marginTop20 u-borderTopLightest container u-paddingBottom20 u-xs-paddingBottom10 js-postAttributionFooterContainer\"><div class=\"row js-postFooterInfo\"><div class=\"col u-size6of12 u-xs-size12of12\"><li class=\"uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardUser\"><div class=\"u-marginLeft20 u-floatRight\"><span class=\"followState js-followState\" data-user-id=\"d00f1e6b06a2\"><button class=\"button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton\" data-action=\"sign-up-prompt\" data-action-source=\"footer_card\" data-redirect=\"https://medium.com/predict/serverless-observability-without-breaking-the-bank-eee84f0b5ee1\" data-requires-token=\"true\" data-sign-in-action=\"toggle-block-user\"><span class=\"button-label button-defaultState\">Blocked</span><span class=\"button-label button-hoverState\">Unblock</span></button><button class=\"button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton\" data-action=\"sign-up-prompt\" data-action-source=\"footer_card-d00f1e6b06a2-------------------------follow_footer\" data-redirect=\"https://medium.com/_/subscribe/user/d00f1e6b06a2\" data-requires-token=\"true\" data-sign-in-action=\"toggle-subscribe-user\"><span class=\"button-label button-defaultState js-buttonLabel\">Follow</span><span class=\"button-label button-activeState\">Following</span></button></span></div><div class=\"u-tableCell\"><a aria-label=\"Go to the profile of Yan Cui\" class=\"link u-baseColor--link avatar\" data-action-source=\"footer_card\" data-user-id=\"d00f1e6b06a2\" dir=\"auto\" href=\"https://medium.com/@theburningmonk?source=footer_card\" title=\"Go to the profile of Yan Cui\"><div class=\"u-relative u-inlineBlock u-flex0\"><img alt=\"Go to the profile of Yan Cui\" class=\"avatar-image avatar-image--small\" src=\"https://cdn-images-1.medium.com/fit/c/120/120/1*7emMqp-VkGhDNtk50Lg79Q.jpeg\"/><div class=\"avatar-halo u-absolute u-textColorGreenNormal svgIcon\" style=\"width: calc(100% + 12px); height: calc(100% + 12px); top:-6px; left:-6px\"><svg viewbox=\"0 0 114 114\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M7.66922967,32.092726 C17.0070768,13.6353618 35.9421928,1.75 57,1.75 C78.0578072,1.75 96.9929232,13.6353618 106.33077,32.092726 L107.66923,31.4155801 C98.0784505,12.4582656 78.6289015,0.25 57,0.25 C35.3710985,0.25 15.9215495,12.4582656 6.33077033,31.4155801 L7.66922967,32.092726 Z\"></path><path d=\"M106.33077,81.661427 C96.9929232,100.118791 78.0578072,112.004153 57,112.004153 C35.9421928,112.004153 17.0070768,100.118791 7.66922967,81.661427 L6.33077033,82.338573 C15.9215495,101.295887 35.3710985,113.504153 57,113.504153 C78.6289015,113.504153 98.0784505,101.295887 107.66923,82.338573 L106.33077,81.661427 Z\"></path></svg></div></div></a></div><div class=\"u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15\"><h3 class=\"ui-h3 u-fontSize18 u-lineHeightTighter\"><a aria-label=\"Go to the profile of Yan Cui\" class=\"link link--primary u-accentColor--hoverTextNormal\" data-user-id=\"d00f1e6b06a2\" dir=\"auto\" href=\"https://medium.com/@theburningmonk\" property=\"cc:attributionName\" rel=\"author cc:attributionUrl\" title=\"Go to the profile of Yan Cui\">Yan Cui</a></h3><div class=\"ui-caption u-textColorGreenNormal u-fontSize13 u-tintSpectrum u-accentColor--textNormal u-marginBottom7\">Medium member since Apr 2019</div><p class=\"ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4\">AWS Serverless Hero. Independent Consultant. Author of <a href=\"https://productionreadyserverless.com\" rel=\"nofollow\">https://productionreadyserverless.com</a>. Speaker. Principal Engineer @ DAZN.</p></div></li></div><div class=\"col u-size6of12 u-xs-size12of12 u-xs-marginTop30\"><li class=\"uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardCollection\"><div class=\"u-marginLeft20 u-floatRight\"><button class=\"button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal js-relationshipButton\" data-action=\"sign-up-prompt\" data-action-source=\"footer_card----661161fab0d0----------------------follow_footer\" data-collection-id=\"661161fab0d0\" data-redirect=\"https://medium.com/_/subscribe/collection/predict\" data-requires-token=\"true\" data-sign-in-action=\"toggle-follow-collection\"><span class=\"button-label js-buttonLabel\">Follow</span></button></div><div class=\"u-tableCell\"><a aria-label=\"Go to Predict\" class=\"link u-baseColor--link avatar avatar--roundedRectangle\" data-action-source=\"footer_card\" href=\"https://medium.com/predict?source=footer_card\" title=\"Go to Predict\"><img alt=\"Predict\" class=\"avatar-image u-size60x60\" src=\"https://cdn-images-1.medium.com/fit/c/120/120/1*tqCurXdzmPFYiuXrXD9Vuw.png\"/></a></div><div class=\"u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15\"><h3 class=\"ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4\"><a class=\"link link--primary u-accentColor--hoverTextNormal\" data-action-source=\"footer_card\" href=\"https://medium.com/predict?source=footer_card\" rel=\"collection\">Predict</a></h3><p class=\"ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4\">where the future is written</p><div class=\"buttonSet\"></div></div></li></div></div></div><div class=\"js-postFooterPlacements\" data-collection-id=\"661161fab0d0\" data-post-id=\"eee84f0b5ee1\"></div><div class=\"u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper\"></div><div class=\"supplementalPostContent js-heroPromo\"></div></footer></article></main><aside class=\"u-marginAuto u-maxWidth1032 js-postLeftSidebar\"><div class=\"u-foreground u-top0 u-transition--fadeOut300 u-fixed u-sm-hide js-postShareWidget\"><div class=\"u-breakWord u-md-hide u-width131\"><div class=\"u-width131 collection-title u-fontWeightBold u-fontSize18 u-lineHeightTight\"><a href=\"https://medium.com/predict?source=logo-lo_qLnTxMBcnCtF\">Predict</a></div><div class=\"u-width131 u-multiline-clamp u-textColorNormal u-fontSize14 u-lineHeightTight u-paddingTop3\">where the future is written</div><div class=\"u-paddingTop15 u-paddingBottom30 u-borderBottomLight u-marginBottom30\"><button class=\"button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal js-relationshipButton\" data-action=\"sign-up-prompt\" data-action-source=\"post_sidebar----661161fab0d0----------------------post_sidebar\" data-collection-id=\"661161fab0d0\" data-redirect=\"https://medium.com/_/subscribe/collection/predict\" data-requires-token=\"true\" data-sign-in-action=\"toggle-follow-collection\"><span class=\"button-label js-buttonLabel\">Follow</span></button></div></div><ul><li class=\"u-marginVertical10\"><div class=\"multirecommend js-actionMultirecommend u-flexCenter\" data-has-recommend-list=\"true\" data-is-icon-29px=\"true\" data-post-id=\"eee84f0b5ee1\" data-source=\"post_share_widget-----eee84f0b5ee1---------------------clap_sidebar\"><div class=\"u-relative u-foreground\"><button aria-label=\"Clap\" class=\"button button--primary button--large button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker\" data-action=\"sign-up-prompt\" data-action-source=\"post_share_widget-----eee84f0b5ee1---------------------clap_sidebar\" data-redirect=\"https://medium.com/_/vote/p/eee84f0b5ee1\" data-requires-token=\"true\" data-sign-in-action=\"multivote\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--clap svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><g fill-rule=\"evenodd\"><path d=\"M13.739 1l.761 2.966L15.261 1z\"></path><path d=\"M16.815 4.776l1.84-2.551-1.43-.471z\"></path><path d=\"M10.378 2.224l1.84 2.551-.408-3.022z\"></path><path d=\"M22.382 22.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L6.11 15.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L8.43 9.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L20.628 15c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM12.99 6.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z\"></path></g></svg></span></span><span class=\"button-activeState\"><span class=\"svgIcon svgIcon--clapFilled svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><g fill-rule=\"evenodd\"><path d=\"M13.738 1l.762 2.966L15.262 1z\"></path><path d=\"M18.634 2.224l-1.432-.47-.408 3.022z\"></path><path d=\"M11.79 1.754l-1.431.47 1.84 2.552z\"></path><path d=\"M24.472 14.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914\"></path><path d=\"M14.58 10.887c-.156-.83.096-1.569.692-2.142L12.78 6.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z\"></path><path d=\"M17.812 10.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L9.2 7.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L7.046 9.54 5.802 8.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394l1.241 1.241 4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L4.89 11.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C21.74 20.8 22.271 18 20.62 14.982l-2.809-4.942z\"></path></g></svg></span></span></button></div><span class=\"u-relative u-background js-actionMultirecommendCount u-marginLeft5\"><button class=\"button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton\" data-action=\"show-recommends\" data-action-value=\"eee84f0b5ee1\">94</button></span></div></li><li class=\"u-marginVertical10 u-marginLeft3\"><button aria-label=\"Bookmark this story to read later\" class=\"button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton\" data-action=\"sign-up-prompt\" data-action-source=\"post_share_widget-----eee84f0b5ee1---------------------bookmark_sidebar\" data-redirect=\"https://medium.com/_/bookmark/p/eee84f0b5ee1\" data-requires-token=\"true\" data-sign-in-action=\"add-to-bookmarks\" title=\"Bookmark this story to read later\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--bookmark svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z\" fill-rule=\"evenodd\"></path></svg></span></span><span class=\"button-activeState\"><span class=\"svgIcon svgIcon--bookmarkFilled svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z\" fill-rule=\"evenodd\"></path></svg></span></span></button></li><li class=\"u-marginVertical10 u-marginLeft3\"><a aria-label=\"Share on Twitter\" class=\"button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless\" data-action-source=\"post_share_widget\" href=\"https://medium.com/p/eee84f0b5ee1/share/twitter\" target=\"_blank\" title=\"Share on Twitter\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--twitterFilled svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z\"></path></svg></span></span></a></li><li class=\"u-marginVertical10 u-marginLeft3\"><a aria-label=\"Share on Facebook\" class=\"button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless\" data-action-source=\"post_share_widget\" href=\"https://medium.com/p/eee84f0b5ee1/share/facebook\" target=\"_blank\" title=\"Share on Facebook\"><span class=\"button-defaultState\"><span class=\"svgIcon svgIcon--facebookSquare svgIcon--29px\"><svg class=\"svgIcon-use\" height=\"29\" width=\"29\"><path d=\"M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79\"></path></svg></span></span></a></li></ul></div></aside><style class=\"js-collectionStyle\">\n.u-accentColor--borderLight {border-color: #02B875 !important;}\n.u-accentColor--borderNormal {border-color: #02B875 !important;}\n.u-accentColor--borderDark {border-color: #1C9963 !important;}\n.u-accentColor--iconLight .svgIcon,.u-accentColor--iconLight.svgIcon {fill: #02B875 !important;}\n.u-accentColor--iconNormal .svgIcon,.u-accentColor--iconNormal.svgIcon {fill: #02B875 !important;}\n.u-accentColor--iconDark .svgIcon,.u-accentColor--iconDark.svgIcon {fill: #1C9963 !important;}\n.u-accentColor--textNormal {color: #1C9963 !important;}\n.u-accentColor--hoverTextNormal:hover {color: #1C9963 !important;}\n.u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #1C9963 !important;}\n.u-accentColor--textDark {color: #1C9963 !important;}\n.u-accentColor--backgroundLight {background-color: #02B875 !important;}\n.u-accentColor--backgroundNormal {background-color: #02B875 !important;}\n.u-accentColor--backgroundDark {background-color: #1C9963 !important;}\n.u-accentColor--buttonDark {border-color: #1C9963 !important; color: #1C9963 !important;}\n.u-accentColor--buttonDark:hover {border-color: #1C9963 !important;}\n.u-accentColor--buttonDark .icon:before,.u-accentColor--buttonDark .svgIcon{color: #1C9963 !important; fill: #1C9963 !important;}\n.u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #02B875 !important; color: #1C9963 !important;}\n.u-accentColor--buttonNormal:hover {border-color: #1C9963 !important;}\n.u-accentColor--buttonNormal .icon:before,.u-accentColor--buttonNormal .svgIcon{color: #02B875 !important; fill: #02B875 !important;}\n.u-accentColor--buttonNormal.button--filled .icon:before,.u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-accentColor--buttonDark.button--filled,.u-accentColor--buttonDark.button--withChrome.is-active,.u-accentColor--fillWhenActive.is-active {background-color: #1C9963 !important; border-color: #1C9963 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #02B875 !important; border-color: #02B875 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.postArticle.is-withAccentColors .markup--user,.postArticle.is-withAccentColors .markup--query {color: #1C9963 !important;}\n.u-accentColor--highlightFaint {background-color: rgba(233, 253, 240, 1) !important;}\n.u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(125, 255, 179, 1) !important;}\n.postArticle.is-withAccentColors .markup--quote.is-other {background-color: rgba(233, 253, 240, 1) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(233, 253, 240, 1), rgba(233, 253, 240, 1));}\n.postArticle.is-withAccentColors .markup--quote.is-me {background-color: rgba(173, 255, 207, 1) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(173, 255, 207, 1), rgba(173, 255, 207, 1));}\n.postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: rgba(125, 255, 179, 1) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(125, 255, 179, 1), rgba(125, 255, 179, 1));}\n.postArticle.is-withAccentColors .markup--quote.is-selected {background-color: rgba(125, 255, 179, 1) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(125, 255, 179, 1), rgba(125, 255, 179, 1));}\n.postArticle.is-withAccentColors .markup--highlight {background-color: rgba(125, 255, 179, 1) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(125, 255, 179, 1), rgba(125, 255, 179, 1));}.u-baseColor--iconNormal.avatar-halo {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}</style><style class=\"js-collectionStyleConstant\">.u-imageBgColor {background-color: rgba(0, 0, 0, 0.24705882352941178);}\n.u-imageSpectrum .u-baseColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}\n.u-imageSpectrum .u-baseColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}\n.u-imageSpectrum .u-baseColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--iconLight .svgIcon,.u-imageSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}\n.u-imageSpectrum .u-baseColor--iconNormal .svgIcon,.u-imageSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--iconDark .svgIcon,.u-imageSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--textDark {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--textDarker {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}\n.u-imageSpectrum .u-baseColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--buttonLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important; color: rgba(255, 255, 255, 0.8) !important;}\n.u-imageSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}\n.u-imageSpectrum .u-baseColor--buttonLight .icon:before,.u-imageSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}\n.u-imageSpectrum .u-baseColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--buttonDark .icon:before,.u-imageSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--buttonNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--buttonNormal .icon:before,.u-imageSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--buttonDark.button--filled,.u-imageSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}\n.u-imageSpectrum .u-baseColor--buttonNormal.button--filled,.u-imageSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}\n.u-imageSpectrum .u-baseColor--link {color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--link.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--darken:active {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--link.link--dark {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--link.link--darker {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(255, 255, 255, 0.8);}\n.u-imageSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(255, 255, 255, 0.8);}\n.u-imageSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(255, 255, 255, 0.8);}\n.u-imageSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum  .ui-h1,.u-imageSpectrum  .ui-h2,.u-imageSpectrum  .ui-h3,.u-imageSpectrum  .ui-h4,.u-imageSpectrum  .ui-brand1,.u-imageSpectrum  .ui-brand2,.u-imageSpectrum  .ui-captionStrong {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum  .ui-body,.u-imageSpectrum  .ui-caps {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum  .ui-summary,.u-imageSpectrum  .ui-caption {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}\n.u-imageSpectrum .u-accentColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}\n.u-imageSpectrum .u-accentColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}\n.u-imageSpectrum .u-accentColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--iconLight .svgIcon,.u-imageSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}\n.u-imageSpectrum .u-accentColor--iconNormal .svgIcon,.u-imageSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--iconDark .svgIcon,.u-imageSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--textDark {color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}\n.u-imageSpectrum .u-accentColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--buttonDark .icon:before,.u-imageSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-imageSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--buttonNormal .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}\n.u-imageSpectrum .u-accentColor--buttonDark.button--filled,.u-imageSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-imageSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}\n.u-imageSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-imageSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}\n.u-imageSpectrum .postArticle.is-withAccentColors .markup--user,.u-imageSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(255, 255, 255, 0.9490196078431372) !important;}\n.u-imageSpectrum .u-accentColor--highlightFaint {background-color: rgba(255, 255, 255, 0.2) !important;}\n.u-imageSpectrum .u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(255, 255, 255, 0.6) !important;}\n.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: rgba(255, 255, 255, 0.2) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2));}\n.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: rgba(255, 255, 255, 0.4) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.4), rgba(255, 255, 255, 0.4));}\n.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: rgba(255, 255, 255, 0.6) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}\n.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: rgba(255, 255, 255, 0.6) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}\n.postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: rgba(255, 255, 255, 0.6) !important;}\nbody.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}.u-resetSpectrum .u-tintBgColor {background-color: rgba(255, 255, 255, 1) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 100%) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 100%) !important;}\n.u-resetSpectrum .u-baseColor--borderLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--borderNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--borderDark {border-color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--iconLight .svgIcon,.u-resetSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--iconNormal .svgIcon,.u-resetSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--iconDark .svgIcon,.u-resetSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--textNormal {color: rgba(0, 0, 0, 0.4980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--textDark {color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--textDarker {color: rgba(0, 0, 0, 0.8) !important;}\n.u-resetSpectrum .u-baseColor--backgroundLight {background-color: rgba(0, 0, 0, 0.09803921568627451) !important;}\n.u-resetSpectrum .u-baseColor--backgroundNormal {background-color: rgba(0, 0, 0, 0.2) !important;}\n.u-resetSpectrum .u-baseColor--backgroundDark {background-color: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--buttonLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--buttonLight .icon:before,.u-resetSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--buttonDark {border-color: rgba(0, 0, 0, 0.6) !important; color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(0, 0, 0, 0.8) !important;}\n.u-resetSpectrum .u-baseColor--buttonDark .icon:before,.u-resetSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--buttonNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important; color: rgba(0, 0, 0, 0.4980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--buttonNormal .icon:before,.u-resetSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(0, 0, 0, 0.4980392156862745) !important; fill: rgba(0, 0, 0, 0.4980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--buttonDark.button--filled,.u-resetSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2980392156862745) !important; border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-resetSpectrum .u-baseColor--buttonNormal.button--filled,.u-resetSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2) !important; border-color: rgba(0, 0, 0, 0.2) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-resetSpectrum .u-baseColor--link {color: rgba(0, 0, 0, 0.4980392156862745) !important;}\n.u-resetSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--link.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--darken:active {color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--link.link--dark {color: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(0, 0, 0, 0.8) !important;}\n.u-resetSpectrum .u-baseColor--link.link--darker {color: rgba(0, 0, 0, 0.8) !important;}\n.u-resetSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}\n.u-resetSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}\n.u-resetSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}\n.u-resetSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum  .ui-h1,.u-resetSpectrum  .ui-h2,.u-resetSpectrum  .ui-h3,.u-resetSpectrum  .ui-h4,.u-resetSpectrum  .ui-brand1,.u-resetSpectrum  .ui-brand2,.u-resetSpectrum  .ui-captionStrong {color: rgba(0, 0, 0, 0.8) !important; fill: rgba(0, 0, 0, 0.8) !important;}\n.u-resetSpectrum  .ui-body,.u-resetSpectrum  .ui-caps {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}\n.u-resetSpectrum  .ui-summary,.u-resetSpectrum  .ui-caption {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}\n.u-resetSpectrum .u-accentColor--borderLight {border-color: rgba(2, 184, 117, 1) !important;}\n.u-resetSpectrum .u-accentColor--borderNormal {border-color: rgba(2, 184, 117, 1) !important;}\n.u-resetSpectrum .u-accentColor--borderDark {border-color: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--iconLight .svgIcon,.u-resetSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(2, 184, 117, 1) !important;}\n.u-resetSpectrum .u-accentColor--iconNormal .svgIcon,.u-resetSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--iconDark .svgIcon,.u-resetSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--textNormal {color: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--textDark {color: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--backgroundLight {background-color: rgba(2, 184, 117, 1) !important;}\n.u-resetSpectrum .u-accentColor--backgroundNormal {background-color: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--backgroundDark {background-color: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonDark {border-color: rgba(0, 171, 107, 1) !important; color: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonDark .icon:before,.u-resetSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(28, 153, 99, 1) !important; fill: rgba(28, 153, 99, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(2, 184, 117, 1) !important; color: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonNormal .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(0, 171, 107, 1) !important; fill: rgba(0, 171, 107, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonDark.button--filled,.u-resetSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-resetSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(28, 153, 99, 1) !important; border-color: rgba(28, 153, 99, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-resetSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-resetSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(0, 171, 107, 1) !important; border-color: rgba(0, 171, 107, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}\n.u-resetSpectrum .postArticle.is-withAccentColors .markup--user,.u-resetSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(0, 171, 107, 1) !important;}</style></div></div></div><div class=\"loadingBar\"></div><script>// <![CDATA[\nwindow[\"obvInit\"] = function (opt_embedded) {window[\"obvInit\"][\"embedded\"] = opt_embedded; window[\"obvInit\"][\"ready\"] = true;}\n// ]]></script><script>// <![CDATA[\nvar GLOBALS = {\"audioUrl\":\"https://d1fcbxp97j4nb2.cloudfront.net\",\"baseUrl\":\"https://medium.com\",\"buildLabel\":\"37352-120440e\",\"currentUser\":{\"userId\":\"lo_qLnTxMBcnCtF\",\"isVerified\":false,\"subscriberEmail\":\"\",\"hasPastMemberships\":false,\"isEnrolledInHightower\":false,\"isEligibleForHightower\":false,\"hightowerLastLockedAt\":0,\"isWriterProgramEnrolled\":true,\"isWriterProgramInvited\":false,\"isWriterProgramOptedOut\":false,\"writerProgramVersion\":0,\"writerProgramEnrolledAt\":0,\"friendLinkOnboarding\":0,\"hasAdditionalUnlocks\":false,\"hasApiAccess\":false,\"isQuarantined\":false,\"writerProgramDistributionSettingOptedIn\":false},\"currentUserHasUnverifiedEmail\":false,\"isAuthenticated\":false,\"isCurrentUserVerified\":false,\"miroUrl\":\"https://cdn-images-1.medium.com\",\"moduleUrls\":{\"base\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.oNx2Q3VZK2m0A5fHEXtFzg.js\",\"common-async\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.Ky1v4wJhd0zSyQcXvjuF9A.js\",\"hightower\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-hightower.bundle.hukL4zF3v2R8LWDRKeGNqw.js\",\"home-screens\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.gzENwMs1G_BP04MW_QggHg.js\",\"misc-screens\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.JPlwq49Swtlt6f_HmFdtIg.js\",\"notes\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.v7uHpkOk8LWopR8TDyuy0g.js\",\"payments\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.NyX04eJEFdJOU3wHpRx9VQ.js\",\"posters\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.iAULf30OUHnwFprtvogAPw.js\",\"power-readers\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-power-readers.bundle.mtxwGAvRpu5vyfa502j2pg.js\",\"pubs\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-pubs.bundle.x6M4yqBAak3zv6CESA6omg.js\",\"stats\":\"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.NVmR6oNtdcJvtBkSkeVPyA.js\"},\"previewConfig\":{\"weightThreshold\":1,\"weightImageParagraph\":0.51,\"weightIframeParagraph\":0.8,\"weightTextParagraph\":0.08,\"weightEmptyParagraph\":0,\"weightP\":0.003,\"weightH\":0.005,\"weightBq\":0.003,\"minPTextLength\":60,\"truncateBoundaryChars\":20,\"detectTitle\":true,\"detectTitleLevThreshold\":0.15},\"productName\":\"Medium\",\"supportsEdit\":true,\"termsUrl\":\"//medium.com/policy/9db0094a1e0f\",\"textshotHost\":\"textshot.medium.com\",\"transactionId\":\"1556377439621:2eaff53d6d1d\",\"useragent\":{\"browser\":\"chrome\",\"family\":\"chrome\",\"os\":\"windows\",\"version\":63,\"supportsDesktopEdit\":true,\"supportsInteract\":true,\"supportsView\":true,\"isMobile\":false,\"isTablet\":false,\"isNative\":false,\"supportsFileAPI\":true,\"isTier1\":true,\"clientVersion\":\"\",\"unknownParagraphsBad\":false,\"clientChannel\":\"\",\"supportsRealScrollEvents\":true,\"supportsVhUnits\":true,\"ruinsViewportSections\":false,\"supportsHtml5Video\":true,\"supportsMagicUnderlines\":true,\"isWebView\":false,\"isFacebookWebView\":false,\"supportsProgressiveMedia\":true,\"supportsPromotedPosts\":true,\"isBot\":false,\"isNativeIphone\":false,\"supportsCssVariables\":true,\"supportsVideoSections\":true,\"emojiSupportLevel\":1,\"isSearchBot\":false,\"isSyndicationBot\":false,\"isNativeAndroid\":false,\"isNativeIos\":false,\"supportsScrollableMetabar\":true},\"variants\":{\"allow_access\":true,\"allow_signup\":true,\"allow_test_auth\":\"disallow\",\"signin_services\":\"twitter,facebook,google,email,google-fastidv,google-one-tap\",\"signup_services\":\"twitter,facebook,google,email,google-fastidv,google-one-tap\",\"google_sign_in_android\":true,\"reengagement_notification_duration\":3,\"browsable_stream_config_bucket\":\"curated-topics\",\"enable_dedicated_series_tab_api_ios\":true,\"enable_post_import\":true,\"available_monthly_plan\":\"60e220181034\",\"available_annual_plan\":\"2c754bcc2995\",\"disable_ios_resume_reading_toast\":true,\"is_not_medium_subscriber\":true,\"glyph_font_set\":\"m2\",\"enable_branding\":true,\"enable_branding_fonts\":true,\"max_premium_content_per_user_under_metering\":3,\"enable_automated_mission_control_triggers\":true,\"enable_lite_profile\":true,\"enable_marketing_emails\":true,\"enable_topic_lifecycle_email\":true,\"enable_parsely\":true,\"enable_branch_io\":true,\"enable_ios_post_stats\":true,\"enable_lite_topics\":true,\"enable_lite_stories\":true,\"redis_read_write_splitting\":true,\"enable_tipalti_onboarding\":true,\"enable_annual_renewal_reminder_email\":true,\"enable_janky_spam_rules\":\"users,posts\",\"enable_new_collaborative_filtering_data\":true,\"android_rating_prompt_stories_read_threshold\":2,\"stripe_v3\":true,\"enable_google_one_tap\":true,\"enable_email_sign_in_captcha\":true,\"enable_rito_with_viewer_query\":true,\"enable_rito_with_flag_query\":true,\"enable_rito_post_handler\":true,\"enable_rito_sequence_post_recirc_query\":true,\"editorial_push_notifications\":true,\"enable_primary_topic_for_mobile\":true,\"enable_rito_sequence_post_handler\":true,\"enable_todays_highlights_android\":true,\"enable_logged_out_homepage_signup\":true,\"use_new_admin_topic_backend\":true,\"enable_quarantine_rules\":true,\"enable_lite_privacy_banner\":true,\"enable_simplified_welcome_email\":true,\"pub_sidebar\":true,\"enable_embedding_based_diversification_bucket_b\":true,\"enable_rito_follow_collection_mutation\":true,\"enable_rito_unfollow_collection_mutation\":true},\"xsrfToken\":\"\",\"iosAppId\":\"828256236\",\"supportEmail\":\"yourfriends@medium.com\",\"fp\":{\"/icons/monogram-mask.svg\":\"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg\",\"/icons/favicon-dev-editor.ico\":\"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico\",\"/icons/favicon-hatch-editor.ico\":\"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico\",\"/icons/favicon-medium-editor.ico\":\"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico\"},\"authBaseUrl\":\"https://medium.com\",\"imageUploadSizeMb\":25,\"isAuthDomainRequest\":true,\"algoliaApiEndpoint\":\"https://MQ57UUUQZ2-dsn.algolia.net\",\"algoliaAppId\":\"MQ57UUUQZ2\",\"algoliaSearchOnlyApiKey\":\"394474ced050e3911ae2249ecc774921\",\"iosAppStoreUrl\":\"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8\",\"iosAppLinkBaseUrl\":\"medium:\",\"algoliaIndexPrefix\":\"medium_\",\"androidPlayStoreUrl\":\"https://play.google.com/store/apps/details?id=com.medium.reader\",\"googleClientId\":\"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com\",\"androidPackage\":\"com.medium.reader\",\"androidPlayStoreMarketScheme\":\"market://details?id=com.medium.reader\",\"googleAuthUri\":\"https://accounts.google.com/o/oauth2/auth\",\"androidScheme\":\"medium\",\"layoutData\":{\"useDynamicScripts\":false,\"googleAnalyticsTrackingCode\":\"UA-24232453-2\",\"jsShivUrl\":\"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js\",\"useDynamicCss\":false,\"faviconUrl\":\"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico\",\"faviconImageId\":\"1*8I-HPL0bfoIzGied-dzOvA.png\",\"fontSets\":[{\"id\":8,\"url\":\"https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css\"},{\"id\":11,\"url\":\"https://glyph.medium.com/css/m2.css\"},{\"id\":9,\"url\":\"https://glyph.medium.com/css/mkt.css\"}],\"editorFaviconUrl\":\"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium-editor.3Y6xpZ-0FSdWDnPM3hSBIA.ico\",\"glyphUrl\":\"https://glyph.medium.com\"},\"authBaseUrlRev\":\"moc.muidem//:sptth\",\"isDnt\":false,\"stripePublishableKey\":\"pk_live_7FReX44VnNIInZwrIIx6ghjl\",\"archiveUploadSizeMb\":100,\"paymentData\":{\"currencies\":{\"1\":{\"label\":\"US Dollar\",\"external\":\"usd\"}},\"countries\":{\"1\":{\"label\":\"United States of America\",\"external\":\"US\"}},\"accountTypes\":{\"1\":{\"label\":\"Individual\",\"external\":\"individual\"},\"2\":{\"label\":\"Company\",\"external\":\"company\"}}},\"previewConfig2\":{\"weightThreshold\":1,\"weightImageParagraph\":0.05,\"raiseImage\":true,\"enforceHeaderHierarchy\":true,\"isImageInsetRight\":true},\"isAmp\":false,\"iosScheme\":\"medium\",\"isSwBoot\":false,\"lightstep\":{\"accessToken\":\"ce5be895bef60919541332990ac9fef2\",\"carrier\":\"{\\\"ot-tracer-spanid\\\":\\\"471135eb496e0a49\\\",\\\"ot-tracer-traceid\\\":\\\"34340cfe312c035d\\\",\\\"ot-tracer-sampled\\\":\\\"true\\\"}\",\"host\":\"collector-medium.lightstep.com\"},\"facebook\":{\"key\":\"542599432471018\",\"namespace\":\"medium-com\",\"scope\":{\"default\":[\"public_profile\",\"email\"],\"connect\":[\"public_profile\",\"email\"],\"login\":[\"public_profile\",\"email\"],\"share\":[\"public_profile\",\"email\"]}},\"editorsPicksTopicId\":\"3985d2a191c5\",\"popularOnMediumTopicId\":\"9d34e48ecf94\",\"memberContentTopicId\":\"13d7efd82fb2\",\"audioContentTopicId\":\"3792abbd134\",\"brandedSequenceId\":\"7d337ddf1941\",\"isDoNotAuth\":false,\"buggle\":{\"url\":\"https://buggle.medium.com\",\"videoUrl\":\"https://cdn-videos-1.medium.com\",\"audioUrl\":\"https://cdn-audio-1.medium.com\"},\"referrerType\":5,\"isMeteredOut\":false,\"meterConfig\":{\"maxUnlockCount\":3,\"windowLength\":\"MONTHLY\"},\"partnerProgramEmail\":\"partnerprogram@medium.com\",\"userResearchPrompts\":[{\"promptId\":\"lo_post_page_4\",\"type\":0,\"url\":\"www.calendly.com\"},{\"promptId\":\"lo_home_page\",\"type\":1,\"url\":\"www.calendly.com\"},{\"promptId\":\"lo_profile_page\",\"type\":2,\"url\":\"www.calendly.com\"}],\"recaptchaKey\":\"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ\",\"signinWallCustomDomainCollectionIds\":[\"3a8144eabfe3\",\"336d898217ee\",\"61061eb0c96b\",\"138adf9c44c\",\"819cc2aaeee0\"],\"countryCode\":\"A1\",\"bypassMeter\":false,\"branchKey\":\"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm\",\"paypal\":{\"clientMode\":\"production\",\"oneYearGift\":{\"name\":\"Medium Membership (1 Year, Digital Gift Code)\",\"description\":\"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com/redeem.\",\"price\":\"50.00\",\"currency\":\"USD\",\"sku\":\"membership-gift-1-yr\"}},\"collectionConfig\":{\"mediumOwnedAndOperatedCollectionIds\":[\"544c7006046e // Human Parts\",\"bcc38c8f6edf // Matter\",\"444d13b52878 // OneZero\",\"8d6b8a439e32 // Elemental\"]}}\n// ]]></script><script async=\"\" charset=\"UTF-8\" src=\"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.oNx2Q3VZK2m0A5fHEXtFzg.js\"></script><script>// <![CDATA[\nwindow[\"obvInit\"]({\"value\":{\"id\":\"eee84f0b5ee1\",\"versionId\":\"3501ef0fa4b8\",\"creatorId\":\"d00f1e6b06a2\",\"creator\":{\"userId\":\"d00f1e6b06a2\",\"name\":\"Yan Cui\",\"username\":\"theburningmonk\",\"createdAt\":1487594393570,\"imageId\":\"1*7emMqp-VkGhDNtk50Lg79Q.jpeg\",\"backgroundImageId\":\"\",\"bio\":\"AWS Serverless Hero. Independent Consultant. Author of https://productionreadyserverless.com. Speaker. Principal Engineer @ DAZN.\",\"twitterScreenName\":\"theburningmonk\",\"socialStats\":{\"userId\":\"d00f1e6b06a2\",\"usersFollowedCount\":376,\"usersFollowedByCount\":3771,\"type\":\"SocialStats\"},\"social\":{\"userId\":\"lo_qLnTxMBcnCtF\",\"targetUserId\":\"d00f1e6b06a2\",\"type\":\"Social\"},\"facebookAccountId\":\"\",\"allowNotes\":1,\"mediumMemberAt\":1555916400000,\"isNsfw\":false,\"isWriterProgramEnrolled\":true,\"isQuarantined\":false,\"type\":\"User\"},\"homeCollection\":{\"id\":\"661161fab0d0\",\"name\":\"Predict\",\"slug\":\"predict\",\"tags\":[\"FUTURE\",\"SINGULARITY\",\"ARTIFICIAL INTELLIGENCE\",\"ROBOTICS\",\"CRYPTOCURRENCY\"],\"creatorId\":\"9c88458fdf71\",\"description\":\"where the future is written\",\"shortDescription\":\"where the future is written\",\"image\":{\"imageId\":\"1*tqCurXdzmPFYiuXrXD9Vuw.png\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":321,\"originalHeight\":321,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"metadata\":{\"followerCount\":4134,\"activeAt\":1556299954915},\"virtuals\":{\"permissions\":{\"canPublish\":false,\"canPublishAll\":false,\"canRepublish\":false,\"canRemove\":false,\"canManageAll\":false,\"canSubmit\":false,\"canEditPosts\":false,\"canAddWriters\":false,\"canViewStats\":false,\"canSendNewsletter\":false,\"canViewLockedPosts\":false,\"canViewCloaked\":false,\"canEditOwnPosts\":false,\"canBeAssignedAuthor\":false,\"canEnrollInHightower\":false,\"canLockPostsForMediumMembers\":false,\"canLockOwnPostsForMediumMembers\":false},\"isSubscribed\":false,\"isNewsletterSubscribed\":false,\"isEnrolledInHightower\":false,\"isEligibleForHightower\":false},\"logo\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"twitterUsername\":\"MediumPredict\",\"facebookPageName\":\"Predict-Medium-Publication-2026416674135438\",\"publicEmail\":\"predictstories@gmail.com\",\"collectionMastheadId\":\"4a8ea96b6a4e\",\"sections\":[{\"type\":2,\"collectionHeaderMetadata\":{\"title\":\"Predict\",\"description\":\"where the future is written\",\"backgroundImage\":{},\"logoImage\":{},\"alignment\":2,\"layout\":5}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":6,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"9b60b5ef6da8\"}},{\"type\":1,\"postListMetadata\":{\"source\":2,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"e6f2221508eb\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"cc6d8b036b83\"}},{\"type\":1,\"postListMetadata\":{\"source\":2,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"a246382339fc\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"a0b3769a1122\"}},{\"type\":1,\"postListMetadata\":{\"source\":2,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"d84f482babb3\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":18,\"postIds\":[],\"sectionHeader\":\"Our last homepage section: 500 more articles from Predict\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":2,\"postIds\":[]}}],\"favicon\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"colorPalette\":{\"defaultBackgroundSpectrum\":{\"colorPoints\":[{\"color\":\"#FF02B875\",\"point\":0},{\"color\":\"#FF00AB6B\",\"point\":0.1},{\"color\":\"#FF1C9963\",\"point\":0.2},{\"color\":\"#FF092E20\",\"point\":1}],\"backgroundColor\":\"#FFFFFFFF\"},\"highlightSpectrum\":{\"colorPoints\":[{\"color\":\"#FFFFFFFF\",\"point\":0},{\"color\":\"#FFE9FDF0\",\"point\":0.1},{\"color\":\"#FFE2FAEE\",\"point\":0.2},{\"color\":\"#FFADFFCF\",\"point\":0.6},{\"color\":\"#FF7DFFB3\",\"point\":1}],\"backgroundColor\":\"#FFFFFFFF\"}},\"navItems\":[],\"colorBehavior\":1,\"instantArticlesState\":0,\"acceleratedMobilePagesState\":0,\"ampLogo\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"header\":{\"title\":\"Predict\",\"description\":\"where the future is written\",\"backgroundImage\":{},\"logoImage\":{},\"alignment\":2,\"layout\":5},\"type\":\"Collection\"},\"homeCollectionId\":\"661161fab0d0\",\"title\":\"Serverless observability without Breaking the Bank\",\"detectedLanguage\":\"en\",\"latestVersion\":\"3501ef0fa4b8\",\"latestPublishedVersion\":\"3501ef0fa4b8\",\"hasUnpublishedEdits\":false,\"latestRev\":218,\"createdAt\":1555976223931,\"updatedAt\":1556043226609,\"acceptedAt\":0,\"firstPublishedAt\":1556033637594,\"latestPublishedAt\":1556033637594,\"vote\":false,\"experimentalCss\":\"\",\"displayAuthor\":\"\",\"content\":{\"subtitle\":\"To run a serverless application in production reliably, you need to be able to debug issues quickly. You need to have good observability\u2026\",\"bodyModel\":{\"paragraphs\":[{\"name\":\"1518\",\"type\":3,\"text\":\"Serverless observability without Breaking the Bank\",\"markups\":[]},{\"name\":\"ae88\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*pIKFPZ-lpjJi-g-3.png\",\"originalWidth\":1200,\"originalHeight\":675,\"isFeatured\":true}},{\"name\":\"62b0\",\"type\":1,\"text\":\"To run a serverless application in production reliably, you need to be able to debug issues quickly. You need to have good observability, and having structured logs is a big part of that. They allow you to capture useful contextual information with each log message.\",\"markups\":[]},{\"name\":\"0f49\",\"type\":1,\"text\":\"But observability comes with a cost.\",\"markups\":[]},{\"name\":\"b325\",\"type\":3,\"text\":\"The Problem\",\"markups\":[]},{\"name\":\"06c6\",\"type\":1,\"text\":\"CloudWatch Logs charges $0.50 for per GB of data ingested, and $0.03 per GB per month for storage. As such, it\u2019s common for companies to spend more on CloudWatch Logs than Lambda invocations in their production environment. Best practices such as using structured logs further exasperate the cost associated with logging.\",\"markups\":[]},{\"name\":\"0be1\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*ZrkWuVBPF0JgeA8I\",\"originalWidth\":860,\"originalHeight\":420}},{\"name\":\"1357\",\"type\":1,\"text\":\"Furthermore, with AWS Lambda, it\u2019s no longer possible to rely on agents to collect and publish observability data such as custom metrics and traces. Instead, you have to either:\",\"markups\":[]},{\"name\":\"db0f\",\"type\":9,\"text\":\"publish data synchronously as part of a function invocation\",\"markups\":[]},{\"name\":\"ad3e\",\"type\":9,\"text\":\"publish data asynchronously through CloudWatch Logs\",\"markups\":[]},{\"name\":\"df50\",\"type\":1,\"text\":\"Publishing data synchronously adds latency to your invocation. When it comes to APIs this extra latency becomes user-facing and negatively impacts your user experience. Which is why it\u2019s generally recommended that you collect observability data for APIs asynchronously. However, collecting data through CloudWatch Logs further adds to its cost.\",\"markups\":[]},{\"name\":\"fdd6\",\"type\":1,\"text\":\"In this post, we\u2019ll see how we can use sampling to address this cost concern, and check out the built-in sampling support in Thundra.\",\"markups\":[]},{\"name\":\"cd78\",\"type\":3,\"text\":\"Sampling to the rescue\",\"markups\":[]},{\"name\":\"80ae\",\"type\":1,\"text\":\"If the primary reason why we needed observability in the first place is to help us debug issues in production. And if most requests are processed successfully, then it stands to reason that we should:\",\"markups\":[]},{\"name\":\"0356\",\"type\":9,\"text\":\"Collect data for all erroneous or poor performing invocations. Because they represent invocations that require our attention.\",\"markups\":[]},{\"name\":\"8ccf\",\"type\":9,\"text\":\"Collect data for a small percentage of successful invocations. So that we always have some representation of what a \u201cgood\u201d invocation looks like.\",\"markups\":[]},{\"name\":\"c37a\",\"type\":1,\"text\":\"In the most naive approach, we can also sample data from a percentage of all invocations irrespective of their outcome or performance. That way, we can reduce the cost of logging while still maintaining the same distribution of good and bad invocations.\",\"markups\":[]},{\"name\":\"b775\",\"type\":1,\"text\":\"With a sufficient number of invocations, you only need a small percentage of them to have representative data for every scenario. Indeed, the industry average is to sample 1% of all requests. The likes of Google would sample at 0.01% because their scale is so big that even 0.01% of requests would give you good representation for every scenario.\",\"markups\":[]},{\"name\":\"140b\",\"type\":13,\"text\":\"Intelligent sampling with Thundra\",\"markups\":[]},{\"name\":\"1346\",\"type\":1,\"text\":\"Thundra supports both synchronous and asynchronous modes of collecting data. But collecting data asynchronously requires you to send a lot of data to CloudWatch Logs. By default, Thundra records at least seven pieces of data for every invocation (see below).\",\"markups\":[]},{\"name\":\"f442\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*SE87_NhU2-ar8lXQ.png\",\"originalWidth\":1999,\"originalHeight\":338}},{\"name\":\"9941\",\"type\":1,\"text\":\"That is a total of 16KB of observability data for every invocation! It undoubtedly is a cost concern when running at scale. So I\u2019m really glad that Thundra recently announced sampling support.\",\"markups\":[]},{\"name\":\"12e8\",\"type\":13,\"text\":\"Sampling metrics\",\"markups\":[]},{\"name\":\"faa6\",\"type\":1,\"text\":\"For metrics, you can use the count aware sampler to do simple percentage-based sampling. What\u2019s more interesting though, is the time aware sampler. It allows you to sample metrics based on a configured frequency.\",\"markups\":[{\"type\":3,\"start\":29,\"end\":48,\"href\":\"https://docs.thundra.io/docs/node-sampling-support#section-count-aware-sampler\",\"title\":\"\",\"rel\":\"nofollow noopener\",\"anchorType\":0},{\"type\":3,\"start\":128,\"end\":146,\"href\":\"https://docs.thundra.io/docs/node-sampling-support#section-time-aware-sampler\",\"title\":\"\",\"rel\":\"nofollow noopener\",\"anchorType\":0}]},{\"name\":\"7a0e\",\"type\":1,\"text\":\"Percentage-based sampling works well when you have stable, predictable traffic. All the way throughout the day, you will have metrics for a percentage of invocations.\",\"markups\":[]},{\"name\":\"a13f\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*La0NZ8C8Pf0ZTLW0\",\"originalWidth\":761,\"originalHeight\":286}},{\"name\":\"9c01\",\"type\":1,\"text\":\"But it doesn\u2019t work well for functions that run in bursts. If a function runs infrequently and we only collect metrics on 1% of its invocations, then there will be large gaps in time where we don\u2019t have any metrics at all. Conversely, if this function sees a sudden burst of activities, we will collect lots of metrics during that burst. However, since all the metrics relate to the same burst of activities, they are bound to be similar too. Which means their signal-to-noise ratio is low.\",\"markups\":[]},{\"name\":\"43d8\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*kZTOoQfLAY3yfsVv\",\"originalWidth\":925,\"originalHeight\":463}},{\"name\":\"bcb3\",\"type\":1,\"text\":\"The time-aware sampler solves this because when the function runs infrequently, it\u2019ll simply record metrics for every invocation. When the function sees a burst of activities, it\u2019ll also not record too many metrics either.\",\"markups\":[]},{\"name\":\"f03a\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*wHDMEoSIWDJDcWO-\",\"originalWidth\":769,\"originalHeight\":290}},{\"name\":\"fa21\",\"type\":1,\"text\":\"Take the following function as an example, it\u2019ll record metrics every five seconds.\",\"markups\":[]},{\"name\":\"1851\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*RqFktdd4awktJkro\",\"originalWidth\":585,\"originalHeight\":475}},{\"name\":\"c6a3\",\"type\":1,\"text\":\"You can see from its logs that invocations that are less than 5s since the last sampled metric would not record metrics.\",\"markups\":[]},{\"name\":\"090f\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*DyOokVN3p-gb4gdy\",\"originalWidth\":825,\"originalHeight\":417}},{\"name\":\"3bf3\",\"type\":13,\"text\":\"Sampling traces\",\"markups\":[]},{\"name\":\"44ba\",\"type\":1,\"text\":\"For traces, you can enable sampling based on the duration of invocations as well as whether they ended in an error state.\",\"markups\":[]},{\"name\":\"82eb\",\"type\":1,\"text\":\"For example, the following configuration would sample trace data only when the duration of an invocation is over 500ms. That is, \u201cshow me the breakdown of where invocation time was spent if the function is slow\u201d.\",\"markups\":[]},{\"name\":\"0707\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*ECa6T3T6BcTyCcGX\",\"originalWidth\":587,\"originalHeight\":260}},{\"name\":\"f437\",\"type\":1,\"text\":\"Again, if you look at the logs for this function. You will see an entry with type \u201cSpan\u201d only when the invocation duration was over 500ms.\",\"markups\":[]},{\"name\":\"6bed\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*Abz1VWw7eaboY5PK\",\"originalWidth\":884,\"originalHeight\":324}},{\"name\":\"fce6\",\"type\":1,\"text\":\"Similarly, the following configuration would sample traces only when the invocation errors.\",\"markups\":[]},{\"name\":\"a1e0\",\"type\":4,\"text\":\"\",\"markups\":[],\"layout\":1,\"metadata\":{\"id\":\"0*wHDusfjxhxtff1Ke\",\"originalWidth\":577,\"originalHeight\":215}},{\"name\":\"b41c\",\"type\":1,\"text\":\"As discussed earlier, both of these sampling options are great for improving the signal to noise ratio. Since detailed traces are most useful when something has gone wrong. Either the invocation was slow and we need to investigate where the performance issue is. Or the invocation erred and we need to find out where did the error occur.\",\"markups\":[]},{\"name\":\"6a91\",\"type\":1,\"text\":\"However, I would still like traces to be sample even when everything is working normally. That way, I can have a sample of healthy invocations that I can use as a reference.\",\"markups\":[]},{\"name\":\"6a4c\",\"type\":1,\"text\":\"Besides the sampling methods we discussed here, you can also write custom samplers for both metrics and traces. You can also configure samplers through environment variables too. For more information on the sampling support, check out the official documentation page.\",\"markups\":[{\"type\":3,\"start\":67,\"end\":82,\"href\":\"https://docs.thundra.io/docs/node-sampling-support#section-custom-sampler\",\"title\":\"\",\"rel\":\"nofollow noopener\",\"anchorType\":0},{\"type\":3,\"start\":248,\"end\":266,\"href\":\"https://docs.thundra.io/docs/node-sampling-support\",\"title\":\"\",\"rel\":\"nofollow noopener\",\"anchorType\":0}]},{\"name\":\"bdf3\",\"type\":3,\"text\":\"Summary\",\"markups\":[]},{\"name\":\"0863\",\"type\":1,\"text\":\"In this post, we explained the problem that you can sometimes spend more on observing your production system than the system itself. Sampling is a common solution for addressing this cost concern while still giving you the observability you need.\",\"markups\":[]},{\"name\":\"e541\",\"type\":1,\"text\":\"We then looked at the new tracing support that was recently added to Thundra. You can sample metrics and traces using a number of built-in samplers:\",\"markups\":[]},{\"name\":\"91c8\",\"type\":1,\"text\":\"These samplers can help reduce the cost of observing your production system significantly. But there\u2019s still room for further improvement as we discussed some ways Thundra can cut down on the cost of observability even further.\",\"markups\":[]},{\"name\":\"81bd\",\"type\":1,\"text\":\"Originally published at https://blog.thundra.io.\",\"markups\":[{\"type\":3,\"start\":24,\"end\":47,\"href\":\"https://blog.thundra.io/observability-without-breaking-the-bank\",\"title\":\"\",\"rel\":\"\",\"anchorType\":0},{\"type\":2,\"start\":0,\"end\":48}]}],\"sections\":[{\"name\":\"dcc3\",\"startIndex\":0},{\"name\":\"d9ea\",\"startIndex\":49}]},\"postDisplay\":{\"coverless\":true}},\"virtuals\":{\"statusForCollection\":\"APPROVED\",\"allowNotes\":true,\"previewImage\":{\"imageId\":\"0*pIKFPZ-lpjJi-g-3.png\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":1200,\"originalHeight\":675,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"wordCount\":1043,\"imageCount\":11,\"readingTime\":5.235849056603773,\"subtitle\":\"To run a serverless application in production reliably, you need to be able to debug issues quickly. You need to have good observability\u2026\",\"publishedInCount\":1,\"usersBySocialRecommends\":[],\"noIndex\":false,\"recommends\":7,\"socialRecommends\":[],\"isBookmarked\":false,\"tags\":[{\"slug\":\"aws\",\"name\":\"AWS\",\"postCount\":17709,\"metadata\":{\"postCount\":17709,\"coverImage\":{\"id\":\"1*zNRhSEpe1PKv3GfGjXl6yw.jpeg\",\"originalWidth\":2400,\"originalHeight\":1200,\"isFeatured\":true,\"focusPercentX\":30,\"focusPercentY\":72}},\"type\":\"Tag\"},{\"slug\":\"aws-lambda\",\"name\":\"AWS Lambda\",\"postCount\":2363,\"metadata\":{\"postCount\":2363,\"coverImage\":{\"id\":\"1*XuFiQx_VwYkOitS25494LQ.png\",\"originalWidth\":5000,\"originalHeight\":3334,\"isFeatured\":true}},\"type\":\"Tag\"},{\"slug\":\"serverless\",\"name\":\"Serverless\",\"postCount\":5265,\"metadata\":{\"postCount\":5265,\"coverImage\":{\"id\":\"1*XuFiQx_VwYkOitS25494LQ.png\",\"originalWidth\":5000,\"originalHeight\":3334,\"isFeatured\":true}},\"type\":\"Tag\"},{\"slug\":\"cloud\",\"name\":\"Cloud\",\"postCount\":7145,\"metadata\":{\"postCount\":7145,\"coverImage\":{\"id\":\"1*zNRhSEpe1PKv3GfGjXl6yw.jpeg\",\"originalWidth\":2400,\"originalHeight\":1200,\"isFeatured\":true,\"focusPercentX\":30,\"focusPercentY\":72}},\"type\":\"Tag\"},{\"slug\":\"cloud-computing\",\"name\":\"Cloud Computing\",\"postCount\":25879,\"metadata\":{\"postCount\":25879,\"coverImage\":{\"id\":\"1*LI654qGDaGGtqPMoQtIWsw.jpeg\",\"originalWidth\":2500,\"originalHeight\":1172,\"isFeatured\":true}},\"type\":\"Tag\"}],\"socialRecommendsCount\":0,\"responsesCreatedCount\":0,\"links\":{\"entries\":[{\"url\":\"https://blog.thundra.io/observability-without-breaking-the-bank\",\"alts\":[{\"type\":1,\"url\":\"https://cdn.ampproject.org/c/s/blog.thundra.io/observability-without-breaking-the-bank?hs_amp=true\"}],\"httpStatus\":200},{\"url\":\"https://docs.thundra.io/docs/node-sampling-support#section-custom-sampler\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://docs.thundra.io/docs/node-sampling-support#section-time-aware-sampler\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://docs.thundra.io/docs/node-sampling-support#section-count-aware-sampler\",\"alts\":[],\"httpStatus\":200},{\"url\":\"https://docs.thundra.io/docs/node-sampling-support\",\"alts\":[],\"httpStatus\":200}],\"version\":\"0.3\",\"generatedAt\":1556033638030},\"isLockedPreviewOnly\":false,\"takeoverId\":\"\",\"metaDescription\":\"\",\"totalClapCount\":94,\"sectionCount\":2,\"readingList\":0,\"topics\":[]},\"coverless\":true,\"slug\":\"serverless-observability-without-breaking-the-bank\",\"translationSourcePostId\":\"\",\"translationSourceCreatorId\":\"\",\"isApprovedTranslation\":false,\"inResponseToPostId\":\"\",\"inResponseToRemovedAt\":0,\"isTitleSynthesized\":false,\"allowResponses\":true,\"importedUrl\":\"https://blog.thundra.io/observability-without-breaking-the-bank\",\"importedPublishedAt\":0,\"visibility\":2,\"uniqueSlug\":\"serverless-observability-without-breaking-the-bank-eee84f0b5ee1\",\"previewContent\":{\"bodyModel\":{\"paragraphs\":[{\"name\":\"previewImage\",\"type\":4,\"text\":\"\",\"layout\":10,\"metadata\":{\"id\":\"0*pIKFPZ-lpjJi-g-3.png\",\"originalWidth\":1200,\"originalHeight\":675,\"isFeatured\":true}},{\"name\":\"1518\",\"type\":3,\"text\":\"Serverless observability without Breaking the Bank\",\"markups\":[],\"alignment\":1}],\"sections\":[{\"startIndex\":0}]},\"isFullContent\":false,\"subtitle\":\"To run a serverless application in production reliably, you need to be able to debug issues quickly. You need to have good observability\u2026\"},\"license\":0,\"inResponseToMediaResourceId\":\"\",\"canonicalUrl\":\"https://medium.com/predict/serverless-observability-without-breaking-the-bank-eee84f0b5ee1\",\"approvedHomeCollectionId\":\"661161fab0d0\",\"approvedHomeCollection\":{\"id\":\"661161fab0d0\",\"name\":\"Predict\",\"slug\":\"predict\",\"tags\":[\"FUTURE\",\"SINGULARITY\",\"ARTIFICIAL INTELLIGENCE\",\"ROBOTICS\",\"CRYPTOCURRENCY\"],\"creatorId\":\"9c88458fdf71\",\"description\":\"where the future is written\",\"shortDescription\":\"where the future is written\",\"image\":{\"imageId\":\"1*tqCurXdzmPFYiuXrXD9Vuw.png\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":321,\"originalHeight\":321,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"metadata\":{\"followerCount\":4134,\"activeAt\":1556299954915},\"virtuals\":{\"permissions\":{\"canPublish\":false,\"canPublishAll\":false,\"canRepublish\":false,\"canRemove\":false,\"canManageAll\":false,\"canSubmit\":false,\"canEditPosts\":false,\"canAddWriters\":false,\"canViewStats\":false,\"canSendNewsletter\":false,\"canViewLockedPosts\":false,\"canViewCloaked\":false,\"canEditOwnPosts\":false,\"canBeAssignedAuthor\":false,\"canEnrollInHightower\":false,\"canLockPostsForMediumMembers\":false,\"canLockOwnPostsForMediumMembers\":false},\"isSubscribed\":false,\"isNewsletterSubscribed\":false,\"isEnrolledInHightower\":false,\"isEligibleForHightower\":false},\"logo\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"twitterUsername\":\"MediumPredict\",\"facebookPageName\":\"Predict-Medium-Publication-2026416674135438\",\"publicEmail\":\"predictstories@gmail.com\",\"collectionMastheadId\":\"4a8ea96b6a4e\",\"sections\":[{\"type\":2,\"collectionHeaderMetadata\":{\"title\":\"Predict\",\"description\":\"where the future is written\",\"backgroundImage\":{},\"logoImage\":{},\"alignment\":2,\"layout\":5}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":6,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"9b60b5ef6da8\"}},{\"type\":1,\"postListMetadata\":{\"source\":2,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"e6f2221508eb\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"cc6d8b036b83\"}},{\"type\":1,\"postListMetadata\":{\"source\":2,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"a246382339fc\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"a0b3769a1122\"}},{\"type\":1,\"postListMetadata\":{\"source\":2,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"d84f482babb3\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":18,\"postIds\":[],\"sectionHeader\":\"Our last homepage section: 500 more articles from Predict\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":2,\"postIds\":[]}}],\"favicon\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"colorPalette\":{\"defaultBackgroundSpectrum\":{\"colorPoints\":[{\"color\":\"#FF02B875\",\"point\":0},{\"color\":\"#FF00AB6B\",\"point\":0.1},{\"color\":\"#FF1C9963\",\"point\":0.2},{\"color\":\"#FF092E20\",\"point\":1}],\"backgroundColor\":\"#FFFFFFFF\"},\"highlightSpectrum\":{\"colorPoints\":[{\"color\":\"#FFFFFFFF\",\"point\":0},{\"color\":\"#FFE9FDF0\",\"point\":0.1},{\"color\":\"#FFE2FAEE\",\"point\":0.2},{\"color\":\"#FFADFFCF\",\"point\":0.6},{\"color\":\"#FF7DFFB3\",\"point\":1}],\"backgroundColor\":\"#FFFFFFFF\"}},\"navItems\":[],\"colorBehavior\":1,\"instantArticlesState\":0,\"acceleratedMobilePagesState\":0,\"ampLogo\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"header\":{\"title\":\"Predict\",\"description\":\"where the future is written\",\"backgroundImage\":{},\"logoImage\":{},\"alignment\":2,\"layout\":5},\"type\":\"Collection\"},\"newsletterId\":\"\",\"webCanonicalUrl\":\"https://blog.thundra.io/observability-without-breaking-the-bank\",\"mediumUrl\":\"https://medium.com/predict/serverless-observability-without-breaking-the-bank-eee84f0b5ee1\",\"migrationId\":\"\",\"notifyFollowers\":true,\"notifyTwitter\":false,\"notifyFacebook\":false,\"responseHiddenOnParentPostAt\":0,\"isSeries\":false,\"isSubscriptionLocked\":true,\"seriesLastAppendedAt\":0,\"audioVersionDurationSec\":0,\"sequenceId\":\"\",\"isNsfw\":false,\"isEligibleForRevenue\":true,\"isBlockedFromHightower\":false,\"deletedAt\":0,\"lockedPostSource\":1,\"hightowerMinimumGuaranteeStartsAt\":0,\"hightowerMinimumGuaranteeEndsAt\":0,\"featureLockRequestAcceptedAt\":0,\"mongerRequestType\":1,\"layerCake\":4,\"socialTitle\":\"\",\"socialDek\":\"\",\"editorialPreviewTitle\":\"\",\"editorialPreviewDek\":\"\",\"curationEligibleAt\":1555976328135,\"type\":\"Post\"},\"mentionedUsers\":[],\"collaborators\":[],\"hideMeter\":false,\"collectionUserRelations\":[],\"mode\":null,\"references\":{\"User\":{\"d00f1e6b06a2\":{\"userId\":\"d00f1e6b06a2\",\"name\":\"Yan Cui\",\"username\":\"theburningmonk\",\"createdAt\":1487594393570,\"imageId\":\"1*7emMqp-VkGhDNtk50Lg79Q.jpeg\",\"backgroundImageId\":\"\",\"bio\":\"AWS Serverless Hero. Independent Consultant. Author of https://productionreadyserverless.com. Speaker. Principal Engineer @ DAZN.\",\"twitterScreenName\":\"theburningmonk\",\"socialStats\":{\"userId\":\"d00f1e6b06a2\",\"usersFollowedCount\":376,\"usersFollowedByCount\":3771,\"type\":\"SocialStats\"},\"social\":{\"userId\":\"lo_qLnTxMBcnCtF\",\"targetUserId\":\"d00f1e6b06a2\",\"type\":\"Social\"},\"facebookAccountId\":\"\",\"allowNotes\":1,\"mediumMemberAt\":1555916400000,\"isNsfw\":false,\"isWriterProgramEnrolled\":true,\"isQuarantined\":false,\"type\":\"User\"}},\"Collection\":{\"661161fab0d0\":{\"id\":\"661161fab0d0\",\"name\":\"Predict\",\"slug\":\"predict\",\"tags\":[\"FUTURE\",\"SINGULARITY\",\"ARTIFICIAL INTELLIGENCE\",\"ROBOTICS\",\"CRYPTOCURRENCY\"],\"creatorId\":\"9c88458fdf71\",\"description\":\"where the future is written\",\"shortDescription\":\"where the future is written\",\"image\":{\"imageId\":\"1*tqCurXdzmPFYiuXrXD9Vuw.png\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":321,\"originalHeight\":321,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"metadata\":{\"followerCount\":4134,\"activeAt\":1556299954915},\"virtuals\":{\"permissions\":{\"canPublish\":false,\"canPublishAll\":false,\"canRepublish\":false,\"canRemove\":false,\"canManageAll\":false,\"canSubmit\":false,\"canEditPosts\":false,\"canAddWriters\":false,\"canViewStats\":false,\"canSendNewsletter\":false,\"canViewLockedPosts\":false,\"canViewCloaked\":false,\"canEditOwnPosts\":false,\"canBeAssignedAuthor\":false,\"canEnrollInHightower\":false,\"canLockPostsForMediumMembers\":false,\"canLockOwnPostsForMediumMembers\":false},\"isSubscribed\":false,\"isNewsletterSubscribed\":false,\"isEnrolledInHightower\":false,\"isEligibleForHightower\":false},\"logo\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"twitterUsername\":\"MediumPredict\",\"facebookPageName\":\"Predict-Medium-Publication-2026416674135438\",\"publicEmail\":\"predictstories@gmail.com\",\"collectionMastheadId\":\"4a8ea96b6a4e\",\"sections\":[{\"type\":2,\"collectionHeaderMetadata\":{\"title\":\"Predict\",\"description\":\"where the future is written\",\"backgroundImage\":{},\"logoImage\":{},\"alignment\":2,\"layout\":5}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":6,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"9b60b5ef6da8\"}},{\"type\":1,\"postListMetadata\":{\"source\":2,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"e6f2221508eb\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"cc6d8b036b83\"}},{\"type\":1,\"postListMetadata\":{\"source\":2,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"a246382339fc\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"a0b3769a1122\"}},{\"type\":1,\"postListMetadata\":{\"source\":2,\"layout\":4,\"number\":1,\"postIds\":[]}},{\"type\":3,\"promoMetadata\":{\"sectionHeader\":\"\",\"promoId\":\"d84f482babb3\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":18,\"postIds\":[],\"sectionHeader\":\"Our last homepage section: 500 more articles from Predict\"}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":24,\"postIds\":[]}},{\"type\":1,\"postListMetadata\":{\"source\":1,\"layout\":4,\"number\":2,\"postIds\":[]}}],\"favicon\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"colorPalette\":{\"defaultBackgroundSpectrum\":{\"colorPoints\":[{\"color\":\"#FF02B875\",\"point\":0},{\"color\":\"#FF00AB6B\",\"point\":0.1},{\"color\":\"#FF1C9963\",\"point\":0.2},{\"color\":\"#FF092E20\",\"point\":1}],\"backgroundColor\":\"#FFFFFFFF\"},\"highlightSpectrum\":{\"colorPoints\":[{\"color\":\"#FFFFFFFF\",\"point\":0},{\"color\":\"#FFE9FDF0\",\"point\":0.1},{\"color\":\"#FFE2FAEE\",\"point\":0.2},{\"color\":\"#FFADFFCF\",\"point\":0.6},{\"color\":\"#FF7DFFB3\",\"point\":1}],\"backgroundColor\":\"#FFFFFFFF\"}},\"navItems\":[],\"colorBehavior\":1,\"instantArticlesState\":0,\"acceleratedMobilePagesState\":0,\"ampLogo\":{\"imageId\":\"\",\"filter\":\"\",\"backgroundSize\":\"\",\"originalWidth\":0,\"originalHeight\":0,\"strategy\":\"resample\",\"height\":0,\"width\":0},\"header\":{\"title\":\"Predict\",\"description\":\"where the future is written\",\"backgroundImage\":{},\"logoImage\":{},\"alignment\":2,\"layout\":5},\"type\":\"Collection\"}},\"Social\":{\"d00f1e6b06a2\":{\"userId\":\"lo_qLnTxMBcnCtF\",\"targetUserId\":\"d00f1e6b06a2\",\"type\":\"Social\"}},\"SocialStats\":{\"d00f1e6b06a2\":{\"userId\":\"d00f1e6b06a2\",\"usersFollowedCount\":376,\"usersFollowedByCount\":3771,\"type\":\"SocialStats\"}}}})\n// ]]></script><script>window.PARSELY = window.PARSELY || } autotrack: false {</script><script id=\"parsely-cfg\" src=\"//d1z2jf7jlzjs58.cloudfront.net/keys/medium.com/p.js\"></script><script type=\"text/javascript\">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src=\"https://cdn.branch.io/branch-latest.min.js\";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,\"script\",\"branch\",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},\"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent\".split(\" \"), 0); branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled':  false }, function(err, data) {});</script></body></html>", "content_tokenized": ["serverless", "observ", "without", "break", "the", "bank", "yan", "cui", "block", "unblock", "follow", "follow", "apr", "num", "run", "serverless", "applic", "product", "reliabl", "need", "abl", "debug", "issu", "quick", "need", "have", "good", "observ", "and", "have", "structur", "log", "big", "part", "that", "they", "allow", "captur", "use", "contextu", "inform", "with", "each", "log", "messag", "but", "observ", "come", "with", "cost", "the", "problem", "cloudwatch", "log", "charg", "num", "for", "per", "data", "ingest", "and", "num", "per", "per", "month", "for", "storag", "such", "common", "for", "compani", "spend", "more", "cloudwatch", "log", "than", "lambda", "invoc", "their", "product", "environ", "best", "practic", "such", "use", "structur", "log", "further", "exasper", "the", "cost", "associ", "with", "log", "furthermor", "with", "lambda", "longer", "possibl", "reli", "agent", "collect", "and", "publish", "observ", "data", "such", "custom", "metric", "and", "trace", "instead", "have", "either", "publish", "data", "synchron", "part", "function", "invoc", "publish", "data", "asynchron", "through", "cloudwatch", "log", "publish", "data", "synchron", "add", "latenc", "invoc", "when", "come", "api", "this", "extra", "latenc", "becom", "userfac", "and", "negat", "impact", "user", "experi", "which", "whi", "general", "recommend", "that", "collect", "observ", "data", "for", "api", "asynchron", "howev", "collect", "data", "through", "cloudwatch", "log", "further", "add", "cost", "this", "post", "see", "how", "can", "use", "sampl", "address", "this", "cost", "concern", "and", "check", "out", "the", "builtin", "sampl", "support", "thundra", "sampl", "the", "rescu", "the", "primari", "reason", "whi", "need", "observ", "the", "first", "place", "help", "debug", "issu", "product", "and", "most", "request", "are", "process", "success", "then", "stand", "reason", "that", "should", "collect", "data", "for", "all", "erron", "poor", "perform", "invoc", "becaus", "they", "repres", "invoc", "that", "requir", "our", "attent", "collect", "data", "for", "small", "percentag", "success", "invoc", "that", "alway", "have", "some", "represent", "what", "good", "invoc", "look", "like", "the", "most", "naiv", "approach", "can", "also", "sampl", "data", "from", "percentag", "all", "invoc", "irrespect", "their", "outcom", "perform", "that", "way", "can", "reduc", "the", "cost", "log", "while", "still", "maintain", "the", "same", "distribut", "good", "and", "bad", "invoc", "with", "suffici", "number", "invoc", "onli", "need", "small", "percentag", "them", "have", "repres", "data", "for", "everi", "scenario", "inde", "the", "industri", "averag", "sampl", "num", "all", "request", "the", "like", "googl", "would", "sampl", "num", "becaus", "their", "scale", "big", "that", "even", "num", "request", "would", "give", "good", "represent", "for", "everi", "scenario", "intellig", "sampl", "with", "thundra", "thundra", "support", "both", "synchron", "and", "asynchron", "mode", "collect", "data", "but", "collect", "data", "asynchron", "requir", "send", "lot", "data", "cloudwatch", "log", "default", "thundra", "record", "least", "seven", "piec", "data", "for", "everi", "invoc", "see", "below", "that", "total", "observ", "data", "for", "everi", "invoc", "undoubt", "cost", "concern", "when", "run", "scale", "realli", "glad", "that", "thundra", "recent", "announc", "sampl", "support", "sampl", "metric", "for", "metric", "can", "use", "the", "count", "awar", "sampler", "simpl", "percentagebas", "sampl", "what", "more", "interest", "though", "the", "time", "awar", "sampler", "allow", "sampl", "metric", "base", "configur", "frequenc", "percentagebas", "sampl", "work", "well", "when", "have", "stabl", "predict", "traffic", "all", "the", "way", "throughout", "the", "day", "will", "have", "metric", "for", "percentag", "invoc", "but", "work", "well", "for", "function", "that", "run", "burst", "function", "run", "infrequ", "and", "onli", "collect", "metric", "num", "invoc", "then", "there", "will", "larg", "gap", "time", "where", "have", "ani", "metric", "all", "convers", "this", "function", "see", "sudden", "burst", "activ", "will", "collect", "lot", "metric", "dure", "that", "burst", "howev", "sinc", "all", "the", "metric", "relat", "the", "same", "burst", "activ", "they", "are", "bound", "similar", "too", "which", "mean", "their", "signaltonois", "ratio", "low", "the", "timeawar", "sampler", "solv", "this", "becaus", "when", "the", "function", "run", "infrequ", "simpli", "record", "metric", "for", "everi", "invoc", "when", "the", "function", "see", "burst", "activ", "also", "not", "record", "too", "mani", "metric", "either", "take", "the", "follow", "function", "exampl", "record", "metric", "everi", "five", "second", "can", "see", "from", "log", "that", "invoc", "that", "are", "less", "than", "num", "sinc", "the", "last", "sampl", "metric", "would", "not", "record", "metric", "sampl", "trace", "for", "trace", "can", "enabl", "sampl", "base", "the", "durat", "invoc", "well", "whether", "they", "end", "error", "state", "for", "exampl", "the", "follow", "configur", "would", "sampl", "trace", "data", "onli", "when", "the", "durat", "invoc", "over", "numm", "that", "show", "the", "breakdown", "where", "invoc", "time", "spent", "the", "function", "slow", "again", "look", "the", "log", "for", "this", "function", "will", "see", "entri", "with", "type", "span", "onli", "when", "the", "invoc", "durat", "over", "numm", "similar", "the", "follow", "configur", "would", "sampl", "trace", "onli", "when", "the", "invoc", "error", "discuss", "earlier", "both", "these", "sampl", "option", "are", "great", "for", "improv", "the", "signal", "nois", "ratio", "sinc", "detail", "trace", "are", "most", "use", "when", "someth", "has", "gone", "wrong", "either", "the", "invoc", "slow", "and", "need", "investig", "where", "the", "perform", "issu", "the", "invoc", "and", "need", "find", "out", "where", "the", "error", "occur", "howev", "would", "still", "like", "trace", "sampl", "even", "when", "everyth", "work", "normal", "that", "way", "can", "have", "sampl", "healthi", "invoc", "that", "can", "use", "refer", "besid", "the", "sampl", "method", "discuss", "here", "can", "also", "write", "custom", "sampler", "for", "both", "metric", "and", "trace", "can", "also", "configur", "sampler", "through", "environ", "variabl", "too", "for", "more", "inform", "the", "sampl", "support", "check", "out", "the", "offici", "document", "page", "summari", "this", "post", "explain", "the", "problem", "that", "can", "sometim", "spend", "more", "observ", "product", "system", "than", "the", "system", "itself", "sampl", "common", "solut", "for", "address", "this", "cost", "concern", "while", "still", "give", "the", "observ", "need", "then", "look", "the", "new", "trace", "support", "that", "recent", "thundra", "can", "sampl", "metric", "and", "trace", "use", "number", "builtin", "sampler", "these", "sampler", "can", "help", "reduc", "the", "cost", "observ", "product", "system", "signific", "but", "there", "still", "room", "for", "further", "improv", "discuss", "some", "way", "thundra", "can", "cut", "down", "the", "cost", "observ", "even", "further", "origin", "publish"], "timestamp_scraper": 1556377440.346455, "title": "Serverless observability without Breaking the\u00a0Bank", "read_time": 312.9, "content_html": "<div class=\"section-content\"><div class=\"section-inner sectionLayout--insetColumn\"><h1 class=\"graf graf--h3 graf--leading graf--title\" id=\"1518\" name=\"1518\">Serverless observability without Breaking the\u00a0Bank</h1><div class=\"uiScale uiScale-ui--regular uiScale-caption--regular u-flexCenter u-marginVertical24 u-fontSize15 js-postMetaLockup\"><div class=\"u-flex0\"><a class=\"link u-baseColor--link avatar\" data-action=\"show-user-card\" data-action-source=\"post_header_lockup\" data-action-type=\"hover\" data-action-value=\"d00f1e6b06a2\" data-user-id=\"d00f1e6b06a2\" dir=\"auto\" href=\"https://medium.com/@theburningmonk?source=post_header_lockup\"><div class=\"u-relative u-inlineBlock u-flex0\"><img alt=\"Go to the profile of Yan Cui\" class=\"avatar-image u-size50x50\" src=\"https://cdn-images-1.medium.com/fit/c/100/100/1*7emMqp-VkGhDNtk50Lg79Q.jpeg\"/><div class=\"avatar-halo u-absolute u-textColorGreenNormal svgIcon\" style=\"width: calc(100% + 10px); height: calc(100% + 10px); top:-5px; left:-5px\"><svg viewbox=\"0 0 70 70\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M5.53538374,19.9430227 C11.180401,8.78497536 22.6271155,1.6 35.3571429,1.6 C48.0871702,1.6 59.5338847,8.78497536 65.178902,19.9430227 L66.2496695,19.401306 C60.4023065,7.84329843 48.5440457,0.4 35.3571429,0.4 C22.17024,0.4 10.3119792,7.84329843 4.46461626,19.401306 L5.53538374,19.9430227 Z\"></path><path d=\"M65.178902,49.9077131 C59.5338847,61.0657604 48.0871702,68.2507358 35.3571429,68.2507358 C22.6271155,68.2507358 11.180401,61.0657604 5.53538374,49.9077131 L4.46461626,50.4494298 C10.3119792,62.0074373 22.17024,69.4507358 35.3571429,69.4507358 C48.5440457,69.4507358 60.4023065,62.0074373 66.2496695,50.4494298 L65.178902,49.9077131 Z\"></path></svg></div></div></a></div><div class=\"u-flex1 u-paddingLeft15 u-overflowHidden\"><div class=\"u-paddingBottom3\"><a class=\"ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker\" data-action=\"show-user-card\" data-action-type=\"hover\" data-action-value=\"d00f1e6b06a2\" data-user-id=\"d00f1e6b06a2\" dir=\"auto\" href=\"https://medium.com/@theburningmonk\">Yan Cui</a><span class=\"followState js-followState\" data-user-id=\"d00f1e6b06a2\"><button class=\"button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide\" data-action=\"sign-up-prompt\" data-action-source=\"post_header_lockup\" data-redirect=\"https://medium.com/predict/serverless-observability-without-breaking-the-bank-eee84f0b5ee1\" data-requires-token=\"true\" data-sign-in-action=\"toggle-block-user\"><span class=\"button-label button-defaultState\">Blocked</span><span class=\"button-label button-hoverState\">Unblock</span></button><button class=\"button button--primary button--smallest button--dark u-noUserSelect button--withChrome u-accentColor--buttonDark button--follow js-followButton u-marginLeft10 u-xs-hide\" data-action=\"sign-up-prompt\" data-action-source=\"post_header_lockup-d00f1e6b06a2-------------------------follow_byline\" data-redirect=\"https://medium.com/_/subscribe/user/d00f1e6b06a2\" data-requires-token=\"true\" data-sign-in-action=\"toggle-subscribe-user\"><span class=\"button-label button-defaultState js-buttonLabel\">Follow</span><span class=\"button-label button-activeState\">Following</span></button></span></div><div class=\"ui-caption u-noWrapWithEllipsis js-testPostMetaInlineSupplemental\"><time datetime=\"2019-04-23T15:33:57.594Z\">Apr 23</time><span class=\"middotDivider u-fontSize12\"></span><span class=\"readingTime\" title=\"6 min read\"></span><span class=\"u-paddingLeft4\"><span class=\"svgIcon svgIcon--star svgIcon--15px\"><svg class=\"svgIcon-use\" height=\"15\" width=\"15\"><path d=\"M7.438 2.324c.034-.099.09-.099.123 0l1.2 3.53a.29.29 0 0 0 .26.19h3.884c.11 0 .127.049.038.111L9.8 8.327a.271.271 0 0 0-.099.291l1.2 3.53c.034.1-.011.131-.098.069l-3.142-2.18a.303.303 0 0 0-.32 0l-3.145 2.182c-.087.06-.132.03-.099-.068l1.2-3.53a.271.271 0 0 0-.098-.292L2.056 6.146c-.087-.06-.071-.112.038-.112h3.884a.29.29 0 0 0 .26-.19l1.2-3.52z\"></path></svg></span></span></div></div></div><figure class=\"graf graf--figure graf-after--h3\" id=\"ae88\" name=\"ae88\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 394px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 56.3%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*pIKFPZ-lpjJi-g-3.png\" data-height=\"675\" data-image-id=\"0*pIKFPZ-lpjJi-g-3.png\" data-is-featured=\"true\" data-width=\"1200\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*pIKFPZ-lpjJi-g-3.png?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*pIKFPZ-lpjJi-g-3.png\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*pIKFPZ-lpjJi-g-3.png\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"62b0\" name=\"62b0\">To run a serverless application in production reliably, you need to be able to debug issues quickly. You need to have good observability, and having structured logs is a big part of that. They allow you to capture useful contextual information with each log message.</p><p class=\"graf graf--p graf-after--p\" id=\"0f49\" name=\"0f49\">But observability comes with a cost.</p><h3 class=\"graf graf--h3 graf-after--p\" id=\"b325\" name=\"b325\">The Problem</h3><p class=\"graf graf--p graf-after--h3\" id=\"06c6\" name=\"06c6\">CloudWatch Logs charges $0.50 for per GB of data ingested, and $0.03 per GB per month for storage. As such, it\u2019s common for companies to spend more on CloudWatch Logs than Lambda invocations in their production environment. Best practices such as using structured logs further exasperate the cost associated with logging.</p><figure class=\"graf graf--figure graf-after--p\" id=\"0be1\" name=\"0be1\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 342px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 48.8%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*ZrkWuVBPF0JgeA8I\" data-height=\"420\" data-image-id=\"0*ZrkWuVBPF0JgeA8I\" data-width=\"860\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*ZrkWuVBPF0JgeA8I?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*ZrkWuVBPF0JgeA8I\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*ZrkWuVBPF0JgeA8I\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"1357\" name=\"1357\">Furthermore, with AWS Lambda, it\u2019s no longer possible to rely on agents to collect and publish observability data such as custom metrics and traces. Instead, you have to either:</p><ul class=\"postList\"><li class=\"graf graf--li graf-after--p\" id=\"db0f\" name=\"db0f\">publish data synchronously as part of a function invocation</li><li class=\"graf graf--li graf-after--li\" id=\"ad3e\" name=\"ad3e\">publish data asynchronously through CloudWatch Logs</li></ul><p class=\"graf graf--p graf-after--li\" id=\"df50\" name=\"df50\">Publishing data synchronously adds latency to your invocation. When it comes to APIs this extra latency becomes user-facing and negatively impacts your user experience. Which is why it\u2019s generally recommended that you collect observability data for APIs asynchronously. However, collecting data through CloudWatch Logs further adds to its cost.</p><p class=\"graf graf--p graf-after--p\" id=\"fdd6\" name=\"fdd6\">In this post, we\u2019ll see how we can use sampling to address this cost concern, and check out the built-in sampling support in Thundra.</p><h3 class=\"graf graf--h3 graf-after--p\" id=\"cd78\" name=\"cd78\">Sampling to the\u00a0rescue</h3><p class=\"graf graf--p graf-after--h3\" id=\"80ae\" name=\"80ae\">If the primary reason why we needed observability in the first place is to help us debug issues in production. And if most requests are processed successfully, then it stands to reason that we should:</p><ul class=\"postList\"><li class=\"graf graf--li graf-after--p\" id=\"0356\" name=\"0356\">Collect data for all erroneous or poor performing invocations. Because they represent invocations that require our attention.</li><li class=\"graf graf--li graf-after--li\" id=\"8ccf\" name=\"8ccf\">Collect data for a small percentage of successful invocations. So that we always have some representation of what a \u201cgood\u201d invocation looks like.</li></ul><p class=\"graf graf--p graf-after--li\" id=\"c37a\" name=\"c37a\">In the most naive approach, we can also sample data from a percentage of all invocations irrespective of their outcome or performance. That way, we can reduce the cost of logging while still maintaining the same distribution of good and bad invocations.</p><p class=\"graf graf--p graf-after--p\" id=\"b775\" name=\"b775\">With a sufficient number of invocations, you only need a small percentage of them to have representative data for every scenario. Indeed, the industry average is to sample 1% of all requests. The likes of Google would sample at 0.01% because their scale is so big that even 0.01% of requests would give you good representation for every scenario.</p><h4 class=\"graf graf--h4 graf-after--p\" id=\"140b\" name=\"140b\">Intelligent sampling with\u00a0Thundra</h4><p class=\"graf graf--p graf-after--h4\" id=\"1346\" name=\"1346\">Thundra supports both synchronous and asynchronous modes of collecting data. But collecting data asynchronously requires you to send a lot of data to CloudWatch Logs. By default, Thundra records at least seven pieces of data for every invocation (see below).</p><figure class=\"graf graf--figure graf-after--p\" id=\"f442\" name=\"f442\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 118px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 16.900000000000002%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*SE87_NhU2-ar8lXQ.png\" data-height=\"338\" data-image-id=\"0*SE87_NhU2-ar8lXQ.png\" data-width=\"1999\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*SE87_NhU2-ar8lXQ.png?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*SE87_NhU2-ar8lXQ.png\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*SE87_NhU2-ar8lXQ.png\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"9941\" name=\"9941\">That is a total of 16KB of observability data for every invocation! It undoubtedly is a cost concern when running at scale. So I\u2019m really glad that Thundra recently announced sampling support.</p><h4 class=\"graf graf--h4 graf-after--p\" id=\"12e8\" name=\"12e8\">Sampling metrics</h4><p class=\"graf graf--p graf-after--h4\" id=\"faa6\" name=\"faa6\">For metrics, you can use the <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://docs.thundra.io/docs/node-sampling-support#section-count-aware-sampler\" href=\"https://docs.thundra.io/docs/node-sampling-support#section-count-aware-sampler\" rel=\"nofollow noopener nofollow noopener\" target=\"_blank\">count aware sampler</a> to do simple percentage-based sampling. What\u2019s more interesting though, is the <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://docs.thundra.io/docs/node-sampling-support#section-time-aware-sampler\" href=\"https://docs.thundra.io/docs/node-sampling-support#section-time-aware-sampler\" rel=\"nofollow noopener nofollow noopener\" target=\"_blank\">time aware sampler</a>. It allows you to sample metrics based on a configured frequency.</p><p class=\"graf graf--p graf-after--p\" id=\"7a0e\" name=\"7a0e\">Percentage-based sampling works well when you have stable, predictable traffic. All the way throughout the day, you will have metrics for a percentage of invocations.</p><figure class=\"graf graf--figure graf-after--p\" id=\"a13f\" name=\"a13f\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 263px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 37.6%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*La0NZ8C8Pf0ZTLW0\" data-height=\"286\" data-image-id=\"0*La0NZ8C8Pf0ZTLW0\" data-width=\"761\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*La0NZ8C8Pf0ZTLW0?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*La0NZ8C8Pf0ZTLW0\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*La0NZ8C8Pf0ZTLW0\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"9c01\" name=\"9c01\">But it doesn\u2019t work well for functions that run in bursts. If a function runs infrequently and we only collect metrics on 1% of its invocations, then there will be large gaps in time where we don\u2019t have any metrics at all. Conversely, if this function sees a sudden burst of activities, we will collect lots of metrics during that burst. However, since all the metrics relate to the same burst of activities, they are bound to be similar too. Which means their signal-to-noise ratio is low.</p><figure class=\"graf graf--figure graf-after--p\" id=\"43d8\" name=\"43d8\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 350px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 50.1%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*kZTOoQfLAY3yfsVv\" data-height=\"463\" data-image-id=\"0*kZTOoQfLAY3yfsVv\" data-width=\"925\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*kZTOoQfLAY3yfsVv?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*kZTOoQfLAY3yfsVv\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*kZTOoQfLAY3yfsVv\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"bcb3\" name=\"bcb3\">The time-aware sampler solves this because when the function runs infrequently, it\u2019ll simply record metrics for every invocation. When the function sees a burst of activities, it\u2019ll also not record too many metrics either.</p><figure class=\"graf graf--figure graf-after--p\" id=\"f03a\" name=\"f03a\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 264px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 37.7%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*wHDMEoSIWDJDcWO-\" data-height=\"290\" data-image-id=\"0*wHDMEoSIWDJDcWO-\" data-width=\"769\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*wHDMEoSIWDJDcWO-?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*wHDMEoSIWDJDcWO-\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*wHDMEoSIWDJDcWO-\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"fa21\" name=\"fa21\">Take the following function as an example, it\u2019ll record metrics every five seconds.</p><figure class=\"graf graf--figure graf-after--p\" id=\"1851\" name=\"1851\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 585px; max-height: 475px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 81.2%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-height=\"475\" data-image-id=\"0*RqFktdd4awktJkro\" data-width=\"585\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*RqFktdd4awktJkro?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*RqFktdd4awktJkro\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*RqFktdd4awktJkro\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"c6a3\" name=\"c6a3\">You can see from its logs that invocations that are less than 5s since the last sampled metric would not record metrics.</p><figure class=\"graf graf--figure graf-after--p\" id=\"090f\" name=\"090f\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 354px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 50.5%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*DyOokVN3p-gb4gdy\" data-height=\"417\" data-image-id=\"0*DyOokVN3p-gb4gdy\" data-width=\"825\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*DyOokVN3p-gb4gdy?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*DyOokVN3p-gb4gdy\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*DyOokVN3p-gb4gdy\"/></noscript></div></div></figure><h4 class=\"graf graf--h4 graf-after--figure\" id=\"3bf3\" name=\"3bf3\">Sampling traces</h4><p class=\"graf graf--p graf-after--h4\" id=\"44ba\" name=\"44ba\">For traces, you can enable sampling based on the duration of invocations as well as whether they ended in an error state.</p><p class=\"graf graf--p graf-after--p\" id=\"82eb\" name=\"82eb\">For example, the following configuration would sample trace data only when the duration of an invocation is over 500ms. That is, \u201cshow me the breakdown of where invocation time was spent if the function is slow\u201d.</p><figure class=\"graf graf--figure graf-after--p\" id=\"0707\" name=\"0707\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 587px; max-height: 260px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 44.3%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-height=\"260\" data-image-id=\"0*ECa6T3T6BcTyCcGX\" data-width=\"587\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*ECa6T3T6BcTyCcGX?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*ECa6T3T6BcTyCcGX\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*ECa6T3T6BcTyCcGX\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"f437\" name=\"f437\">Again, if you look at the logs for this function. You will see an entry with type \u201cSpan\u201d only when the invocation duration was over 500ms.</p><figure class=\"graf graf--figure graf-after--p\" id=\"6bed\" name=\"6bed\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 700px; max-height: 257px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 36.7%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-action=\"zoom\" data-action-value=\"0*Abz1VWw7eaboY5PK\" data-height=\"324\" data-image-id=\"0*Abz1VWw7eaboY5PK\" data-width=\"884\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*Abz1VWw7eaboY5PK?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*Abz1VWw7eaboY5PK\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*Abz1VWw7eaboY5PK\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"fce6\" name=\"fce6\">Similarly, the following configuration would sample traces only when the invocation errors.</p><figure class=\"graf graf--figure graf-after--p\" id=\"a1e0\" name=\"a1e0\"><div class=\"aspectRatioPlaceholder is-locked\" style=\"max-width: 577px; max-height: 215px;\"><div class=\"aspectRatioPlaceholder-fill\" style=\"padding-bottom: 37.3%;\"></div><div class=\"progressiveMedia js-progressiveMedia graf-image\" data-height=\"215\" data-image-id=\"0*wHDusfjxhxtff1Ke\" data-width=\"577\"><img class=\"progressiveMedia-thumbnail js-progressiveMedia-thumbnail\" crossorigin=\"anonymous\" src=\"https://cdn-images-1.medium.com/freeze/max/60/0*wHDusfjxhxtff1Ke?q=20\"/><canvas class=\"progressiveMedia-canvas js-progressiveMedia-canvas\"></canvas><img class=\"progressiveMedia-image js-progressiveMedia-image\" data-src=\"https://cdn-images-1.medium.com/max/1600/0*wHDusfjxhxtff1Ke\"/><noscript class=\"js-progressiveMedia-inner\"><img class=\"progressiveMedia-noscript js-progressiveMedia-inner\" src=\"https://cdn-images-1.medium.com/max/1600/0*wHDusfjxhxtff1Ke\"/></noscript></div></div></figure><p class=\"graf graf--p graf-after--figure\" id=\"b41c\" name=\"b41c\">As discussed earlier, both of these sampling options are great for improving the signal to noise ratio. Since detailed traces are most useful when something has gone wrong. Either the invocation was slow and we need to investigate where the performance issue is. Or the invocation erred and we need to find out where did the error occur.</p><p class=\"graf graf--p graf-after--p\" id=\"6a91\" name=\"6a91\">However, I would still like traces to be sample even when everything is working normally. That way, I can have a sample of healthy invocations that I can use as a reference.</p><p class=\"graf graf--p graf-after--p\" id=\"6a4c\" name=\"6a4c\">Besides the sampling methods we discussed here, you can also write <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://docs.thundra.io/docs/node-sampling-support#section-custom-sampler\" href=\"https://docs.thundra.io/docs/node-sampling-support#section-custom-sampler\" rel=\"nofollow noopener nofollow noopener\" target=\"_blank\">custom samplers</a> for both metrics and traces. You can also configure samplers through environment variables too. For more information on the sampling support, check out the official <a class=\"markup--anchor markup--p-anchor\" data-href=\"https://docs.thundra.io/docs/node-sampling-support\" href=\"https://docs.thundra.io/docs/node-sampling-support\" rel=\"nofollow noopener nofollow noopener\" target=\"_blank\">documentation page</a>.</p><h3 class=\"graf graf--h3 graf-after--p\" id=\"bdf3\" name=\"bdf3\">Summary</h3><p class=\"graf graf--p graf-after--h3\" id=\"0863\" name=\"0863\">In this post, we explained the problem that you can sometimes spend more on observing your production system than the system itself. Sampling is a common solution for addressing this cost concern while still giving you the observability you need.</p><p class=\"graf graf--p graf-after--p\" id=\"e541\" name=\"e541\">We then looked at the new tracing support that was recently added to Thundra. You can sample metrics and traces using a number of built-in samplers:</p><p class=\"graf graf--p graf-after--p graf--trailing\" id=\"91c8\" name=\"91c8\">These samplers can help reduce the cost of observing your production system significantly. But there\u2019s still room for further improvement as we discussed some ways Thundra can cut down on the cost of observability even further.</p></div></div> <div class=\"section-content\"><div class=\"section-inner sectionLayout--insetColumn\"><p class=\"graf graf--p graf--leading graf--trailing\" id=\"81bd\" name=\"81bd\"><em class=\"markup--em markup--p-em\">Originally published at </em><a class=\"markup--anchor markup--p-anchor\" data-href=\"https://blog.thundra.io/observability-without-breaking-the-bank\" href=\"https://blog.thundra.io/observability-without-breaking-the-bank\" rel=\"nofollow noopener\" target=\"_blank\"><em class=\"markup--em markup--p-em\">https://blog.thundra.io</em></a><em class=\"markup--em markup--p-em\">.</em></p></div></div> ", "website": "medium"}